import{z as e,B as l,u as t,i as a,j as s,s as r,r as o,k as n,o as i,n as u,c,w as d,A as v,C as m,D as p,E as g,G as h,H as x,I as f,J as b,l as y,K as w,a as k,d as C,e as I,f as j,b as M,L as z,M as L,N as V,x as B,t as _,O as S,F as H,h as P,v as E,P as T,Q as $,T as U,R as A,S as D,U as Y,V as q,W as O}from"./index-DgjzBZ7I.js";import{a as F}from"./bookmark-CzkUkp08.js";import{u as R}from"./useNotification-qGrGmQJF.js";import{U as N}from"./UnifiedComicCard-BqnHjdRQ.js";function W(l,t,a){if(t<220980||l.src.includes(".gif"))return l;const s=document.createElement("canvas"),r=s.getContext("2d");s.width=l.naturalWidth,s.height=l.naturalHeight;const o=function(l,t){if(l>=220980&&l<268850)return 10;const a=e(l+t);let s=a.charCodeAt(a.length-1);return s%=l>=268850&&l<=421925?10:8,s>=0&&s<=9?2*s+2:10}(t,a),n=Math.floor(s.height/o),i=s.height%o;r.drawImage(l,0,s.height-n-i,s.width,n+i,0,0,s.width,n+i);for(let e=0;e<o-1;e++)r.drawImage(l,0,n*(o-e-2),s.width,n,0,(e+1)*n+i,s.width,n);return s}function G(e,l,t){return`${e}/media/photos/${l}/${t}`}function J(){const e=(new Date).getHours();return e<=3||e>=21?1:e>=18?3:5}const K=["disabled","title"],Q=["fill"],X={key:0,class:"flex justify-center items-center min-h-screen"},Z={class:"flex flex-col items-center"},ee={key:1},le={class:"relative"},te={class:"relative container mx-auto px-4 py-8"},ae={class:"flex flex-col md:flex-row gap-6"},se={class:"flex flex-col items-center gap-4 flex-shrink-0 mx-auto md:mx-0"},re={class:"w-32 sm:w-48 h-44 sm:h-64"},oe=["src","alt"],ne={key:1,class:"w-full h-full bg-gray-700 rounded-lg animate-pulse"},ie=["disabled"],ue={class:"flex-1 text-white text-center md:text-left"},ce={class:"text-xl sm:text-2xl md:text-3xl font-bold mb-3"},de={class:"text-sm sm:text-base text-gray-300 mb-2"},ve={class:"text-sm sm:text-base text-gray-300 mb-4"},me={class:"flex flex-wrap justify-center md:justify-start gap-3 sm:gap-6 mb-4"},pe={class:"flex items-center gap-1 sm:gap-2"},ge={class:"text-sm sm:text-base"},he={class:"text-gray-400 text-xs sm:text-sm"},xe={class:"flex items-center gap-1 sm:gap-2"},fe={class:"text-sm sm:text-base"},be={class:"flex items-center gap-1 sm:gap-2"},ye={class:"text-sm sm:text-base"},we={key:0,class:"flex flex-wrap gap-2 mb-6"},ke=["onClick"],Ce={key:1,class:"text-gray-300 mb-6 line-clamp-3"},Ie={class:"container mx-auto px-4 py-6"},je={class:"flex border-b border-gray-700 mb-6"},Me={class:"text-xs sm:text-sm"},ze={class:"bg-gray-900/60 backdrop-blur-sm border border-white/10 rounded-xl p-4 sm:p-6"},Le={key:0,class:"space-y-4"},Ve={key:0,class:"grid grid-cols-3 md:grid-cols-5 lg:grid-cols-6 gap-3"},Be=["onClick"],_e={class:"absolute -top-2 -right-2 z-10 pointer-events-none"},Se={key:0,class:"inline-flex items-center px-2 py-0.5 text-xs font-bold bg-pink-500 text-white rounded-full"},He={key:1,class:"inline-flex items-center px-2 py-0.5 text-xs font-bold bg-green-500 text-white rounded-full"},Pe={key:2,class:"inline-flex items-center px-2 py-0.5 text-xs font-bold bg-gradient-to-r from-yellow-500 to-yellow-600 text-white rounded-full animate-pulse"},Ee={key:1,class:"flex flex-col items-center gap-4"},Te={key:0,class:"absolute -top-2 -right-2 z-10 pointer-events-none"},$e={class:"text-center text-gray-400 text-sm"},Ue={key:0},Ae={key:1,class:"space-y-4"},De={key:0,class:"space-y-4"},Ye={class:"flex-shrink-0"},qe=["src","alt"],Oe={class:"flex-1 min-w-0"},Fe={class:"flex items-center gap-2 mb-2"},Re={class:"font-semibold text-white text-sm sm:text-base truncate"},Ne={class:"text-xs text-gray-500"},We={class:"text-gray-300 text-sm sm:text-base break-words"},Ge={key:1,class:"text-center py-8 text-gray-500"},Je={key:2,class:"flex justify-center py-8"},Ke={key:0,class:"container mx-auto px-4 pb-6"},Qe={class:"bg-gray-900/60 backdrop-blur-sm border border-white/10 rounded-lg p-4 sm:p-6"},Xe={class:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-4"},Ze={class:"container mx-auto"},el={class:"flex items-center justify-between px-3 sm:px-4 py-2"},ll={class:"hidden sm:flex items-center gap-3 text-sm flex-1 justify-center"},tl={class:"text-white font-semibold text-base"},al={class:"text-gray-400"},sl={class:"flex sm:hidden items-center text-xs flex-1 justify-center px-2 gap-2"},rl={class:"text-white font-semibold truncate"},ol={class:"text-gray-400"},nl={class:"flex items-center gap-1 sm:gap-2"},il=["title"],ul={key:0,class:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20"},cl={key:1,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},dl={class:"h-0.5 bg-gray-800"},vl=["title"],ml={key:0,class:"w-4 h-4 sm:w-5 sm:h-5",fill:"currentColor",viewBox:"0 0 20 20"},pl={key:1,class:"w-4 h-4 sm:w-5 sm:h-5",fill:"currentColor",viewBox:"0 0 20 20"},gl={key:1,class:"flex justify-center items-center h-screen"},hl={class:"flex flex-col items-center"},xl={key:2,class:"flex justify-center items-center h-screen"},fl={class:"bg-red-900/50 border border-red-700 rounded-lg p-6 text-center max-w-md"},bl={class:"text-red-400"},yl={key:3,class:"pt-10 pb-8 bg-black"},wl={class:"max-w-3xl sm:max-w-4xl lg:max-w-5xl mx-auto"},kl=["data-index"],Cl={key:0,class:"flex items-center justify-center min-h-[300px] sm:min-h-[500px]"},Il={key:0,class:"flex flex-col items-center text-gray-400"},jl=["onClick"],Ml=["src","alt","onLoad","onError"],zl={key:0,class:"mt-8 text-center"},Ll=["disabled"],Vl={key:0,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Bl={key:1,class:"w-5 h-5 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},_l={class:"text-gray-400 text-sm mt-2"},Sl={key:1,class:"mt-8 p-6 bg-gradient-to-br from-gray-800 to-gray-900 rounded-xl border border-yellow-500/30"},Hl={class:"text-center space-y-4"},Pl={class:"text-gray-300"},El={class:"flex flex-col sm:flex-row gap-3 justify-center mt-6"},Tl={key:2,class:"mt-12 mb-8"},$l={class:"relative px-4 py-8 sm:py-12"},Ul={class:"relative max-w-md mx-auto"},Al={class:"relative overflow-hidden rounded-2xl bg-gray-900/60 backdrop-blur-xl border border-white/10 p-6 sm:p-8 transition-all duration-300 group-hover:bg-gray-900/70 group-hover:border-white/20 group-hover:shadow-2xl group-hover:shadow-pink-500/20"},Dl={class:"relative flex items-center justify-between"},Yl={class:"relative"},ql={key:0,class:"w-8 h-8 sm:w-10 sm:h-10 text-white",fill:"currentColor",viewBox:"0 0 20 20"},Ol={key:1,class:"w-8 h-8 sm:w-10 sm:h-10 text-white transform group-hover:translate-x-1 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Fl={key:0,class:"mt-4 pt-4 border-t border-white/10"},Rl={class:"relative w-full max-w-md sm:max-w-lg"},Nl={class:"relative bg-gray-900/90 backdrop-blur-xl rounded-2xl w-full p-4 sm:p-6 border border-white/10 max-h-[90vh] overflow-y-auto"},Wl={class:"flex items-center justify-between mb-4 sm:mb-6"},Gl={key:0,class:"mb-3 sm:mb-6"},Jl={class:"block text-xs sm:text-sm font-medium text-gray-300 mb-1.5 sm:mb-2"},Kl={key:1,class:"mb-3 sm:mb-6 space-y-3 sm:space-y-4"},Ql={class:"block text-xs sm:text-sm font-medium text-gray-300 mb-1.5 sm:mb-2"},Xl={class:"block text-xs sm:text-sm font-medium text-gray-300 mb-1.5 sm:mb-2"},Zl={class:"mb-4 sm:mb-6"},et={class:"grid grid-cols-2 gap-2 sm:gap-3"},lt={class:"text-[10px] sm:text-xs text-gray-500 mt-1 sm:mt-2"},tt={class:"mb-3 sm:mb-4"},at={class:"flex items-center justify-between p-2 sm:p-3 bg-gray-800/50 backdrop-blur-sm rounded-lg border border-white/10"},st={class:"mb-3 sm:mb-4"},rt=["disabled"],ot={key:0,class:"flex items-center justify-center gap-1.5"},nt={key:1,class:"flex items-center justify-center gap-1.5"},it={key:2},ut={class:"text-[10px] sm:text-xs text-gray-500 mt-1.5"},ct={key:0},dt={key:1},vt=l({__name:"ChapterView",setup(e){const l=r(),vt=y(),mt=t(),pt=a(),gt=R(),ht=s(()=>l.params.id),xt=o({}),ft=o(!1),bt=o(!1),yt=o([]),wt=o(!1),kt=o(!1),Ct=o(""),It=o(1),jt=o(!0),Mt=o("chapters"),zt=o(!1),Lt=o(null),Vt=o(""),Bt=o([]),_t=o(!1),St=o(""),Ht=o(0),Pt=o(0),Et=o(!1),Tt=o(!1),$t=o(0),Ut=o(0),At=o(!1),Dt=o(0),Yt=o(null),qt=o(!0),Ot=o(0),Ft=o("true"===localStorage.getItem("autoScrollEnabled")),Rt=o(!0),Nt=o(parseInt(localStorage.getItem("autoScrollSpeed"))||50),Wt=o(localStorage.getItem("autoScrollMode")||"smooth"),Gt=o(parseFloat(localStorage.getItem("stepInterval"))||3),Jt=o(parseInt(localStorage.getItem("stepSize"))||425),Kt=o(null),Qt=o(!1),Xt=o(!1);o({});const Zt=o(-1),ea=o([]),la=o([]),ta=o(null),aa=o(null),sa=o(!1),ra=o(!1),oa=o(!1),na=o(!1),ia=o("");let ua=[],ca=0,da=null;const va=s(()=>ft.value),ma=s(()=>[...[...xt.value.tags||[]],...xt.value.actors||[]].filter(Boolean)),pa=s(()=>{const e=xt.value.likes||0,l=xt.value.total_views||1;return Math.floor(e/l*100)}),ga=s(()=>Bt.value.length?Math.floor(($t.value+1)/Bt.value.length*100):0),ha=s(()=>{if(!Lt.value)return"";if(xt.value.series?.length){const e=xt.value.series.findIndex(e=>e.id==Lt.value);if(e>=0)return`第${e+1}章`}return"第1章"}),xa=s(()=>{if(!xt.value.series?.length||!Lt.value)return!1;return xt.value.series.findIndex(e=>e.id==Lt.value)>0}),fa=s(()=>{if(!xa.value)return null;const e=xt.value.series.findIndex(e=>e.id==Lt.value);return e>0?xt.value.series[e-1].id:null}),ba=s(()=>{if(!xt.value.series?.length||!Lt.value)return!1;const e=xt.value.series.findIndex(e=>e.id==Lt.value);return e>=0&&e<xt.value.series.length-1}),ya=s(()=>{if(!ba.value)return null;const e=xt.value.series.findIndex(e=>e.id==Lt.value);return e>=0&&e<xt.value.series.length-1?xt.value.series[e+1].id:null}),wa=s(()=>!!Bt.value.length&&Bt.value.every(e=>e.loaded||e.error)),ka=s(()=>{if(!ba.value)return!1;const e=xt.value.series.findIndex(e=>e.id==Lt.value);return Sa(e+1)}),Ca=e=>`${x()}/media/albums/${e}_3x4.jpg`,Ia=e=>({id:e.id,name:e.name||e.title,title:e.name||e.title,image:e.image||null}),ja=e=>{e.target.src="/default.jpeg"},Ma=e=>{e.target.src="/default.jpeg"},za=async()=>{if(mt.isLoggedIn){if(!bt.value){bt.value=!0;try{const e=await O({id:ht.value,name:xt.value.name,author:xt.value.author?.join(" & ")});"is_collected"in e&&(ft.value=e.is_collected,e.is_collected?gt.success("收藏成功"):gt.success("取消收藏成功"))}catch(e){gt.error("操作失败，请稍后重试")}finally{bt.value=!1}}}else ra.value=!0},La=e=>{const l=document.createElement("DIV");return l.innerHTML=e,l.textContent||l.innerText||""},Va=async()=>{if(ht.value&&"undefined"!==ht.value){wt.value=!0,Ct.value="";try{const l=await p(ht.value);if(xt.value=l,mt.isLoggedIn&&ht.value)try{const e=await g(ht.value);ft.value=e.is_collected||!1}catch(e){ft.value=!1}else ft.value=!1;"comments"!==Mt.value||yt.value.length||Ja(),await Ba()}catch(e){Ct.value="加载失败，请稍后重试"}finally{wt.value=!1}}else wt.value=!1},Ba=async()=>{const e=await m.getByComicId(ht.value);e&&(Zt.value=e.chapterIndex)},_a=()=>!!mt.user?.vip_expired_at&&new Date(mt.user.vip_expired_at)>new Date,Sa=e=>(!mt.isLoggedIn||!_a())&&(!!xt.value.series?.length&&e>=10),Ha=()=>{Da(ht.value,!0)},Pa=()=>{Fa(),vt.push("/vip")},Ea=()=>{ra.value=!1,vt.push({path:"/login",query:{redirect:l.fullPath}})},Ta=()=>{ra.value=!1,vt.push({path:"/register",query:{redirect:l.fullPath}})},$a=()=>{oa.value=!1,vt.push("/vip")},Ua=()=>{Lt.value?(ia.value=`是否要为《${xt.value.name}》${ha.value}添加书签？`,na.value=!0):gt.warning("请先选择一个章节")},Aa=async()=>{try{const e={comic_id:ht.value,chapter_id:Lt.value,comic_name:xt.value.name},l=await F(e);l.already_exists?gt.info("该章节已添加书签"):l.is_update?gt.info("书签已更新到当前章节"):gt.success("书签添加成功")}catch(e){"limit_reached"===e.response?.data?.error_type?gt.error(e.response.data.message||"书签数量已达上限（50个），请删除一些书签后再试"):gt.error(e.response?.data?.message||"添加书签失败，请稍后再试")}finally{na.value=!1}},Da=async(e,l=!1)=>{if(Ut.value=window.scrollY,Yt.value=e,qt.value=!0,Ot.value=0,(async e=>{const l=ht.value;let t="",a=-1;xt.value.series?.length?(a=xt.value.series.findIndex(l=>l.id==e),a>=0&&(t=`第${a+1}章`)):(a=0,t="单章节"),a>=0&&await m.add({comicId:l,comicTitle:xt.value.name||"",chapterId:e,chapterTitle:t,chapterIndex:a,coverImage:Ca(l)}),Zt.value=a})(e),Lt.value=e,zt.value=!0,_t.value=!0,St.value="",Bt.value=[],Ht.value=0,$t.value=0,Pt.value=0,Et.value=!1,Tt.value=!1,Ft.value&&(Rt.value=!0,Kt.value&&(clearInterval(Kt.value),Kt.value=null)),xt.value.series?.length){xt.value.series.find(l=>l.id==e);const l=xt.value.series.findIndex(l=>l.id==e);Vt.value=`${xt.value.name} - 第${l+1}章`}else Vt.value=xt.value.name;try{const t=await h(e);if(t.images&&t.images.length){const a=mt.isLoggedIn&&_a(),s=l&&!a,r=10,o=t.images,n=s?o.slice(0,r):o;Bt.value=n.map((l,t)=>({name:l,src:G(x(),e,l),loaded:!1,loading:!1,error:!1,needProcess:parseInt(e)>=220980&&!l.includes(".gif"),index:t})),At.value=s,Dt.value=o.length,s?(Pt.value=Bt.value.length,Et.value=!1):(Pt.value=Math.min(50,Bt.value.length),Et.value=Bt.value.length>50),await f(),Xa(),Oa()}else St.value="没有找到章节内容"}catch(t){St.value="加载失败，请稍后重试"}finally{_t.value=!1}},Ya=async()=>{if(!Tt.value&&Et.value){Tt.value=!0;try{const e=Pt.value,l=Math.min(e+50,Bt.value.length);Pt.value=l,Et.value=l<Bt.value.length,await f(),Xa()}finally{Tt.value=!1}}},qa=e=>{const l=e.target.scrollTop;l<Ot.value||l<50?qt.value=!0:l>Ot.value&&l>50&&(qt.value=!1),Ot.value=l,Oa()},Oa=()=>{if(!ta.value||!ea.value.length)return;const e=ta.value,l=e.scrollTop,t=l+e.clientHeight/2;for(let a=0;a<ea.value.length;a++){const s=ea.value[a];if(s){const r=s.getBoundingClientRect(),o=e.getBoundingClientRect(),n=r.top-o.top+l,i=n+s.offsetHeight;if(t>=n&&t<=i){$t.value=a;break}}}},Fa=()=>{Ft.value&&!Rt.value&&(as(),Rt.value=!0),zt.value=!1,Lt.value=null,Bt.value=[],Ht.value=0,Pt.value=0,Et.value=!1,Tt.value=!1,$t.value=0,qt.value=!0,Ot.value=0,da&&(da.disconnect(),da=null),f(()=>{window.scrollTo(0,Ut.value)})},Ra=()=>{if(ya.value){const e=xt.value.series.findIndex(e=>e.id==Lt.value);if(Sa(e+1))return Fa(),void(mt.isLoggedIn?oa.value=!0:ra.value=!0);Ft.value&&!Rt.value&&(as(),Rt.value=!0),Bt.value=[],Ht.value=0,$t.value=0,da&&(da.disconnect(),da=null),ta.value&&ta.value.scrollTo({top:0,behavior:"smooth"}),Da(ya.value)}},Na=()=>{Ra()},Wa=()=>{fa.value&&(Ft.value&&!Rt.value&&(as(),Rt.value=!0),Bt.value=[],Ht.value=0,$t.value=0,da&&(da.disconnect(),da=null),ta.value&&ta.value.scrollTo({top:0,behavior:"smooth"}),Da(fa.value))},Ga=()=>{Lt.value&&Da(Lt.value)},Ja=async()=>{if(!kt.value){kt.value=!0,It.value=1,yt.value=[];try{const e=await b(ht.value,1);yt.value=e,jt.value=e.length>=10}catch(e){}finally{kt.value=!1}}},Ka=async()=>{if(!kt.value&&jt.value){kt.value=!0;try{const e=It.value+1,l=await b(ht.value,e);0===l.length?jt.value=!1:(It.value=e,yt.value.push(...l),jt.value=l.length>=10)}catch(e){}finally{kt.value=!1}}},Qa=async e=>{const l=Bt.value[e];return!l||l.loaded||l.loading?Promise.resolve():new Promise(async t=>{l.loading=!0;const a=J();for(;ca>=a;)await new Promise(e=>setTimeout(e,100));ca++;try{if(l.needProcess){const t=new Image;t.crossOrigin="anonymous",await new Promise((a,s)=>{t.onload=async()=>{const s=l.name.substring(0,5);await f();const r=la.value[e];if(r){const e=W(t,parseInt(Lt.value),s);r.width=e.width,r.height=e.height;r.getContext("2d").drawImage(e,0,0)}l.loaded=!0,l.error=!1,Ht.value++,a()},t.onerror=()=>{l.error=!0,s(new Error("Failed to load image"))},t.src=l.src})}else l.loaded=!0,l.error=!1,Ht.value++,await new Promise(e=>setTimeout(e,50))}catch(s){l.error=!0}finally{l.loading=!1,ca--;const e=ua.shift();void 0!==e&&Qa(e),t()}})},Xa=()=>{da&&da.disconnect(),da=new IntersectionObserver(e=>{e.forEach(e=>{if(e.isIntersecting){const l=parseInt(e.target.dataset.index),t=Bt.value[l];if(!t.loaded&&!t.loading){const e=J();ca<e?Qa(l):ua.includes(l)||ua.push(l)}}})},{rootMargin:"200px"}),f(()=>{ea.value.forEach((e,l)=>{e&&da.observe(e)})})},Za=()=>{if(!zt.value&&aa.value){const e=window.pageYOffset||document.documentElement.scrollTop;sa.value=e>200}},es=e=>{"Escape"===e.key&&zt.value&&Fa()};n(ht,()=>{Va()}),n(Mt,e=>{"comments"!==e||yt.value.length||kt.value||Ja()});const ls=()=>{Ft.value?us():is()},ts=()=>{Rt.value?(Rt.value=!1,ss()):(Rt.value=!0,as())},as=()=>{Kt.value&&(clearInterval(Kt.value),Kt.value=null)},ss=()=>{if(Ft.value)if(Kt.value&&clearInterval(Kt.value),"smooth"===Wt.value)Kt.value=setInterval(()=>{if(!ta.value)return;const e=ta.value,l=e.scrollTop;if(l>=e.scrollHeight-e.clientHeight-10)return void us();const t=l+Nt.value/20;e.scrollTo({top:t,behavior:"auto"})},50);else{const e=1e3*Gt.value;Kt.value=setInterval(()=>{f(()=>{const e=ta.value;if(!e)return;e.scrollTop>=e.scrollHeight-e.clientHeight-10?us():e.scrollBy({top:Jt.value,behavior:"smooth"})})},e)}},rs=()=>{localStorage.setItem("autoScrollSpeed",Nt.value.toString()),Ft.value&&(us(),is())},os=e=>{Wt.value=e,localStorage.setItem("autoScrollMode",e),Ft.value&&(us(),is())},ns=()=>{localStorage.setItem("stepInterval",Gt.value.toString()),localStorage.setItem("stepSize",Jt.value.toString()),Ft.value&&"stepped"===Wt.value&&(us(),is())},is=()=>{if(Ft.value=!0,Rt.value=!1,localStorage.setItem("autoScrollEnabled","true"),Kt.value&&clearInterval(Kt.value),"smooth"===Wt.value)Kt.value=setInterval(()=>{if(!ta.value)return;const e=ta.value,l=e.scrollTop;if(l>=e.scrollHeight-e.clientHeight-10)return void us();const t=l+Nt.value/20;e.scrollTo({top:t,behavior:"auto"})},50);else{const e=1e3*Gt.value;Kt.value=setInterval(()=>{f(()=>{const e=ta.value;if(!e)return;e.scrollTop>=e.scrollHeight-e.clientHeight-10?us():e.scrollBy({top:Jt.value,behavior:"smooth"})})},e)}},us=()=>{Ft.value=!1,Rt.value=!1,localStorage.setItem("autoScrollEnabled","false"),Kt.value&&(clearInterval(Kt.value),Kt.value=null)},cs=async()=>{if(Bt.value.length&&!Xt.value){Xt.value=!0,Pt.value<Bt.value.length&&(Pt.value=Bt.value.length,Et.value=!1,await f());try{da&&da.disconnect();const e=[];if(Bt.value.forEach((l,t)=>{l.loaded||l.loading||l.error||e.push(t)}),0===e.length)return Xt.value=!1,void gt.info("所有图片已加载完成");const l=5;for(let t=0;t<e.length;t+=l){const a=e.slice(t,t+l);await Promise.all(a.map(e=>new Promise(l=>{Qa(e).finally(()=>l())}))),t+l<e.length&&await new Promise(e=>setTimeout(e,100))}gt.success(`成功加载 ${e.length} 张图片`),await f(),Xa()}catch(e){gt.error("部分图片加载失败")}finally{Xt.value=!1}}};return i(async()=>{Ba(),await Va();const e=l.query.chapter;if(e&&pt.isLoggedIn)if(xt.value.series?.length){const l=xt.value.series.find(l=>l.id==e);l&&Da(l.id)}else xt.value.id==e&&Ha();window.addEventListener("scroll",Za),window.addEventListener("keydown",es)}),u(()=>{us(),da&&da.disconnect(),window.removeEventListener("scroll",Za),window.removeEventListener("keydown",es)}),(e,l)=>{const t=w("router-link");return k(),c(v,{title:xt.value.name||"加载中...","show-bottom-nav":!0,"hide-breadcrumbs":!0},{action:d(()=>[xt.value.id?(k(),C("button",{key:0,onClick:za,disabled:bt.value,class:V(["lg:hidden p-2 transition-all",va.value?"text-pink-500":"text-gray-400 hover:text-pink-400"]),title:va.value?"取消收藏":"添加收藏"},[(k(),C("svg",{class:"w-5 h-5",fill:va.value?"currentColor":"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...l[19]||(l[19]=[M("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"},null,-1)])],8,Q))],10,K)):I("",!0)]),default:d(()=>[wt.value?(k(),C("div",X,[M("div",Z,[j(z)])])):zt.value?I("",!0):(k(),C("div",ee,[M("div",le,[xt.value.id?(k(),C("div",{key:0,class:"absolute inset-0 h-96 bg-cover bg-center blur-xl opacity-30",style:L({backgroundImage:`url(${Ca(xt.value.id)})`})},null,4)):I("",!0),M("div",te,[M("div",ae,[M("div",se,[M("div",re,[xt.value.id?(k(),C("img",{key:0,src:Ca(xt.value.id),alt:xt.value.name,class:"w-full h-full object-cover rounded-lg shadow-2xl",onError:ja},null,40,oe)):(k(),C("div",ne))]),M("button",{onClick:za,disabled:bt.value,class:V(["w-full px-4 py-2 rounded-lg font-medium transition-all cursor-pointer flex items-center justify-center gap-2",va.value?"bg-pink-500/20 backdrop-blur-sm border border-pink-500/50 text-pink-400 hover:bg-pink-500/30 hover:border-pink-400":"bg-gray-800/50 backdrop-blur-sm border border-white/10 text-gray-300 hover:bg-gray-700/50 hover:border-white/20"])},[l[20]||(l[20]=M("svg",{class:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20"},[M("path",{"fill-rule":"evenodd",d:"M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z","clip-rule":"evenodd"})],-1)),M("span",null,B(va.value?"已收藏":"收藏"),1)],10,ie)]),M("div",ue,[M("h2",ce,B(xt.value.name),1),M("p",de,"作者: "+B(xt.value.author?.join(" & ")||"未知"),1),M("p",ve,"ID: "+B(ht.value),1),M("div",me,[M("div",pe,[l[21]||(l[21]=M("svg",{class:"w-4 h-4 sm:w-5 sm:h-5 text-pink-400",fill:"currentColor",viewBox:"0 0 20 20"},[M("path",{"fill-rule":"evenodd",d:"M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z","clip-rule":"evenodd"})],-1)),M("span",ge,B(_(S)(xt.value.likes||0)),1),M("span",he,"("+B(pa.value)+"%)",1)]),M("div",xe,[l[22]||(l[22]=M("svg",{class:"w-4 h-4 sm:w-5 sm:h-5 text-blue-400",fill:"currentColor",viewBox:"0 0 20 20"},[M("path",{d:"M10 12a2 2 0 100-4 2 2 0 000 4z"}),M("path",{"fill-rule":"evenodd",d:"M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.064 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z","clip-rule":"evenodd"})],-1)),M("span",fe,B(_(S)(xt.value.total_views||0)),1)]),M("div",be,[l[23]||(l[23]=M("svg",{class:"w-4 h-4 sm:w-5 sm:h-5 text-green-400",fill:"currentColor",viewBox:"0 0 20 20"},[M("path",{"fill-rule":"evenodd",d:"M18 10c0 3.866-3.582 7-8 7a8.841 8.841 0 01-4.083-.98L2 17l1.338-3.123C2.493 12.767 2 11.434 2 10c0-3.866 3.582-7 8-7s8 3.134 8 7zM7 9H5v2h2V9zm8 0h-2v2h2V9zM9 9h2v2H9V9z","clip-rule":"evenodd"})],-1)),M("span",ye,B(_(S)(xt.value.comment_total||0)),1)])]),ma.value.length?(k(),C("div",we,[(k(!0),C(H,null,P(ma.value,e=>(k(),C("span",{key:e,onClick:l=>(e=>{vt.push({path:"/search",query:{wd:e}})})(e),class:"px-3 py-1 bg-gray-700/50 backdrop-blur rounded-full text-sm hover:bg-gray-600 transition-colors cursor-pointer"},B(e),9,ke))),128))])):I("",!0),xt.value.description?(k(),C("p",Ce,B(xt.value.description),1)):I("",!0)])])])]),M("div",Ie,[M("div",je,[M("button",{onClick:l[0]||(l[0]=e=>Mt.value="chapters"),class:V(["px-4 sm:px-6 py-3 font-semibold transition-colors text-sm sm:text-base","chapters"===Mt.value?"text-pink-500 border-b-2 border-pink-500":"text-gray-400 hover:text-white"])}," 章节选择 ",2),M("button",{onClick:l[1]||(l[1]=e=>Mt.value="comments"),class:V(["px-4 sm:px-6 py-3 font-semibold transition-colors flex items-center gap-2 text-sm sm:text-base","comments"===Mt.value?"text-pink-500 border-b-2 border-pink-500":"text-gray-400 hover:text-white"])},[l[24]||(l[24]=E(" 评论 ",-1)),M("span",Me,"("+B(_(S)(xt.value.comment_total||0))+")",1)],2)]),M("div",ze,["chapters"===Mt.value?(k(),C("div",Le,[xt.value.series?.length?(k(),C("div",Ve,[(k(!0),C(H,null,P(xt.value.series,(e,t)=>(k(),C("button",{key:e.id,onClick:l=>((e,l)=>{Sa(l)?mt.isLoggedIn?oa.value=!0:ra.value=!0:Da(e)})(e.id,t),class:V(["relative px-4 py-3 rounded-lg transition-all text-center cursor-pointer transform hover:scale-105 group border",[t===Zt.value?"bg-pink-500/20 backdrop-blur-sm border-pink-500/50 hover:bg-pink-500/30 hover:border-pink-400":Sa(t)?"bg-gray-800/50 backdrop-blur-sm hover:bg-gray-700/50 hover:shadow-lg border-white/10 hover:border-yellow-500/50":"bg-gray-800/50 backdrop-blur-sm hover:bg-gray-700/50 hover:shadow-lg border-white/10 hover:border-green-500/50"]])},[M("div",_e,[t===Zt.value?(k(),C("span",Se," 上次阅读 ")):!_(mt).isLoggedIn&&t<10?(k(),C("span",He," 免费 ")):Sa(t)?(k(),C("span",Pe,[...l[25]||(l[25]=[M("svg",{class:"w-3 h-3 mr-0.5",fill:"currentColor",viewBox:"0 0 20 20"},[M("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})],-1),E(" VIP ",-1)])])):I("",!0)]),M("div",{class:V(["font-semibold transition-colors",{"text-pink-300 group-hover:text-pink-200":t===Zt.value,"text-gray-400 group-hover:text-yellow-400":t!==Zt.value&&Sa(t),"text-white group-hover:text-green-400":t!==Zt.value&&!Sa(t)}])}," 第"+B(t+1)+"章 ",3)],10,Be))),128))])):(k(),C("div",Ee,[M("button",{onClick:l[2]||(l[2]=e=>Ha()),class:"relative px-8 py-4 bg-gradient-to-r from-pink-500 to-rose-500 hover:from-pink-600 hover:to-rose-600 rounded-lg transition-all flex items-center gap-3 cursor-pointer transform hover:scale-105 group shadow-lg hover:shadow-xl"},[_a()?I("",!0):(k(),C("div",Te,[...l[26]||(l[26]=[M("span",{class:"inline-flex items-center px-2 py-0.5 text-xs font-bold bg-green-500 text-white rounded-full"}," 免费预览 ",-1)])])),l[27]||(l[27]=M("svg",{class:"w-6 h-6 text-white transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[M("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})],-1)),l[28]||(l[28]=M("span",{class:"text-lg font-semibold text-white"}," 开始阅读 ",-1))]),M("div",$e,[_a()?I("",!0):(k(),C("p",Ue,[...l[29]||(l[29]=[M("span",{class:"text-green-400"},"✨ 免费预览前10页",-1),M("span",{class:"mx-2"},"•",-1),M("span",null,"VIP可阅读完整内容",-1)])])),_(mt).isLoggedIn?_a()?I("",!0):(k(),C("button",{key:2,onClick:l[3]||(l[3]=e=>oa.value=!0),class:"text-yellow-500 hover:text-yellow-400 font-medium"}," 成为VIP ")):(k(),c(t,{key:1,to:"/login",class:"text-pink-500 hover:text-pink-400 font-medium"},{default:d(()=>[...l[30]||(l[30]=[E(" 立即登录 ",-1)])]),_:1}))])]))])):I("",!0),"comments"===Mt.value?(k(),C("div",Ae,[yt.value.length?(k(),C("div",De,[(k(!0),C(H,null,P(yt.value,e=>{return k(),C("div",{key:e.id,class:"bg-gray-900 rounded-lg p-4 flex gap-4"},[M("div",Ye,[M("img",{src:(l=e.photo,l&&"nopic-Male.gif"!==l?`https://${mt.primaryServer}/media/users/${l}`:"/default.jpeg"),alt:e.username,class:"w-10 h-10 sm:w-12 sm:h-12 rounded-full object-cover bg-gray-700",onError:Ma},null,40,qe)]),M("div",Oe,[M("div",Fe,[M("span",Re,B(e.username),1),M("span",Ne,B(e.addtime),1)]),M("p",We,B(La(e.content)),1)])]);var l}),128))])):kt.value?I("",!0):(k(),C("div",Ge," 暂无评论 ")),kt.value?(k(),C("div",Je,[j(z)])):I("",!0),jt.value&&!kt.value?(k(),C("button",{key:3,onClick:Ka,class:"w-full py-3 bg-pink-600 hover:bg-pink-700 text-white rounded-lg font-medium transition-colors cursor-pointer"}," 加载更多评论 ")):I("",!0)])):I("",!0)])]),xt.value.related_list&&xt.value.related_list.length>0?(k(),C("div",Ke,[M("div",Qe,[l[31]||(l[31]=M("h2",{class:"text-xl font-bold text-white mb-4 flex items-center gap-2"},[M("svg",{class:"w-6 h-6 text-pink-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[M("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 14v6m-3-3h6M6 10h2a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v2a2 2 0 002 2zm10 0h2a2 2 0 002-2V6a2 2 0 00-2-2h-2a2 2 0 00-2 2v2a2 2 0 002 2zM6 20h2a2 2 0 002-2v-2a2 2 0 00-2-2H6a2 2 0 00-2 2v2a2 2 0 002 2z"})]),E(" 相关推荐 ")],-1)),M("div",Xe,[(k(!0),C(H,null,P(xt.value.related_list.slice(0,12),e=>(k(),c(N,{key:e.id,comic:Ia(e),"show-category":!1,"show-stats":!1,"show-tags":!1,"show-author":!1,"show-description":!1,"show-collection-date":!1,"show-episode":!1},null,8,["comic"]))),128))])])])):I("",!0)])),zt.value?(k(),C("div",{key:2,ref_key:"readingContainer",ref:ta,class:"fixed inset-0 z-50 bg-black overflow-y-auto hide-scrollbar",onScroll:qa},[M("div",{class:"fixed top-0 left-0 right-0 z-50 bg-gray-900/95 backdrop-blur-sm border-b border-gray-800 transition-transform duration-300 pt-safe",style:L({transform:qt.value?"translateY(0)":"translateY(-100%)"})},[M("div",Ze,[M("div",el,[M("button",{onClick:Fa,class:"px-3 py-1.5 bg-gray-700 hover:bg-gray-600 rounded-lg text-white text-sm font-medium transition-all flex items-center gap-1.5 cursor-pointer",title:"关闭 (ESC)"},[...l[32]||(l[32]=[M("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[M("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1),M("span",{class:"hidden sm:inline"},"关闭",-1)])]),M("div",ll,[M("span",tl,B(ha.value),1),M("span",al,B($t.value+1)+"/"+B(Bt.value.length),1)]),M("div",sl,[M("span",rl,B(ha.value),1),M("span",ol,B($t.value+1)+"/"+B(Bt.value.length),1)]),M("div",nl,[_(pt).isLoggedIn?(k(),C("button",{key:0,onClick:Ua,class:"px-2 sm:px-3 py-1.5 bg-gray-600 hover:bg-gray-700 text-gray-300 rounded-lg transition-all flex items-center gap-1 sm:gap-1.5 cursor-pointer text-sm font-medium",title:"添加书签"},[...l[33]||(l[33]=[M("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[M("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z"})],-1),M("span",{class:"hidden sm:inline"},"书签",-1)])])):I("",!0),M("button",{onClick:l[4]||(l[4]=e=>Qt.value=!0),class:V(["px-2 sm:px-3 py-1.5 rounded-lg text-sm font-medium transition-all flex items-center gap-1 sm:gap-1.5 cursor-pointer",Ft.value?"bg-green-600 hover:bg-green-700 text-white":"bg-gray-600 hover:bg-gray-700 text-gray-300"]),title:"阅读设置"},[(k(),C("svg",{class:V(["w-4 h-4",Ft.value&&"animate-spin-slow"]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...l[34]||(l[34]=[M("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"},null,-1),M("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"},null,-1)])],2)),l[35]||(l[35]=M("span",{class:"hidden sm:inline"},"设置",-1))],2),xa.value?(k(),C("button",{key:1,onClick:Wa,class:"px-2 sm:px-3 py-1.5 bg-gray-600 hover:bg-gray-700 rounded-lg text-white text-sm font-medium transition-all flex items-center gap-1 sm:gap-1.5 cursor-pointer",title:"上一话"},[...l[36]||(l[36]=[M("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[M("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1),M("span",{class:"hidden sm:inline"},"上一话",-1)])])):I("",!0),ba.value?(k(),C("button",{key:2,onClick:Na,class:V(["px-2 sm:px-3 py-1.5 rounded-lg text-white text-sm font-medium transition-all flex items-center gap-1 sm:gap-1.5 cursor-pointer",ka.value?"bg-yellow-500 hover:bg-yellow-600":"bg-pink-500 hover:bg-pink-600"]),title:ka.value?"下一话(需要VIP)":"下一话"},[ka.value?(k(),C("svg",ul,[...l[37]||(l[37]=[M("path",{"fill-rule":"evenodd",d:"M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z","clip-rule":"evenodd"},null,-1)])])):I("",!0),l[39]||(l[39]=M("span",{class:"hidden sm:inline"},"下一话",-1)),ka.value?I("",!0):(k(),C("svg",cl,[...l[38]||(l[38]=[M("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"},null,-1)])]))],10,il)):I("",!0)])])]),M("div",dl,[M("div",{class:"h-full bg-gradient-to-r from-pink-500 to-pink-400 transition-all duration-300 ease-out",style:L({width:`${ga.value}%`})},null,4)])],4),M("div",{class:"fixed top-0 left-0 right-0 z-50 h-1 bg-gray-800",style:L({transform:qt.value?"translateY(-100%)":"translateY(0)"})},[M("div",{class:"h-full bg-gradient-to-r from-pink-500 to-pink-400 transition-all duration-300 ease-out",style:L({width:`${ga.value}%`})},null,4)],4),Ft.value?(k(),C("button",{key:0,onClick:ts,class:"fixed bottom-4 left-4 z-[55] p-2.5 sm:p-3 bg-gray-800/20 hover:bg-gray-800/40 text-white/30 hover:text-white/50 rounded-full backdrop-blur-sm transition-all duration-200 shadow-lg",title:Rt.value?"继续滚动":"暂停滚动"},[Rt.value?(k(),C("svg",ml,[...l[40]||(l[40]=[M("path",{d:"M6.3 2.841A1.5 1.5 0 004 4.11V15.89a1.5 1.5 0 002.3 1.269l9.344-5.89a1.5 1.5 0 000-2.538L6.3 2.84z"},null,-1)])])):(k(),C("svg",pl,[...l[41]||(l[41]=[M("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zM7 8a1 1 0 012 0v4a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v4a1 1 0 102 0V8a1 1 0 00-1-1z","clip-rule":"evenodd"},null,-1)])]))],8,vl)):I("",!0),_t.value&&!Bt.value.length?(k(),C("div",gl,[M("div",hl,[j(z)])])):I("",!0),St.value?(k(),C("div",xl,[M("div",fl,[l[42]||(l[42]=M("svg",{class:"w-12 h-12 text-red-400 mx-auto mb-4",fill:"currentColor",viewBox:"0 0 20 20"},[M("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})],-1)),M("p",bl,B(St.value),1),M("div",{class:"flex gap-3 justify-center mt-4"},[M("button",{onClick:Ga,class:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors"}," 重试 "),M("button",{onClick:Fa,class:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors cursor-pointer"}," 退出 ")])])])):I("",!0),Bt.value.length?(k(),C("div",yl,[M("div",wl,[(k(!0),C(H,null,P(Bt.value.slice(0,Pt.value),(e,t)=>(k(),C("div",{key:t,ref_for:!0,ref:e=>ea.value[t]=e,class:V(["comic-image-container relative flex items-center justify-center",{"min-h-[300px] sm:min-h-[500px]":!e.loaded}]),"data-index":t},[e.loaded?I("",!0):(k(),C("div",Cl,[e.error?(k(),C("div",{key:1,onClick:e=>(e=>{Bt.value[e].error=!1,Bt.value[e].loaded=!1,Qa(e)})(t),class:"cursor-pointer text-red-400 hover:text-red-300 text-center"},[...l[43]||(l[43]=[M("svg",{class:"w-12 h-12 mx-auto mb-2",fill:"currentColor",viewBox:"0 0 20 20"},[M("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})],-1),M("p",null,"加载失败，点击重试",-1)])],8,jl)):(k(),C("div",Il,[j(z)]))])),e.needProcess?T((k(),C("canvas",{key:1,ref_for:!0,ref:e=>la.value[t]=e,class:"w-full h-auto block"},null,512)),[[$,e.loaded]]):I("",!0),!e.needProcess&&e.loaded?(k(),C("img",{key:2,src:e.src,alt:`Page ${t+1}`,class:"w-full h-auto block",onLoad:e=>(e=>{const l=Bt.value[e];l&&(l.actuallyLoaded=!0)})(t),onError:e=>(e=>{const l=Bt.value[e];l&&(l.error=!0,l.loaded=!1)})(t)},null,40,Ml)):I("",!0)],10,kl))),128)),Et.value&&!At.value?(k(),C("div",zl,[M("button",{onClick:Ya,disabled:Tt.value,class:"px-8 py-4 bg-gradient-to-r from-pink-500 to-purple-600 hover:from-pink-600 hover:to-purple-700 text-white rounded-xl font-medium transition-all transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed cursor-pointer inline-flex items-center gap-2"},[Tt.value?(k(),C("svg",Bl,[...l[45]||(l[45]=[M("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),M("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):(k(),C("svg",Vl,[...l[44]||(l[44]=[M("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 14l-7 7m0 0l-7-7m7 7V3"},null,-1)])])),M("span",null,B(Tt.value?"加载中...":`加载更多 (剩余 ${Bt.value.length-Pt.value} 张)`),1)],8,Ll),M("p",_l," 已显示 "+B(Pt.value)+" / "+B(Bt.value.length)+" 张图片 ",1)])):I("",!0),At.value?(k(),C("div",Sl,[M("div",Hl,[l[47]||(l[47]=M("div",{class:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-yellow-500 to-yellow-600 rounded-full mb-2"},[M("svg",{class:"w-8 h-8 text-white",fill:"currentColor",viewBox:"0 0 20 20"},[M("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})])],-1)),l[48]||(l[48]=M("h3",{class:"text-xl font-bold text-white"},"需要VIP才能继续阅读",-1)),M("p",Pl," 您已预览前5张图片（共"+B(Dt.value)+"张） ",1),l[49]||(l[49]=M("p",{class:"text-gray-400 text-sm"}," 充值即可解锁全部内容，享受无限阅读体验 ",-1)),M("div",El,[_(mt).isLoggedIn?I("",!0):(k(),C("button",{key:0,onClick:l[5]||(l[5]=e=>ra.value=!0),class:"px-6 py-3 bg-gray-600 hover:bg-gray-700 text-white rounded-lg font-medium transition-colors"}," 立即登录 ")),M("button",{onClick:Pa,class:"inline-flex items-center justify-center px-6 py-3 bg-gradient-to-r from-yellow-500 to-yellow-600 hover:from-yellow-600 hover:to-yellow-700 text-white rounded-lg font-bold transition-all shadow-lg"},[...l[46]||(l[46]=[M("svg",{class:"w-5 h-5 mr-2",fill:"currentColor",viewBox:"0 0 20 20"},[M("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})],-1),M("span",null,"立即充值",-1)])])])])])):I("",!0),ba.value&&!At.value?(k(),C("div",Tl,[M("div",{onClick:Ra,class:"relative group cursor-pointer"},[l[59]||(l[59]=M("div",{class:"absolute inset-0 bg-gradient-to-r from-transparent via-gray-900/50 to-transparent"},null,-1)),M("div",$l,[l[57]||(l[57]=M("div",{class:"absolute left-0 right-0 top-1/2 -translate-y-1/2 h-[1px] bg-gradient-to-r from-transparent via-gray-700 to-transparent"},null,-1)),M("div",Ul,[M("div",Al,[l[56]||(l[56]=M("div",{class:"absolute inset-0 bg-gradient-to-r from-pink-500/0 via-pink-500/10 to-purple-500/0 opacity-0 group-hover:opacity-100 transition-opacity duration-500"},null,-1)),M("div",Dl,[l[54]||(l[54]=M("div",{class:"flex-1"},[M("p",{class:"text-gray-400 text-xs sm:text-sm mb-1"},"继续阅读"),M("h3",{class:"text-white text-lg sm:text-xl font-bold mb-2"},"下一话"),M("div",{class:"flex items-center gap-2"},[M("div",{class:"h-1 w-16 bg-gradient-to-r from-pink-500 to-purple-500 rounded-full"}),M("span",{class:"text-gray-500 text-xs"},"轻触继续")])],-1)),M("div",Yl,[l[52]||(l[52]=M("div",{class:"absolute inset-0 rounded-full bg-gradient-to-r from-pink-500 to-purple-500 opacity-20 blur-xl group-hover:opacity-40 transition-opacity"},null,-1)),M("div",{class:V(["relative w-16 h-16 sm:w-20 sm:h-20 rounded-full flex items-center justify-center transition-all duration-300 group-hover:scale-110",ka.value?"bg-gradient-to-br from-yellow-500 to-orange-600":"bg-gradient-to-br from-pink-500 to-purple-600"])},[ka.value?(k(),C("svg",ql,[...l[50]||(l[50]=[M("path",{"fill-rule":"evenodd",d:"M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z","clip-rule":"evenodd"},null,-1)])])):(k(),C("svg",Ol,[...l[51]||(l[51]=[M("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2.5",d:"M13 7l5 5m0 0l-5 5m5-5H6"},null,-1)])]))],2),l[53]||(l[53]=M("div",{class:"absolute inset-0 rounded-full bg-white opacity-0 group-hover:animate-ping"},null,-1))])]),ka.value?(k(),C("div",Fl,[...l[55]||(l[55]=[M("p",{class:"text-yellow-400 text-sm flex items-center gap-2"},[M("svg",{class:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20"},[M("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})]),E(" 需要VIP会员才能阅读 ")],-1)])])):I("",!0)])]),l[58]||(l[58]=M("div",{class:"mt-6 text-center sm:hidden"},[M("p",{class:"text-gray-600 text-xs"},"👆 点击任意位置继续")],-1))])])])):I("",!0)])])):I("",!0),(k(),c(U,{to:"body"},[j(A,{name:"fade"},{default:d(()=>[Qt.value?(k(),C("div",{key:0,class:"fixed inset-0 z-[60] flex items-center justify-center bg-black/60 backdrop-blur-sm p-4",onClick:l[13]||(l[13]=D(e=>Qt.value=!1,["self"]))},[M("div",Rl,[l[69]||(l[69]=M("div",{class:"absolute inset-0 bg-gradient-to-r from-pink-500 via-purple-500 to-blue-500 rounded-2xl blur-sm opacity-50"},null,-1)),M("div",Nl,[M("div",Wl,[l[61]||(l[61]=M("h3",{class:"text-lg sm:text-2xl font-bold text-white flex items-center gap-2"},[M("div",{class:"p-2 bg-pink-500/20 rounded-lg"},[M("svg",{class:"w-5 h-5 sm:w-6 sm:h-6 text-pink-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[M("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),M("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})])]),E(" 阅读设置 ")],-1)),M("button",{onClick:l[6]||(l[6]=e=>Qt.value=!1),class:"p-1.5 hover:bg-white/10 rounded-lg transition-colors cursor-pointer"},[...l[60]||(l[60]=[M("svg",{class:"w-4 h-4 text-gray-400 hover:text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[M("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),"smooth"===Wt.value?(k(),C("div",Gl,[M("label",Jl," 滚动速度: "+B(Nt.value)+" 像素/秒 ",1),T(M("input",{type:"range","onUpdate:modelValue":l[7]||(l[7]=e=>Nt.value=e),onChange:rs,min:"10",max:"500",step:"10",class:"w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer slider"},null,544),[[Y,Nt.value]]),l[62]||(l[62]=M("div",{class:"flex justify-between text-xs sm:text-sm text-gray-500 mt-2"},[M("span",null,"慢"),M("span",null,"中"),M("span",null,"快"),M("span",null,"极快")],-1))])):I("",!0),"stepped"===Wt.value?(k(),C("div",Kl,[M("div",null,[M("label",Ql," 跳动间隔: "+B(Gt.value)+" 秒 ",1),T(M("input",{type:"range","onUpdate:modelValue":l[8]||(l[8]=e=>Gt.value=e),onChange:ns,min:"0.5",max:"5",step:"0.5",class:"w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer slider"},null,544),[[Y,Gt.value]]),l[63]||(l[63]=M("div",{class:"flex justify-between text-xs sm:text-sm text-gray-500 mt-2"},[M("span",null,"快速"),M("span",null,"中等"),M("span",null,"缓慢")],-1))]),M("div",null,[M("label",Xl," 跳动距离: "+B(Jt.value)+" 像素 ",1),T(M("input",{type:"range","onUpdate:modelValue":l[9]||(l[9]=e=>Jt.value=e),onChange:ns,min:"50",max:"800",step:"25",class:"w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer slider"},null,544),[[Y,Jt.value]]),l[64]||(l[64]=M("div",{class:"flex justify-between text-xs sm:text-sm text-gray-500 mt-2"},[M("span",null,"小"),M("span",null,"中"),M("span",null,"大"),M("span",null,"特大")],-1))])])):I("",!0),M("div",Zl,[l[65]||(l[65]=M("label",{class:"block text-sm sm:text-base font-medium text-gray-300 mb-2 sm:mb-3"}," 滚动模式 ",-1)),M("div",et,[M("button",{onClick:l[10]||(l[10]=e=>os("smooth")),class:V(["px-3 sm:px-4 py-2.5 sm:py-3 rounded-lg text-sm sm:text-base font-medium transition-all cursor-pointer","smooth"===Wt.value?"bg-gradient-to-r from-pink-500 to-purple-600 text-white shadow-lg":"bg-gray-800/50 backdrop-blur-sm border border-white/10 text-gray-300 hover:bg-gray-700/50 hover:border-white/20"])}," 平滑滚动 ",2),M("button",{onClick:l[11]||(l[11]=e=>os("stepped")),class:V(["px-3 sm:px-4 py-2.5 sm:py-3 rounded-lg text-sm sm:text-base font-medium transition-all cursor-pointer","stepped"===Wt.value?"bg-gradient-to-r from-pink-500 to-purple-600 text-white shadow-lg":"bg-gray-800/50 backdrop-blur-sm border border-white/10 text-gray-300 hover:bg-gray-700/50 hover:border-white/20"])}," 段落滚动 ",2)]),M("p",lt,B("smooth"===Wt.value?"连续平滑滚动":"模拟鼠标滚轮，一次跳一小段"),1)]),M("div",tt,[M("div",at,[l[66]||(l[66]=M("div",{class:"flex items-center gap-2 sm:gap-3"},[M("div",{class:"p-1.5 sm:p-2 bg-green-500/20 rounded-lg"},[M("svg",{class:"w-4 h-4 sm:w-5 sm:h-5 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[M("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"}),M("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})])]),M("div",{class:"flex-1 min-w-0"},[M("p",{class:"text-white font-medium text-xs sm:text-sm"},"自动滚动"),M("p",{class:"text-gray-400 text-[10px] sm:text-xs"},"开启后页面将自动向下滚动")])],-1)),M("button",{onClick:ls,class:V(["relative inline-flex h-5 sm:h-6 w-9 sm:w-11 flex-shrink-0 items-center rounded-full transition-colors cursor-pointer",Ft.value?"bg-green-600":"bg-gray-600"])},[M("span",{class:V(["inline-block h-3 sm:h-4 w-3 sm:w-4 transform rounded-full bg-white transition-transform",Ft.value?"translate-x-5 sm:translate-x-6":"translate-x-1"])},null,2)],2)])]),M("div",st,[M("button",{onClick:cs,disabled:Xt.value||wa.value,class:V(["w-full py-2 sm:py-2.5 px-3 sm:px-4 rounded-lg text-xs sm:text-sm font-medium transition-all",Xt.value?"bg-gray-800/30 text-gray-500 cursor-not-allowed":wa.value?"bg-green-500/20 border border-green-500/30 text-green-400 cursor-not-allowed":"bg-gray-800/50 backdrop-blur-sm border border-white/10 hover:bg-gray-700/50 hover:border-white/20 text-gray-300 cursor-pointer"])},[wa.value?(k(),C("span",ot,[l[67]||(l[67]=M("svg",{class:"w-3.5 h-3.5 sm:w-4 sm:h-4",fill:"currentColor",viewBox:"0 0 20 20"},[M("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"})],-1)),M("span",null,"已加载全部 "+B(Bt.value.length)+" 张图片",1)])):Xt.value?(k(),C("span",nt,[l[68]||(l[68]=M("svg",{class:"animate-spin h-3.5 w-3.5 sm:h-4 sm:w-4",fill:"none",viewBox:"0 0 24 24"},[M("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),M("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),M("span",null,"加载中... "+B(Ht.value)+"/"+B(Bt.value.length),1)])):(k(),C("span",it,"加载全部图片"))],10,rt),M("p",ut,[wa.value?(k(),C("span",ct,"所有图片已加载完成")):(k(),C("span",dt,"立即加载所有图片，不再等待滚动触发"))])]),M("button",{onClick:l[12]||(l[12]=e=>Qt.value=!1),class:"w-full py-1.5 sm:py-2 px-3 sm:px-4 bg-gray-800/50 backdrop-blur-sm border border-white/10 hover:bg-gray-700/50 hover:border-white/20 text-gray-300 rounded-md sm:rounded-lg text-xs sm:text-sm font-medium transition-all cursor-pointer"}," 关闭 ")])])])):I("",!0)]),_:1})]))],544)):I("",!0),j(q,{modelValue:ra.value,"onUpdate:modelValue":l[14]||(l[14]=e=>ra.value=e),icon:"lock",title:"需要登录",message:"登录后即可继续阅读","confirm-text":"立即登录","cancel-text":"注册账号",onConfirm:Ea,onCancel:Ta},null,8,["modelValue"]),j(q,{modelValue:oa.value,"onUpdate:modelValue":l[15]||(l[15]=e=>oa.value=e),icon:"warning",title:"VIP专享内容",message:"成为VIP会员，解锁全站所有内容","confirm-text":"成为VIP","cancel-text":"返回","confirm-button-class":"bg-yellow-500 hover:bg-yellow-600 text-white",onConfirm:$a,onCancel:l[16]||(l[16]=e=>oa.value=!1)},null,8,["modelValue"]),j(q,{modelValue:na.value,"onUpdate:modelValue":l[17]||(l[17]=e=>na.value=e),icon:"bookmark",title:"添加书签",message:ia.value,"confirm-text":"确认","cancel-text":"取消","confirm-button-class":"bg-yellow-500 hover:bg-yellow-600 text-white",onConfirm:Aa,onCancel:l[18]||(l[18]=e=>na.value=!1)},null,8,["modelValue","message"])]),_:1},8,["title"])}}},[["__scopeId","data-v-25209d5f"]]);export{vt as default};
