import{z as ue,r as u,B as de,o as ve,c as K,w as W,A as ce,q as ge,n as pe,k as be,a0 as me,a as s,b as t,d as o,e as d,f as B,L as A,v as p,F as f,h as k,N as h,t as X,s as Y,O as Z}from"./index-Brj9CnMw.js";import{_ as xe}from"./ComicCard-Bhq8ogBR.js";import{_ as ee}from"./Pagination-B7NFFZ80.js";import{_ as ye}from"./BottomDrawer-FNWjWzQp.js";const fe={class:"container mx-auto px-4 py-6"},ke={key:0,class:"relative"},_e={class:"relative bg-gray-900/80 backdrop-blur-xl border border-white/10 rounded-lg p-4"},he={class:"flex flex-col items-center"},Ce={key:1,class:"sm:hidden mb-4"},we={class:"bg-gradient-to-r from-pink-500/10 to-purple-500/10 rounded-xl p-[1px]"},$e={class:"bg-gray-900/90 backdrop-blur-xl rounded-xl p-3"},Ve={class:"relative flex items-center justify-between bg-gray-800/90 backdrop-blur rounded-xl px-4 py-3 border border-gray-700 group-hover:border-pink-500/50 group-active:scale-[0.98] transition-all"},Se={class:"flex items-center gap-3"},Ie={class:"text-left"},Pe={class:"text-sm font-medium text-white"},Be={class:"flex gap-2 overflow-x-auto pb-1"},Ne=["onClick"],je={key:2,class:"hidden sm:block relative"},De={class:"relative bg-gray-900/60 backdrop-blur-xl border border-white/10 rounded-lg p-4 space-y-4"},Fe={class:"flex flex-wrap gap-2"},Me=["onClick"],qe={key:0,class:"ml-1 text-xs opacity-70"},Le={class:"flex flex-wrap gap-2"},Oe=["onClick"],Ae={key:0},Re={class:"flex flex-wrap gap-2"},Te=["onClick"],ze={key:3,class:"mt-4 mb-4"},Ue={key:4,class:"relative mt-2 sm:mt-4 mb-4 sm:mb-6"},Ee={class:"relative bg-gray-900/60 backdrop-blur-xl border border-white/10 rounded-lg p-3 sm:p-4"},Qe={class:"text-xs sm:text-sm text-gray-400 mb-1.5 sm:mb-2"},Ge={class:"flex flex-wrap gap-1.5 sm:gap-2"},He=["onClick"],Je={key:5,class:"flex justify-center py-8 sm:py-12"},Ke={key:6,class:"grid grid-cols-2 sm:grid-cols-4 md:grid-cols-5 lg:grid-cols-6 xl:grid-cols-6 2xl:grid-cols-7 gap-3 sm:gap-3 md:gap-4 mt-4"},We={key:7,class:"text-center py-8 sm:py-12"},Xe={key:8,class:"flex justify-center py-6 sm:py-8"},Ye={key:9,class:"flex justify-center py-6 sm:py-8"},Ze={key:10,class:"mt-8"},et={class:"px-4 pb-4"},tt={class:"grid grid-cols-2 gap-2"},lt=["onClick"],at={key:0,class:"block text-xs opacity-70 mt-1"},st={class:"px-4 pb-4"},ot={class:"grid grid-cols-2 gap-2"},rt=["onClick"],nt={key:0,class:"px-4 pb-6"},it={class:"grid grid-cols-2 gap-2"},ut=["onClick"],dt={name:"CatalogView"},vt=Object.assign(dt,{setup(ct){const R=be(),te=ge(),b=u([]),T=u([]),i=u(null),g=u(null),m=u("mv"),I=u(!1),F=[{label:"最新",value:""},{label:"最多爱心",value:"tf"},{label:"总排名",value:"mv"},{label:"月排名",value:"mv_m"},{label:"周排名",value:"mp_w"}],le=de(()=>[{label:"最新",value:""},{label:"总榜",value:"mv"},{label:"月榜",value:"mv_m"},{label:"周榜",value:"mp_w"}]),y=u([]),w=u(!1),z=u(!0),L=u(!0),N=u(!1),x=u(0),$=u(!0),j=u(!1),M=u(0),D=u(0),C=u(1),_=u(1),U=()=>{const l=te.query;if(l.page){const e=parseInt(l.page);!isNaN(e)&&e>0&&(x.value=e,_.value=e)}else x.value===0&&(x.value=1,_.value=1);if(l.o){const e=l.o;F.find(r=>r.value===e)&&(m.value=e)}if(l.c&&b.value.length>0)if(l.c.includes("_")){const[e,v]=l.c.split("_"),r=b.value.find(S=>S.slug===e);if(r&&(i.value=r,r.sub_categories)){const S=r.sub_categories.find(q=>q.slug===v);S&&(g.value=S)}}else{const e=b.value.find(v=>v.slug===l.c);e&&(i.value=e)}},E=()=>{const l={};if(l.page=_.value,m.value&&m.value!=="mv"&&(l.o=m.value),i.value){let e=i.value.slug;g.value&&(e="".concat(e,"_").concat(g.value.slug)),e&&(l.c=e)}R.push({query:l})},ae=async()=>{L.value=!0;try{const l=await pe();l&&(b.value=l.categories||[],T.value=l.blocks||[],U(),!i.value&&b.value.length>0&&(i.value=b.value[0]),i.value&&V(!1))}catch(l){console.error("Failed to load categories:",l)}finally{L.value=!1,z.value=!1}},O=async(l=!1)=>{var e;if(!(l&&w.value||!l&&N.value||!$.value&&!l)){l?w.value=!0:N.value=!0;try{let v=((e=i.value)==null?void 0:e.slug)||"";g.value&&v&&(v="".concat(v,"_").concat(g.value.slug));const r=await me(x.value,m.value,v);r!=null&&r.content?(l?y.value=r.content:y.value.push(...r.content),r.total!==void 0&&(M.value=r.total),D.value===0&&r.content.length>0&&(D.value=r.content.length),M.value>0&&D.value>0?C.value=Math.ceil(M.value/D.value):C.value=x.value+(r.content.length>=80?1:0),_.value=x.value,l||x.value++,$.value=r.content.length>=80):($.value=!1,l&&(C.value=0))}catch(v){console.error("Failed to load comics:",v),$.value=!1}finally{l?w.value=!1:N.value=!1}}},V=(l=!0)=>{y.value=[],l&&(x.value=1,_.value=1),$.value=!0,j.value=!0,M.value=0,D.value=0,C.value=1,E(),O(!0)},se=l=>{R.push({path:"/search",query:{wd:l}})},oe=l=>{i.value=l,g.value=null,V(!0)},Q=l=>{m.value=l,V(!0)},G=l=>{g.value=l,V(!0)},re=l=>{i.value=l,g.value=null,I.value=!1,V(!0)},ne=l=>{m.value=l,I.value=!1,V(!0)},H=l=>{g.value=l,I.value=!1,V(!0)},J=l=>{y.value=[],x.value=l,_.value=l,$.value=!0,E(),O(!0),window.scrollTo({top:0,behavior:"smooth"})};return ve(()=>{b.value.length===0&&(U(),x.value===0&&(x.value=1,_.value=1),ae())}),(l,e)=>(s(),K(ce,{title:"分类浏览","page-loading":z.value},{default:W(()=>{var v,r,S,q;return[t("div",fe,[L.value?(s(),o("div",ke,[e[6]||(e[6]=t("div",{class:"absolute inset-0 bg-gradient-to-r from-pink-500/20 via-purple-500/20 to-blue-500/20 rounded-lg blur-xl"},null,-1)),t("div",_e,[t("div",he,[B(A),e[5]||(e[5]=t("span",{class:"mt-3 text-gray-400 text-sm"},"加载分类中...",-1))])])])):d("",!0),b.value.length>0?(s(),o("div",Ce,[t("div",we,[t("div",$e,[t("button",{onClick:e[0]||(e[0]=a=>I.value=!0),class:"w-full mb-3 relative group"},[e[10]||(e[10]=t("div",{class:"absolute inset-0 bg-gradient-to-r from-pink-500/20 to-purple-500/20 rounded-xl blur group-active:blur-xl transition-all"},null,-1)),t("div",Ve,[t("div",Se,[e[8]||(e[8]=t("div",{class:"relative"},[t("svg",{class:"w-5 h-5 text-pink-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"})]),t("div",{class:"absolute inset-0 bg-pink-400 blur-lg opacity-50 animate-pulse"})],-1)),t("div",Ie,[e[7]||(e[7]=t("div",{class:"text-xs text-gray-400 mb-0.5"},"当前筛选",-1)),t("div",Pe,p(((v=i.value)==null?void 0:v.name)||"全部")+" · "+p(((r=F.find(a=>a.value===m.value))==null?void 0:r.label)||"最新"),1)])]),e[9]||(e[9]=t("div",{class:"flex items-center gap-2"},[t("span",{class:"text-xs text-pink-400 font-medium"},"点击修改"),t("div",{class:"bg-pink-500/20 rounded-lg p-1.5 group-hover:bg-pink-500/30 transition-colors"},[t("svg",{class:"w-4 h-4 text-pink-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})])])],-1))])]),t("div",Be,[(s(!0),o(f,null,k(le.value,a=>(s(),o("button",{key:a.value,onClick:c=>Q(a.value),class:h(["flex-shrink-0 px-3 py-1.5 rounded-full text-xs font-medium transition-all",m.value===a.value?"bg-pink-500/20 text-pink-400 border border-pink-500/50":"bg-gray-800 text-gray-400 border border-gray-700"])},p(a.label),11,Ne))),128))])])])])):d("",!0),b.value.length>0?(s(),o("div",je,[e[14]||(e[14]=t("div",{class:"absolute inset-0 bg-gradient-to-r from-pink-500/10 via-purple-500/10 to-blue-500/10 rounded-lg blur-xl"},null,-1)),t("div",De,[t("div",null,[e[11]||(e[11]=t("label",{class:"text-sm text-gray-400 mb-2 block"},"分类",-1)),t("div",Fe,[(s(!0),o(f,null,k(b.value,a=>{var c;return s(),o("button",{key:a.id,onClick:n=>oe(a),class:h(["px-4 py-2 rounded-lg text-sm font-medium transition-colors cursor-pointer",((c=i.value)==null?void 0:c.id)===a.id?"bg-pink-500/20 text-pink-400 border border-pink-500/50":"bg-gray-800/50 text-gray-300 hover:bg-gray-700/50 hover:text-white border border-gray-700"])},[X(p(a.name)+" ",1),a.total_albums>0?(s(),o("span",qe," ("+p(Y(Z)(a.total_albums))+") ",1)):d("",!0)],10,Me)}),128))])]),t("div",null,[e[12]||(e[12]=t("label",{class:"text-sm text-gray-400 mb-2 block"},"排序",-1)),t("div",Le,[(s(),o(f,null,k(F,a=>t("button",{key:a.value,onClick:c=>Q(a.value),class:h(["px-4 py-2 rounded-lg text-sm font-medium transition-colors cursor-pointer",m.value===a.value?"bg-pink-500/20 text-pink-400 border border-pink-500/50":"bg-gray-800/50 text-gray-300 hover:bg-gray-700/50 hover:text-white border border-gray-700"])},p(a.label),11,Oe)),64))])]),(q=(S=i.value)==null?void 0:S.sub_categories)!=null&&q.length&&i.value.id!==0?(s(),o("div",Ae,[e[13]||(e[13]=t("label",{class:"text-sm text-gray-400 mb-2 block"},"子分类",-1)),t("div",Re,[t("button",{onClick:e[1]||(e[1]=a=>G(null)),class:h(["px-4 py-2 rounded-lg text-sm font-medium transition-colors cursor-pointer",g.value?"bg-gray-800/50 text-gray-300 hover:bg-gray-700/50 hover:text-white border border-gray-700":"bg-pink-500/20 text-pink-400 border border-pink-500/50"])}," 全部 ",2),(s(!0),o(f,null,k(i.value.sub_categories,a=>{var c;return s(),o("button",{key:a.CID,onClick:n=>G(a),class:h(["px-4 py-2 rounded-lg text-sm font-medium transition-colors cursor-pointer",((c=g.value)==null?void 0:c.CID)===a.CID?"bg-pink-500/20 text-pink-400 border border-pink-500/50":"bg-gray-800/50 text-gray-300 hover:bg-gray-700/50 hover:text-white border border-gray-700"])},p(a.name),11,Te)}),128))])])):d("",!0)])])):d("",!0),j.value&&C.value>1&&y.value.length>0?(s(),o("div",ze,[B(ee,{"current-page":_.value,"total-pages":C.value,onChange:J},null,8,["current-page","total-pages"])])):d("",!0),j.value?d("",!0):(s(),o("div",Ue,[e[15]||(e[15]=t("div",{class:"absolute inset-0 bg-gradient-to-r from-pink-500/10 via-purple-500/10 to-blue-500/10 rounded-lg blur-xl"},null,-1)),t("div",Ee,[(s(!0),o(f,null,k(T.value,a=>(s(),o("div",{key:a.title,class:"mb-3 sm:mb-4 last:mb-0"},[t("h3",Qe,p(a.title),1),t("div",Ge,[(s(!0),o(f,null,k(a.content,c=>(s(),o("button",{key:c,onClick:n=>se(c),class:"px-2 sm:px-3 py-1 sm:py-1.5 bg-gray-800/50 hover:bg-pink-500/20 text-gray-300 hover:text-pink-400 border border-gray-700 hover:border-pink-500/50 rounded-full text-xs sm:text-sm transition-colors cursor-pointer"},p(c),9,He))),128))])]))),128))])])),w.value?(s(),o("div",Je,[B(A)])):d("",!0),!w.value&&y.value.length>0?(s(),o("div",Ke,[(s(!0),o(f,null,k(y.value,a=>(s(),K(xe,{key:a.id,comic:a},null,8,["comic"]))),128))])):d("",!0),!w.value&&j.value&&y.value.length===0?(s(),o("div",We,[...e[16]||(e[16]=[t("p",{class:"text-gray-400 text-sm"},"暂无相关漫画",-1)])])):d("",!0),$.value&&!w.value&&!N.value&&y.value.length?(s(),o("div",Xe,[t("button",{onClick:e[2]||(e[2]=a=>O()),class:"px-6 py-3 bg-pink-600 hover:bg-pink-700 text-white rounded-lg font-medium transition-colors cursor-pointer"}," 加载更多 ")])):d("",!0),N.value?(s(),o("div",Ye,[B(A)])):d("",!0),j.value&&C.value>1&&y.value.length>0?(s(),o("div",Ze,[B(ee,{"current-page":_.value,"total-pages":C.value,onChange:J},null,8,["current-page","total-pages"])])):d("",!0),B(ye,{modelValue:I.value,"onUpdate:modelValue":e[4]||(e[4]=a=>I.value=a),title:"选择筛选条件",class:"sm:hidden","max-height":"90vh"},{default:W(()=>{var a,c;return[t("div",et,[e[17]||(e[17]=t("div",{class:"text-sm text-gray-400 mb-3"},"分类",-1)),t("div",tt,[(s(!0),o(f,null,k(b.value,n=>{var P;return s(),o("button",{key:n.id,onClick:ie=>re(n),class:h(["py-3 rounded-lg text-sm font-medium transition-colors",((P=i.value)==null?void 0:P.id)===n.id?"bg-pink-500/20 text-pink-400 border border-pink-500/50":"bg-gray-800 text-gray-300 border border-gray-700"])},[X(p(n.name)+" ",1),n.total_albums>0?(s(),o("span",at," ("+p(Y(Z)(n.total_albums))+") ",1)):d("",!0)],10,lt)}),128))])]),t("div",st,[e[18]||(e[18]=t("div",{class:"text-sm text-gray-400 mb-3"},"排序方式",-1)),t("div",ot,[(s(),o(f,null,k(F,n=>t("button",{key:n.value,onClick:P=>ne(n.value),class:h(["py-3 rounded-lg text-sm font-medium transition-colors",m.value===n.value?"bg-pink-500/20 text-pink-400 border border-pink-500/50":"bg-gray-800 text-gray-300 border border-gray-700"])},p(n.label),11,rt)),64))])]),(c=(a=i.value)==null?void 0:a.sub_categories)!=null&&c.length&&i.value.id!==0?(s(),o("div",nt,[e[19]||(e[19]=t("div",{class:"text-sm text-gray-400 mb-3"},"子分类",-1)),t("div",it,[t("button",{onClick:e[3]||(e[3]=n=>H(null)),class:h(["py-3 rounded-lg text-sm font-medium transition-colors",g.value?"bg-gray-800 text-gray-300 border border-gray-700":"bg-pink-500/20 text-pink-400 border border-pink-500/50"])}," 全部 ",2),(s(!0),o(f,null,k(i.value.sub_categories,n=>{var P;return s(),o("button",{key:n.CID,onClick:ie=>H(n),class:h(["py-3 rounded-lg text-sm font-medium transition-colors",((P=g.value)==null?void 0:P.CID)===n.CID?"bg-pink-500/20 text-pink-400 border border-pink-500/50":"bg-gray-800 text-gray-300 border border-gray-700"])},p(n.name),11,ut)}),128))])])):d("",!0)]}),_:1},8,["modelValue"])])]}),_:1},8,["page-loading"]))}}),xt=ue(vt,[["__scopeId","data-v-56a3b360"]]);export{xt as default};
