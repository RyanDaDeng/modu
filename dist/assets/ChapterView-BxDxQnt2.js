import{y as Qt,z as Wt,u as Gt,i as Jt,B as S,q as Zt,r as i,j as dt,o as Xt,m as el,c as Le,w as ze,A as tl,C as ct,D as ll,E as sl,G as ol,H as vt,I as $,J as mt,k as al,K as rl,a as o,d as a,e as d,f as F,b as t,L as je,M as he,N as f,v,s as U,O as Ve,F as xe,h as be,t as re,P as Be,Q as nl,T as il,R as ul,S as dl,U as Re,V as De,W as cl}from"./index-B8U4V0d9.js";import{a as vl}from"./bookmark-sjalhFr7.js";import{u as ml}from"./useNotification-1wcnrzNq.js";import{U as gl}from"./UnifiedComicCard-aNZ0XU3r.js";function pl(p,M){if(p>=220980&&p<268850)return 10;const I=Qt(p+M);let m=I.charCodeAt(I.length-1);return p>=268850&&p<=421925?m=m%10:m=m%8,m>=0&&m<=9?m*2+2:10}function fl(p,M,I){if(M<220980||p.src.includes(".gif"))return p;const m=document.createElement("canvas"),ne=m.getContext("2d");m.width=p.naturalWidth,m.height=p.naturalHeight;const h=pl(M,I),g=Math.floor(m.height/h),r=m.height%h;ne.drawImage(p,0,m.height-g-r,m.width,g+r,0,0,m.width,g+r);for(let j=0;j<h-1;j++)ne.drawImage(p,0,g*(h-j-2),m.width,g,0,(j+1)*g+r,m.width,g);return m}function hl(p,M,I){return`${p}/media/photos/${M}/${I}`}function gt(){const p=new Date().getHours();return p<=3||p>=21?1:p>=18?3:5}const xl=["disabled","title"],bl=["fill"],wl={key:0,class:"flex justify-center items-center min-h-screen"},yl={class:"flex flex-col items-center"},kl={key:1},_l={class:"relative"},Cl={class:"relative container mx-auto px-4 py-8"},Il={class:"flex flex-col md:flex-row gap-6"},Sl={class:"flex flex-col items-center gap-4 flex-shrink-0 mx-auto md:mx-0"},Ml={class:"w-32 sm:w-48 h-44 sm:h-64"},Ll=["src","alt"],zl={key:1,class:"w-full h-full bg-gray-700 rounded-lg animate-pulse"},jl=["disabled"],Vl={class:"flex-1 text-white text-center md:text-left"},Bl={class:"text-xl sm:text-2xl md:text-3xl font-bold mb-3"},Pl={class:"text-sm sm:text-base text-gray-300 mb-2"},$l={class:"text-sm sm:text-base text-gray-300 mb-4"},Tl={class:"flex flex-wrap justify-center md:justify-start gap-3 sm:gap-6 mb-4"},Hl={class:"flex items-center gap-1 sm:gap-2"},El={class:"text-sm sm:text-base"},Al={class:"text-gray-400 text-xs sm:text-sm"},Rl={class:"flex items-center gap-1 sm:gap-2"},Dl={class:"text-sm sm:text-base"},Fl={class:"flex items-center gap-1 sm:gap-2"},Ul={class:"text-sm sm:text-base"},Nl={key:0,class:"flex flex-wrap gap-2 mb-6"},ql=["onClick"],Yl={key:1,class:"text-gray-300 mb-6 line-clamp-3"},Ol={class:"container mx-auto px-4 py-6"},Kl={class:"flex border-b border-gray-700 mb-6"},Ql={class:"text-xs sm:text-sm"},Wl={class:"bg-gray-900/60 backdrop-blur-sm border border-white/10 rounded-xl p-4 sm:p-6"},Gl={key:0,class:"space-y-4"},Jl={key:0,class:"grid grid-cols-3 md:grid-cols-5 lg:grid-cols-6 gap-3"},Zl=["onClick"],Xl={class:"absolute -top-2 -right-2 z-10 pointer-events-none"},es={key:0,class:"inline-flex items-center px-2 py-0.5 text-xs font-bold bg-pink-500 text-white rounded-full"},ts={key:1,class:"inline-flex items-center px-2 py-0.5 text-xs font-bold bg-green-500 text-white rounded-full"},ls={key:2,class:"inline-flex items-center px-2 py-0.5 text-xs font-bold bg-gradient-to-r from-yellow-500 to-yellow-600 text-white rounded-full animate-pulse"},ss={key:1,class:"flex flex-col items-center gap-4"},os={key:0,class:"absolute -top-2 -right-2 z-10 pointer-events-none"},as={class:"text-center text-gray-400 text-sm"},rs={key:0},ns={key:1,class:"space-y-4"},is={key:0,class:"space-y-4"},us={class:"flex-shrink-0"},ds=["src","alt"],cs={class:"flex-1 min-w-0"},vs={class:"flex items-center gap-2 mb-2"},ms={class:"font-semibold text-white text-sm sm:text-base truncate"},gs={class:"text-xs text-gray-500"},ps={class:"text-gray-300 text-sm sm:text-base break-words"},fs={key:1,class:"text-center py-8 text-gray-500"},hs={key:2,class:"flex justify-center py-8"},xs={key:0,class:"container mx-auto px-4 pb-6"},bs={class:"bg-gray-900/60 backdrop-blur-sm border border-white/10 rounded-lg p-4 sm:p-6"},ws={class:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-4"},ys={class:"container mx-auto"},ks={class:"flex items-center justify-between px-3 sm:px-4 py-2"},_s={class:"hidden sm:flex items-center gap-3 text-sm flex-1 justify-center"},Cs={class:"text-white font-semibold text-base"},Is={class:"text-gray-400"},Ss={class:"flex sm:hidden items-center text-xs flex-1 justify-center px-2 gap-2"},Ms={class:"text-white font-semibold truncate"},Ls={class:"text-gray-400"},zs={class:"flex items-center gap-1 sm:gap-2"},js=["title"],Vs={key:0,class:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20"},Bs={key:1,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Ps={class:"h-0.5 bg-gray-800"},$s=["title"],Ts={key:0,class:"w-4 h-4 sm:w-5 sm:h-5",fill:"currentColor",viewBox:"0 0 20 20"},Hs={key:1,class:"w-4 h-4 sm:w-5 sm:h-5",fill:"currentColor",viewBox:"0 0 20 20"},Es={key:1,class:"flex justify-center items-center h-screen"},As={class:"flex flex-col items-center"},Rs={key:2,class:"flex justify-center items-center h-screen"},Ds={class:"bg-red-900/50 border border-red-700 rounded-lg p-6 text-center max-w-md"},Fs={class:"text-red-400"},Us={key:3,class:"pt-10 pb-8 bg-black"},Ns={class:"max-w-3xl sm:max-w-4xl lg:max-w-5xl mx-auto"},qs=["data-index"],Ys={key:0,class:"flex items-center justify-center min-h-[300px] sm:min-h-[500px]"},Os={key:0,class:"flex flex-col items-center text-gray-400"},Ks=["onClick"],Qs=["src","alt","onLoad","onError"],Ws={key:0,class:"mt-8 text-center"},Gs=["disabled"],Js={key:0,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Zs={key:1,class:"w-5 h-5 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Xs={class:"text-gray-400 text-sm mt-2"},eo={key:1,class:"mt-8 p-6 bg-gradient-to-br from-gray-800 to-gray-900 rounded-xl border border-yellow-500/30"},to={class:"text-center space-y-4"},lo={class:"text-gray-300"},so={class:"flex flex-col sm:flex-row gap-3 justify-center mt-6"},oo={key:2,class:"mt-12 mb-8"},ao={class:"relative px-4 py-8 sm:py-12"},ro={class:"relative max-w-md mx-auto"},no={class:"relative overflow-hidden rounded-2xl bg-gray-900/60 backdrop-blur-xl border border-white/10 p-6 sm:p-8 transition-all duration-300 group-hover:bg-gray-900/70 group-hover:border-white/20 group-hover:shadow-2xl group-hover:shadow-pink-500/20"},io={class:"relative flex items-center justify-between"},uo={class:"relative"},co={key:0,class:"w-8 h-8 sm:w-10 sm:h-10 text-white",fill:"currentColor",viewBox:"0 0 20 20"},vo={key:1,class:"w-8 h-8 sm:w-10 sm:h-10 text-white transform group-hover:translate-x-1 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},mo={key:0,class:"mt-4 pt-4 border-t border-white/10"},go={class:"relative w-full max-w-md sm:max-w-lg"},po={class:"relative bg-gray-900/90 backdrop-blur-xl rounded-2xl w-full p-4 sm:p-6 border border-white/10 max-h-[90vh] overflow-y-auto"},fo={class:"flex items-center justify-between mb-4 sm:mb-6"},ho={key:0,class:"mb-3 sm:mb-6"},xo={class:"block text-xs sm:text-sm font-medium text-gray-300 mb-1.5 sm:mb-2"},bo={key:1,class:"mb-3 sm:mb-6 space-y-3 sm:space-y-4"},wo={class:"block text-xs sm:text-sm font-medium text-gray-300 mb-1.5 sm:mb-2"},yo={class:"block text-xs sm:text-sm font-medium text-gray-300 mb-1.5 sm:mb-2"},ko={class:"mb-4 sm:mb-6"},_o={class:"grid grid-cols-2 gap-2 sm:gap-3"},Co={class:"text-[10px] sm:text-xs text-gray-500 mt-1 sm:mt-2"},Io={class:"mb-3 sm:mb-4"},So={class:"flex items-center justify-between p-2 sm:p-3 bg-gray-800/50 backdrop-blur-sm rounded-lg border border-white/10"},Mo={class:"mb-3 sm:mb-4"},Lo=["disabled"],zo={key:0,class:"flex items-center justify-center gap-1.5"},jo={key:1,class:"flex items-center justify-center gap-1.5"},Vo={key:2},Bo={class:"text-[10px] sm:text-xs text-gray-500 mt-1.5"},Po={key:0},$o={key:1},To={class:"mb-3 sm:mb-4"},Ho={class:"flex items-center justify-between p-2 sm:p-3 bg-gray-800/50 backdrop-blur-sm rounded-lg border border-white/10"},Fe=50,Eo={__name:"ChapterView",setup(p){const M=Zt(),I=al(),m=Gt(),ne=Jt(),h=ml(),g=S(()=>M.params.id),r=i({}),j=i(!1),ie=i(!1),N=i([]),we=i(!1),V=i(!1),Ue=i(""),Pe=i(1),J=i(!0),T=i("chapters"),Z=i(!1),x=i(null),Ne=i(""),c=i([]),$e=i(!1),ue=i(""),q=i(0),L=i(0),H=i(!1),E=i(!1),A=i(0),qe=i(0),ye=i(!1),Ye=i(0),pt=i(null),X=i(!0),de=i(0),k=i(localStorage.getItem("autoScrollEnabled")==="true"),_=i(!0),ee=i(parseInt(localStorage.getItem("autoScrollSpeed"))||50),B=i(localStorage.getItem("autoScrollMode")||"smooth"),te=i(parseFloat(localStorage.getItem("stepInterval"))||3),le=i(parseInt(localStorage.getItem("stepSize"))||425),b=i(null),ce=i(!1),Y=i(!1),se=i(localStorage.getItem("hideScrollbar")!=="false");i({});const O=i(-1),ve=i([]),Oe=i([]),C=i(null),ft=i(null),ht=i(!1),R=i(!1),K=i(!1),me=i(!1),Ke=i("");let Te=[],ke=0,w=null;const ge=S(()=>j.value),Qe=S(()=>{const l=[...r.value.tags||[]],e=r.value.actors||[];return[...l,...e].filter(Boolean)}),xt=S(()=>{const l=r.value.likes||0,e=r.value.total_views||1;return Math.floor(l/e*100)}),We=S(()=>c.value.length?Math.floor((A.value+1)/c.value.length*100):0),He=S(()=>{if(!x.value)return"";if(r.value.series?.length){const l=r.value.series.findIndex(e=>e.id==x.value);if(l>=0)return`第${l+1}章`}return"第1章"}),Ge=S(()=>!r.value.series?.length||!x.value?!1:r.value.series.findIndex(e=>e.id==x.value)>0),Je=S(()=>{if(!Ge.value)return null;const l=r.value.series.findIndex(e=>e.id==x.value);return l>0?r.value.series[l-1].id:null}),_e=S(()=>{if(!r.value.series?.length||!x.value)return!1;const l=r.value.series.findIndex(e=>e.id==x.value);return l>=0&&l<r.value.series.length-1}),Ze=S(()=>{if(!_e.value)return null;const l=r.value.series.findIndex(e=>e.id==x.value);return l>=0&&l<r.value.series.length-1?r.value.series[l+1].id:null}),Ce=S(()=>c.value.length?c.value.every(l=>l.loaded||l.error):!1),Q=S(()=>{if(!_e.value)return!1;const e=r.value.series.findIndex(u=>u.id==x.value)+1;return D(e)}),Ee=l=>`${vt()}/media/albums/${l}_3x4.jpg`,bt=l=>({id:l.id,name:l.name||l.title,title:l.name||l.title,image:l.image||null}),wt=l=>!l||l==="nopic-Male.gif"?"/default.jpeg":`https://${m.primaryServer}/media/users/${l}`,yt=l=>{l.target.src="/default.jpeg"},kt=l=>{l.target.src="/default.jpeg"},Xe=async()=>{if(!m.isLoggedIn){R.value=!0;return}if(!ie.value){ie.value=!0;try{const l=await cl({id:g.value,name:r.value.name,author:r.value.author?.join(" & ")});"is_collected"in l&&(j.value=l.is_collected,l.is_collected?h.success("收藏成功"):h.success("取消收藏成功"),console.log("Toggled favorite, new status:",l.is_collected))}catch(l){console.error("Failed to toggle favorite:",l),h.error("操作失败，请稍后重试")}finally{ie.value=!1}}},_t=l=>{const e=document.createElement("DIV");return e.innerHTML=l,e.textContent||e.innerText||""},et=async()=>{if(!g.value||g.value==="undefined"){console.warn("Invalid comic ID:",g.value),we.value=!1;return}we.value=!0,Ue.value="";try{const l=await ll(g.value);if(r.value=l,console.log("Album data:",l),m.isLoggedIn&&g.value)try{const e=await sl(g.value);j.value=e.is_collected||!1,console.log("Favorite status:",e)}catch(e){console.error("Failed to check favorite status:",e),j.value=!1}else j.value=!1;T.value==="comments"&&!N.value.length&&at(),await tt()}catch(l){console.error("Failed to load comic info:",l),Ue.value="加载失败，请稍后重试"}finally{we.value=!1}},tt=async()=>{const l=await ct.getByComicId(g.value);l&&(O.value=l.chapterIndex)},Ct=async l=>{const e=g.value;let u="",s=-1;r.value.series?.length?(s=r.value.series.findIndex(n=>n.id==l),s>=0&&(u=`第${s+1}章`)):(s=0,u="单章节"),s>=0&&await ct.add({comicId:e,comicTitle:r.value.name||"",chapterId:l,chapterTitle:u,chapterIndex:s,coverImage:Ee(e)}),O.value=s},pe=()=>m.user?.vip_expired_at?new Date(m.user.vip_expired_at)>new Date:!1,D=l=>m.isLoggedIn&&pe()?!1:r.value.series?.length?l>=10:!1,It=(l,e)=>{console.log("Chapter clicked:",l,"Index:",e,"Locked:",D(e)),D(e)?m.isLoggedIn?K.value=!0:R.value=!0:oe(l)},lt=()=>{oe(g.value,!0)},St=()=>{fe(),I.push("/vip")},Mt=()=>{R.value=!1,I.push({path:"/login",query:{redirect:M.fullPath}})},Lt=()=>{R.value=!1,I.push({path:"/register",query:{redirect:M.fullPath}})},zt=()=>{K.value=!1,I.push("/vip")},jt=()=>{if(!x.value){h.warning("请先选择一个章节");return}Ke.value=`是否要为《${r.value.name}》${He.value}添加书签？`,me.value=!0},Vt=async()=>{try{const l={comic_id:g.value,chapter_id:x.value,comic_name:r.value.name},e=await vl(l);e.already_exists?h.info("该章节已添加书签"):e.is_update?h.info("书签已更新到当前章节"):h.success("书签添加成功")}catch(l){console.error("Bookmark error:",l),l.response?.data?.error_type==="limit_reached"?h.error(l.response.data.message||"书签数量已达上限（50个），请删除一些书签后再试"):h.error(l.response?.data?.message||"添加书签失败，请稍后再试")}finally{me.value=!1}},oe=async(l,e=!1)=>{if(qe.value=window.scrollY,pt.value=l,X.value=!0,de.value=0,Ct(l),x.value=l,Z.value=!0,$e.value=!0,ue.value="",c.value=[],q.value=0,A.value=0,L.value=0,H.value=!1,E.value=!1,k.value&&(_.value=!0,b.value&&(clearInterval(b.value),b.value=null)),r.value.series?.length){r.value.series.find(s=>s.id==l);const u=r.value.series.findIndex(s=>s.id==l);Ne.value=`${r.value.name} - 第${u+1}章`}else Ne.value=r.value.name;try{const u=await ol(l);if(console.log("Chapter data for",l,":",u),u.images&&u.images.length){const s=m.isLoggedIn&&pe(),n=e&&!s,y=10,W=u.images,ae=n?W.slice(0,y):W;c.value=ae.map((z,G)=>({name:z,src:hl(vt(),l,z),loaded:!1,loading:!1,error:!1,needProcess:parseInt(l)>=220980&&!z.includes(".gif"),index:G})),ye.value=n,Ye.value=W.length,n?(L.value=c.value.length,H.value=!1):(L.value=Math.min(Fe,c.value.length),H.value=c.value.length>Fe),await $(),Ae(),st()}else ue.value="没有找到章节内容"}catch(u){console.error("Failed to load chapter:",u),ue.value="加载失败，请稍后重试"}finally{$e.value=!1}},Bt=async()=>{if(!(E.value||!H.value)){E.value=!0;try{const l=L.value,e=Math.min(l+Fe,c.value.length);L.value=e,H.value=e<c.value.length,await $(),Ae()}finally{E.value=!1}}},Pt=l=>{const e=l.target.scrollTop;e<de.value||e<50?X.value=!0:e>de.value&&e>50&&(X.value=!1),de.value=e,st()},st=()=>{if(!C.value||!ve.value.length)return;const l=C.value,e=l.scrollTop,u=l.clientHeight,s=e+u/2;for(let n=0;n<ve.value.length;n++){const y=ve.value[n];if(y){const W=y.getBoundingClientRect(),ae=l.getBoundingClientRect(),z=W.top-ae.top+e,G=z+y.offsetHeight;if(s>=z&&s<=G){A.value=n;break}}}},fe=()=>{k.value&&!_.value&&(Se(),_.value=!0),Z.value=!1,x.value=null,c.value=[],q.value=0,L.value=0,H.value=!1,E.value=!1,A.value=0,X.value=!0,de.value=0,w&&(w.disconnect(),w=null),$(()=>{window.scrollTo(0,qe.value)})},ot=()=>{if(Ze.value){const e=r.value.series.findIndex(u=>u.id==x.value)+1;if(D(e)){fe(),m.isLoggedIn?K.value=!0:R.value=!0;return}k.value&&!_.value&&(Se(),_.value=!0),c.value=[],q.value=0,A.value=0,w&&(w.disconnect(),w=null),C.value&&C.value.scrollTo({top:0,behavior:"smooth"}),oe(Ze.value)}},$t=()=>{ot()},Tt=()=>{Je.value&&(k.value&&!_.value&&(Se(),_.value=!0),c.value=[],q.value=0,A.value=0,w&&(w.disconnect(),w=null),C.value&&C.value.scrollTo({top:0,behavior:"smooth"}),oe(Je.value))},Ht=()=>{x.value&&oe(x.value)},at=async()=>{if(!V.value){V.value=!0,Pe.value=1,N.value=[];try{const l=await mt(g.value,1);console.log("Loaded comments:",l.length),N.value=l,J.value=l.length>=10,console.log("Has more comments:",J.value)}catch(l){console.error("Failed to load comments:",l)}finally{V.value=!1}}},Et=async()=>{if(!(V.value||!J.value)){V.value=!0;try{const l=Pe.value+1;console.log("Loading more comments, page:",l);const e=await mt(g.value,l);console.log("Loaded more comments:",e.length),e.length===0?J.value=!1:(Pe.value=l,N.value.push(...e),J.value=e.length>=10)}catch(l){console.error("Failed to load more comments:",l)}finally{V.value=!1}}},Ie=async l=>{const e=c.value[l];return!e||e.loaded||e.loading?Promise.resolve():new Promise(async u=>{e.loading=!0;const s=gt();for(;ke>=s;)await new Promise(n=>setTimeout(n,100));ke++;try{if(e.needProcess){const n=new Image;n.crossOrigin="anonymous",await new Promise((y,W)=>{n.onload=async()=>{const ae=e.name.substring(0,5);console.log(`Processing image ${l} with page ${ae}`),await $();const z=Oe.value[l];if(z){const G=fl(n,parseInt(x.value),ae);z.width=G.width,z.height=G.height,z.getContext("2d").drawImage(G,0,0)}e.loaded=!0,e.error=!1,q.value++,y()},n.onerror=()=>{e.error=!0,W(new Error("Failed to load image"))},n.src=e.src})}else e.loaded=!0,e.error=!1,q.value++,await new Promise(n=>setTimeout(n,50))}catch(n){console.error(`Failed to load image ${l}:`,n),e.error=!0}finally{e.loading=!1,ke--;const n=Te.shift();n!==void 0&&Ie(n),u()}})},At=l=>{const e=c.value[l];e&&(e.actuallyLoaded=!0,console.log(`Image ${l} actually loaded in DOM`))},Rt=l=>{const e=c.value[l];e&&(e.error=!0,e.loaded=!1,console.error(`Image ${l} failed to load in DOM`))},Dt=l=>{c.value[l].error=!1,c.value[l].loaded=!1,Ie(l)},Ae=()=>{w&&w.disconnect(),w=new IntersectionObserver(l=>{l.forEach(e=>{if(e.isIntersecting){const u=parseInt(e.target.dataset.index),s=c.value[u];if(!s.loaded&&!s.loading){const n=gt();ke<n?Ie(u):Te.includes(u)||Te.push(u)}}})},{rootMargin:"200px"}),$(()=>{ve.value.forEach((l,e)=>{l&&w.observe(l)})})},rt=()=>{if(!Z.value&&ft.value){const l=window.pageYOffset||document.documentElement.scrollTop;ht.value=l>200}},nt=l=>{l.key==="Escape"&&Z.value&&fe()};dt(g,()=>{et()}),dt(T,l=>{l==="comments"&&!N.value.length&&!V.value&&at()});const Ft=l=>{I.push({path:"/search",query:{wd:l}})},Ut=()=>{k.value?P():Me()},Nt=()=>{_.value?(_.value=!1,Yt()):(_.value=!0,Se())},qt=()=>{se.value=!se.value,localStorage.setItem("hideScrollbar",se.value)},Se=()=>{b.value&&(clearInterval(b.value),b.value=null)},Yt=()=>{if(k.value)if(b.value&&clearInterval(b.value),B.value==="smooth")b.value=setInterval(()=>{if(!C.value)return;const l=C.value,e=l.scrollTop,u=l.scrollHeight-l.clientHeight;if(e>=u-10){P();return}const s=ee.value/20,n=e+s;l.scrollTo({top:n,behavior:"auto"})},50);else{const l=te.value*1e3;b.value=setInterval(()=>{$(()=>{const e=C.value;if(!e)return;const u=e.scrollTop,s=e.scrollHeight-e.clientHeight;if(u>=s-10){P();return}e.scrollBy({top:le.value,behavior:"smooth"})})},l)}},Ot=()=>{localStorage.setItem("autoScrollSpeed",ee.value.toString()),k.value&&(P(),Me())},it=l=>{B.value=l,localStorage.setItem("autoScrollMode",l),k.value&&(P(),Me())},ut=()=>{localStorage.setItem("stepInterval",te.value.toString()),localStorage.setItem("stepSize",le.value.toString()),k.value&&B.value==="stepped"&&(P(),Me())},Me=()=>{if(k.value=!0,_.value=!1,localStorage.setItem("autoScrollEnabled","true"),b.value&&clearInterval(b.value),B.value==="smooth")b.value=setInterval(()=>{if(!C.value)return;const l=C.value,e=l.scrollTop,u=l.scrollHeight-l.clientHeight;if(e>=u-10){P();return}const s=ee.value/20,n=e+s;l.scrollTo({top:n,behavior:"auto"})},50);else{const l=te.value*1e3;b.value=setInterval(()=>{$(()=>{const e=C.value;if(!e)return;const u=e.scrollTop,s=e.scrollHeight-e.clientHeight;if(u>=s-10){P();return}e.scrollBy({top:le.value,behavior:"smooth"})})},l)}},P=()=>{k.value=!1,_.value=!1,localStorage.setItem("autoScrollEnabled","false"),b.value&&(clearInterval(b.value),b.value=null)},Kt=async()=>{if(!(!c.value.length||Y.value)){Y.value=!0,L.value<c.value.length&&(L.value=c.value.length,H.value=!1,await $());try{w&&w.disconnect();const l=[];if(c.value.forEach((u,s)=>{!u.loaded&&!u.loading&&!u.error&&l.push(s)}),l.length===0){Y.value=!1,h.info("所有图片已加载完成");return}console.log(`Loading ${l.length} images...`);const e=5;for(let u=0;u<l.length;u+=e){const s=l.slice(u,u+e);await Promise.all(s.map(n=>new Promise(y=>{Ie(n).finally(()=>y())}))),u+e<l.length&&await new Promise(n=>setTimeout(n,100))}console.log("All images loaded successfully"),h.success(`成功加载 ${l.length} 张图片`),await $(),Ae()}catch(l){console.error("Failed to load all images:",l),h.error("部分图片加载失败")}finally{Y.value=!1}}};return Xt(async()=>{tt(),await et();const l=M.query.chapter;if(l&&ne.isLoggedIn)if(r.value.series?.length){const e=r.value.series.find(u=>u.id==l);e&&oe(e.id)}else r.value.id==l&&lt();window.addEventListener("scroll",rt),window.addEventListener("keydown",nt)}),el(()=>{P(),w&&w.disconnect(),window.removeEventListener("scroll",rt),window.removeEventListener("keydown",nt)}),(l,e)=>{const u=rl("router-link");return o(),Le(tl,{title:r.value.name||"加载中...","show-bottom-nav":!0,"hide-breadcrumbs":!0},{action:ze(()=>[r.value.id?(o(),a("button",{key:0,onClick:Xe,disabled:ie.value,class:f(["lg:hidden p-2 transition-all",ge.value?"text-pink-500":"text-gray-400 hover:text-pink-400"]),title:ge.value?"取消收藏":"添加收藏"},[(o(),a("svg",{class:"w-5 h-5",fill:ge.value?"currentColor":"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...e[19]||(e[19]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"},null,-1)])],8,bl))],10,xl)):d("",!0)]),default:ze(()=>[we.value?(o(),a("div",wl,[t("div",yl,[F(je)])])):Z.value?d("",!0):(o(),a("div",kl,[t("div",_l,[r.value.id?(o(),a("div",{key:0,class:"absolute inset-0 h-96 bg-cover bg-center blur-xl opacity-30",style:he({backgroundImage:`url(${Ee(r.value.id)})`})},null,4)):d("",!0),t("div",Cl,[t("div",Il,[t("div",Sl,[t("div",Ml,[r.value.id?(o(),a("img",{key:0,src:Ee(r.value.id),alt:r.value.name,class:"w-full h-full object-cover rounded-lg shadow-2xl",onError:yt},null,40,Ll)):(o(),a("div",zl))]),t("button",{onClick:Xe,disabled:ie.value,class:f(["w-full px-4 py-2 rounded-lg font-medium transition-all cursor-pointer flex items-center justify-center gap-2",ge.value?"bg-pink-500/20 backdrop-blur-sm border border-pink-500/50 text-pink-400 hover:bg-pink-500/30 hover:border-pink-400":"bg-gray-800/50 backdrop-blur-sm border border-white/10 text-gray-300 hover:bg-gray-700/50 hover:border-white/20"])},[e[20]||(e[20]=t("svg",{class:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{"fill-rule":"evenodd",d:"M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z","clip-rule":"evenodd"})],-1)),t("span",null,v(ge.value?"已收藏":"收藏"),1)],10,jl)]),t("div",Vl,[t("h2",Bl,v(r.value.name),1),t("p",Pl,"作者: "+v(r.value.author?.join(" & ")||"未知"),1),t("p",$l,"ID: "+v(g.value),1),t("div",Tl,[t("div",Hl,[e[21]||(e[21]=t("svg",{class:"w-4 h-4 sm:w-5 sm:h-5 text-pink-400",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{"fill-rule":"evenodd",d:"M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z","clip-rule":"evenodd"})],-1)),t("span",El,v(U(Ve)(r.value.likes||0)),1),t("span",Al,"("+v(xt.value)+"%)",1)]),t("div",Rl,[e[22]||(e[22]=t("svg",{class:"w-4 h-4 sm:w-5 sm:h-5 text-blue-400",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{d:"M10 12a2 2 0 100-4 2 2 0 000 4z"}),t("path",{"fill-rule":"evenodd",d:"M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.064 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z","clip-rule":"evenodd"})],-1)),t("span",Dl,v(U(Ve)(r.value.total_views||0)),1)]),t("div",Fl,[e[23]||(e[23]=t("svg",{class:"w-4 h-4 sm:w-5 sm:h-5 text-green-400",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{"fill-rule":"evenodd",d:"M18 10c0 3.866-3.582 7-8 7a8.841 8.841 0 01-4.083-.98L2 17l1.338-3.123C2.493 12.767 2 11.434 2 10c0-3.866 3.582-7 8-7s8 3.134 8 7zM7 9H5v2h2V9zm8 0h-2v2h2V9zM9 9h2v2H9V9z","clip-rule":"evenodd"})],-1)),t("span",Ul,v(U(Ve)(r.value.comment_total||0)),1)])]),Qe.value.length?(o(),a("div",Nl,[(o(!0),a(xe,null,be(Qe.value,s=>(o(),a("span",{key:s,onClick:n=>Ft(s),class:"px-3 py-1 bg-gray-700/50 backdrop-blur rounded-full text-sm hover:bg-gray-600 transition-colors cursor-pointer"},v(s),9,ql))),128))])):d("",!0),r.value.description?(o(),a("p",Yl,v(r.value.description),1)):d("",!0)])])])]),t("div",Ol,[t("div",Kl,[t("button",{onClick:e[0]||(e[0]=s=>T.value="chapters"),class:f(["px-4 sm:px-6 py-3 font-semibold transition-colors text-sm sm:text-base",T.value==="chapters"?"text-pink-500 border-b-2 border-pink-500":"text-gray-400 hover:text-white"])}," 章节选择 ",2),t("button",{onClick:e[1]||(e[1]=s=>T.value="comments"),class:f(["px-4 sm:px-6 py-3 font-semibold transition-colors flex items-center gap-2 text-sm sm:text-base",T.value==="comments"?"text-pink-500 border-b-2 border-pink-500":"text-gray-400 hover:text-white"])},[e[24]||(e[24]=re(" 评论 ",-1)),t("span",Ql,"("+v(U(Ve)(r.value.comment_total||0))+")",1)],2)]),t("div",Wl,[T.value==="chapters"?(o(),a("div",Gl,[r.value.series?.length?(o(),a("div",Jl,[(o(!0),a(xe,null,be(r.value.series,(s,n)=>(o(),a("button",{key:s.id,onClick:y=>It(s.id,n),class:f(["relative px-4 py-3 rounded-lg transition-all text-center cursor-pointer transform hover:scale-105 group border",[n===O.value?"bg-pink-500/20 backdrop-blur-sm border-pink-500/50 hover:bg-pink-500/30 hover:border-pink-400":D(n)?"bg-gray-800/50 backdrop-blur-sm hover:bg-gray-700/50 hover:shadow-lg border-white/10 hover:border-yellow-500/50":"bg-gray-800/50 backdrop-blur-sm hover:bg-gray-700/50 hover:shadow-lg border-white/10 hover:border-green-500/50"]])},[t("div",Xl,[n===O.value?(o(),a("span",es," 上次阅读 ")):!U(m).isLoggedIn&&n<10?(o(),a("span",ts," 免费 ")):D(n)?(o(),a("span",ls,[...e[25]||(e[25]=[t("svg",{class:"w-3 h-3 mr-0.5",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})],-1),re(" VIP ",-1)])])):d("",!0)]),t("div",{class:f(["font-semibold transition-colors",{"text-pink-300 group-hover:text-pink-200":n===O.value,"text-gray-400 group-hover:text-yellow-400":n!==O.value&&D(n),"text-white group-hover:text-green-400":n!==O.value&&!D(n)}])}," 第"+v(n+1)+"章 ",3)],10,Zl))),128))])):(o(),a("div",ss,[t("button",{onClick:e[2]||(e[2]=s=>lt()),class:"relative px-8 py-4 bg-gradient-to-r from-pink-500 to-rose-500 hover:from-pink-600 hover:to-rose-600 rounded-lg transition-all flex items-center gap-3 cursor-pointer transform hover:scale-105 group shadow-lg hover:shadow-xl"},[pe()?d("",!0):(o(),a("div",os,[...e[26]||(e[26]=[t("span",{class:"inline-flex items-center px-2 py-0.5 text-xs font-bold bg-green-500 text-white rounded-full"}," 免费预览 ",-1)])])),e[27]||(e[27]=t("svg",{class:"w-6 h-6 text-white transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})],-1)),e[28]||(e[28]=t("span",{class:"text-lg font-semibold text-white"}," 开始阅读 ",-1))]),t("div",as,[pe()?d("",!0):(o(),a("p",rs,[...e[29]||(e[29]=[t("span",{class:"text-green-400"},"✨ 免费预览前10页",-1),t("span",{class:"mx-2"},"•",-1),t("span",null,"VIP可阅读完整内容",-1)])])),U(m).isLoggedIn?pe()?d("",!0):(o(),a("button",{key:2,onClick:e[3]||(e[3]=s=>K.value=!0),class:"text-yellow-500 hover:text-yellow-400 font-medium"}," 成为VIP ")):(o(),Le(u,{key:1,to:"/login",class:"text-pink-500 hover:text-pink-400 font-medium"},{default:ze(()=>[...e[30]||(e[30]=[re(" 立即登录 ",-1)])]),_:1}))])]))])):d("",!0),T.value==="comments"?(o(),a("div",ns,[N.value.length?(o(),a("div",is,[(o(!0),a(xe,null,be(N.value,s=>(o(),a("div",{key:s.id,class:"bg-gray-900 rounded-lg p-4 flex gap-4"},[t("div",us,[t("img",{src:wt(s.photo),alt:s.username,class:"w-10 h-10 sm:w-12 sm:h-12 rounded-full object-cover bg-gray-700",onError:kt},null,40,ds)]),t("div",cs,[t("div",vs,[t("span",ms,v(s.username),1),t("span",gs,v(s.addtime),1)]),t("p",ps,v(_t(s.content)),1)])]))),128))])):V.value?d("",!0):(o(),a("div",fs," 暂无评论 ")),V.value?(o(),a("div",hs,[F(je)])):d("",!0),J.value&&!V.value?(o(),a("button",{key:3,onClick:Et,class:"w-full py-3 bg-pink-600 hover:bg-pink-700 text-white rounded-lg font-medium transition-colors cursor-pointer"}," 加载更多评论 ")):d("",!0)])):d("",!0)])]),r.value.related_list&&r.value.related_list.length>0?(o(),a("div",xs,[t("div",bs,[e[31]||(e[31]=t("h2",{class:"text-xl font-bold text-white mb-4 flex items-center gap-2"},[t("svg",{class:"w-6 h-6 text-pink-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 14v6m-3-3h6M6 10h2a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v2a2 2 0 002 2zm10 0h2a2 2 0 002-2V6a2 2 0 00-2-2h-2a2 2 0 00-2 2v2a2 2 0 002 2zM6 20h2a2 2 0 002-2v-2a2 2 0 00-2-2H6a2 2 0 00-2 2v2a2 2 0 002 2z"})]),re(" 相关推荐 ")],-1)),t("div",ws,[(o(!0),a(xe,null,be(r.value.related_list.slice(0,12),s=>(o(),Le(gl,{key:s.id,comic:bt(s),"show-category":!1,"show-stats":!1,"show-tags":!1,"show-author":!1,"show-description":!1,"show-collection-date":!1,"show-episode":!1},null,8,["comic"]))),128))])])])):d("",!0)])),Z.value?(o(),a("div",{key:2,ref_key:"readingContainer",ref:C,class:f(["fixed inset-0 z-50 bg-black overflow-y-auto",se.value&&"hide-scrollbar"]),onScroll:Pt},[t("div",{class:"fixed top-0 left-0 right-0 z-50 bg-gray-900/95 backdrop-blur-sm border-b border-gray-800 transition-transform duration-300 pt-safe",style:he({transform:X.value?"translateY(0)":"translateY(-100%)"})},[t("div",ys,[t("div",ks,[t("button",{onClick:fe,class:"px-3 py-1.5 bg-gray-700 hover:bg-gray-600 rounded-lg text-white text-sm font-medium transition-all flex items-center gap-1.5 cursor-pointer",title:"关闭 (ESC)"},[...e[32]||(e[32]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1),t("span",{class:"hidden sm:inline"},"关闭",-1)])]),t("div",_s,[t("span",Cs,v(He.value),1),t("span",Is,v(A.value+1)+"/"+v(c.value.length),1)]),t("div",Ss,[t("span",Ms,v(He.value),1),t("span",Ls,v(A.value+1)+"/"+v(c.value.length),1)]),t("div",zs,[U(ne).isLoggedIn?(o(),a("button",{key:0,onClick:jt,class:"px-2 sm:px-3 py-1.5 bg-gray-600 hover:bg-gray-700 text-gray-300 rounded-lg transition-all flex items-center gap-1 sm:gap-1.5 cursor-pointer text-sm font-medium",title:"添加书签"},[...e[33]||(e[33]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z"})],-1),t("span",{class:"hidden sm:inline"},"书签",-1)])])):d("",!0),t("button",{onClick:e[4]||(e[4]=s=>ce.value=!0),class:f(["px-2 sm:px-3 py-1.5 rounded-lg text-sm font-medium transition-all flex items-center gap-1 sm:gap-1.5 cursor-pointer",k.value?"bg-green-600 hover:bg-green-700 text-white":"bg-gray-600 hover:bg-gray-700 text-gray-300"]),title:"阅读设置"},[(o(),a("svg",{class:f(["w-4 h-4",k.value&&"animate-spin-slow"]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...e[34]||(e[34]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"},null,-1),t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"},null,-1)])],2)),e[35]||(e[35]=t("span",{class:"hidden sm:inline"},"设置",-1))],2),Ge.value?(o(),a("button",{key:1,onClick:Tt,class:"px-2 sm:px-3 py-1.5 bg-gray-600 hover:bg-gray-700 rounded-lg text-white text-sm font-medium transition-all flex items-center gap-1 sm:gap-1.5 cursor-pointer",title:"上一话"},[...e[36]||(e[36]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1),t("span",{class:"hidden sm:inline"},"上一话",-1)])])):d("",!0),_e.value?(o(),a("button",{key:2,onClick:$t,class:f(["px-2 sm:px-3 py-1.5 rounded-lg text-white text-sm font-medium transition-all flex items-center gap-1 sm:gap-1.5 cursor-pointer",Q.value?"bg-yellow-500 hover:bg-yellow-600":"bg-pink-500 hover:bg-pink-600"]),title:Q.value?"下一话(需要VIP)":"下一话"},[Q.value?(o(),a("svg",Vs,[...e[37]||(e[37]=[t("path",{"fill-rule":"evenodd",d:"M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z","clip-rule":"evenodd"},null,-1)])])):d("",!0),e[39]||(e[39]=t("span",{class:"hidden sm:inline"},"下一话",-1)),Q.value?d("",!0):(o(),a("svg",Bs,[...e[38]||(e[38]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"},null,-1)])]))],10,js)):d("",!0)])])]),t("div",Ps,[t("div",{class:"h-full bg-gradient-to-r from-pink-500 to-pink-400 transition-all duration-300 ease-out",style:he({width:`${We.value}%`})},null,4)])],4),t("div",{class:"fixed top-0 left-0 right-0 z-50 h-1 bg-gray-800",style:he({transform:X.value?"translateY(-100%)":"translateY(0)"})},[t("div",{class:"h-full bg-gradient-to-r from-pink-500 to-pink-400 transition-all duration-300 ease-out",style:he({width:`${We.value}%`})},null,4)],4),k.value?(o(),a("button",{key:0,onClick:Nt,class:"fixed bottom-4 left-4 z-[55] p-2.5 sm:p-3 bg-gray-800/20 hover:bg-gray-800/40 text-white/30 hover:text-white/50 rounded-full backdrop-blur-sm transition-all duration-200 shadow-lg",title:_.value?"继续滚动":"暂停滚动"},[_.value?(o(),a("svg",Ts,[...e[40]||(e[40]=[t("path",{d:"M6.3 2.841A1.5 1.5 0 004 4.11V15.89a1.5 1.5 0 002.3 1.269l9.344-5.89a1.5 1.5 0 000-2.538L6.3 2.84z"},null,-1)])])):(o(),a("svg",Hs,[...e[41]||(e[41]=[t("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zM7 8a1 1 0 012 0v4a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v4a1 1 0 102 0V8a1 1 0 00-1-1z","clip-rule":"evenodd"},null,-1)])]))],8,$s)):d("",!0),$e.value&&!c.value.length?(o(),a("div",Es,[t("div",As,[F(je)])])):d("",!0),ue.value?(o(),a("div",Rs,[t("div",Ds,[e[42]||(e[42]=t("svg",{class:"w-12 h-12 text-red-400 mx-auto mb-4",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})],-1)),t("p",Fs,v(ue.value),1),t("div",{class:"flex gap-3 justify-center mt-4"},[t("button",{onClick:Ht,class:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors"}," 重试 "),t("button",{onClick:fe,class:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors cursor-pointer"}," 退出 ")])])])):d("",!0),c.value.length?(o(),a("div",Us,[t("div",Ns,[(o(!0),a(xe,null,be(c.value.slice(0,L.value),(s,n)=>(o(),a("div",{key:n,ref_for:!0,ref:y=>ve.value[n]=y,class:f(["comic-image-container relative flex items-center justify-center",{"min-h-[300px] sm:min-h-[500px]":!s.loaded}]),"data-index":n},[s.loaded?d("",!0):(o(),a("div",Ys,[s.error?(o(),a("div",{key:1,onClick:y=>Dt(n),class:"cursor-pointer text-red-400 hover:text-red-300 text-center"},[...e[43]||(e[43]=[t("svg",{class:"w-12 h-12 mx-auto mb-2",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})],-1),t("p",null,"加载失败，点击重试",-1)])],8,Ks)):(o(),a("div",Os,[F(je)]))])),s.needProcess?Be((o(),a("canvas",{key:1,ref_for:!0,ref:y=>Oe.value[n]=y,class:"w-full h-auto block"},null,512)),[[nl,s.loaded]]):d("",!0),!s.needProcess&&s.loaded?(o(),a("img",{key:2,src:s.src,alt:`Page ${n+1}`,class:"w-full h-auto block",onLoad:y=>At(n),onError:y=>Rt(n)},null,40,Qs)):d("",!0)],10,qs))),128)),H.value&&!ye.value?(o(),a("div",Ws,[t("button",{onClick:Bt,disabled:E.value,class:"px-8 py-4 bg-gradient-to-r from-pink-500 to-purple-600 hover:from-pink-600 hover:to-purple-700 text-white rounded-xl font-medium transition-all transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed cursor-pointer inline-flex items-center gap-2"},[E.value?(o(),a("svg",Zs,[...e[45]||(e[45]=[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):(o(),a("svg",Js,[...e[44]||(e[44]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 14l-7 7m0 0l-7-7m7 7V3"},null,-1)])])),t("span",null,v(E.value?"加载中...":`加载更多 (剩余 ${c.value.length-L.value} 张)`),1)],8,Gs),t("p",Xs," 已显示 "+v(L.value)+" / "+v(c.value.length)+" 张图片 ",1)])):d("",!0),ye.value?(o(),a("div",eo,[t("div",to,[e[47]||(e[47]=t("div",{class:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-yellow-500 to-yellow-600 rounded-full mb-2"},[t("svg",{class:"w-8 h-8 text-white",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})])],-1)),e[48]||(e[48]=t("h3",{class:"text-xl font-bold text-white"},"需要VIP才能继续阅读",-1)),t("p",lo," 您已预览前5张图片（共"+v(Ye.value)+"张） ",1),e[49]||(e[49]=t("p",{class:"text-gray-400 text-sm"}," 充值即可解锁全部内容，享受无限阅读体验 ",-1)),t("div",so,[U(m).isLoggedIn?d("",!0):(o(),a("button",{key:0,onClick:e[5]||(e[5]=s=>R.value=!0),class:"px-6 py-3 bg-gray-600 hover:bg-gray-700 text-white rounded-lg font-medium transition-colors"}," 立即登录 ")),t("button",{onClick:St,class:"inline-flex items-center justify-center px-6 py-3 bg-gradient-to-r from-yellow-500 to-yellow-600 hover:from-yellow-600 hover:to-yellow-700 text-white rounded-lg font-bold transition-all shadow-lg"},[...e[46]||(e[46]=[t("svg",{class:"w-5 h-5 mr-2",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})],-1),t("span",null,"立即充值",-1)])])])])])):d("",!0),_e.value&&!ye.value?(o(),a("div",oo,[t("div",{onClick:ot,class:"relative group cursor-pointer"},[e[59]||(e[59]=t("div",{class:"absolute inset-0 bg-gradient-to-r from-transparent via-gray-900/50 to-transparent"},null,-1)),t("div",ao,[e[57]||(e[57]=t("div",{class:"absolute left-0 right-0 top-1/2 -translate-y-1/2 h-[1px] bg-gradient-to-r from-transparent via-gray-700 to-transparent"},null,-1)),t("div",ro,[t("div",no,[e[56]||(e[56]=t("div",{class:"absolute inset-0 bg-gradient-to-r from-pink-500/0 via-pink-500/10 to-purple-500/0 opacity-0 group-hover:opacity-100 transition-opacity duration-500"},null,-1)),t("div",io,[e[54]||(e[54]=t("div",{class:"flex-1"},[t("p",{class:"text-gray-400 text-xs sm:text-sm mb-1"},"继续阅读"),t("h3",{class:"text-white text-lg sm:text-xl font-bold mb-2"},"下一话"),t("div",{class:"flex items-center gap-2"},[t("div",{class:"h-1 w-16 bg-gradient-to-r from-pink-500 to-purple-500 rounded-full"}),t("span",{class:"text-gray-500 text-xs"},"轻触继续")])],-1)),t("div",uo,[e[52]||(e[52]=t("div",{class:"absolute inset-0 rounded-full bg-gradient-to-r from-pink-500 to-purple-500 opacity-20 blur-xl group-hover:opacity-40 transition-opacity"},null,-1)),t("div",{class:f(["relative w-16 h-16 sm:w-20 sm:h-20 rounded-full flex items-center justify-center transition-all duration-300 group-hover:scale-110",Q.value?"bg-gradient-to-br from-yellow-500 to-orange-600":"bg-gradient-to-br from-pink-500 to-purple-600"])},[Q.value?(o(),a("svg",co,[...e[50]||(e[50]=[t("path",{"fill-rule":"evenodd",d:"M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z","clip-rule":"evenodd"},null,-1)])])):(o(),a("svg",vo,[...e[51]||(e[51]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2.5",d:"M13 7l5 5m0 0l-5 5m5-5H6"},null,-1)])]))],2),e[53]||(e[53]=t("div",{class:"absolute inset-0 rounded-full bg-white opacity-0 group-hover:animate-ping"},null,-1))])]),Q.value?(o(),a("div",mo,[...e[55]||(e[55]=[t("p",{class:"text-yellow-400 text-sm flex items-center gap-2"},[t("svg",{class:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})]),re(" 需要VIP会员才能阅读 ")],-1)])])):d("",!0)])]),e[58]||(e[58]=t("div",{class:"mt-6 text-center sm:hidden"},[t("p",{class:"text-gray-600 text-xs"},"👆 点击任意位置继续")],-1))])])])):d("",!0)])])):d("",!0),(o(),Le(il,{to:"body"},[F(ul,{name:"fade"},{default:ze(()=>[ce.value?(o(),a("div",{key:0,class:"fixed inset-0 z-[60] flex items-center justify-center bg-black/60 backdrop-blur-sm p-4",onClick:e[13]||(e[13]=dl(s=>ce.value=!1,["self"]))},[t("div",go,[e[70]||(e[70]=t("div",{class:"absolute inset-0 bg-gradient-to-r from-pink-500 via-purple-500 to-blue-500 rounded-2xl blur-sm opacity-50"},null,-1)),t("div",po,[t("div",fo,[e[61]||(e[61]=t("h3",{class:"text-lg sm:text-2xl font-bold text-white flex items-center gap-2"},[t("div",{class:"p-2 bg-pink-500/20 rounded-lg"},[t("svg",{class:"w-5 h-5 sm:w-6 sm:h-6 text-pink-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})])]),re(" 阅读设置 ")],-1)),t("button",{onClick:e[6]||(e[6]=s=>ce.value=!1),class:"p-1.5 hover:bg-white/10 rounded-lg transition-colors cursor-pointer"},[...e[60]||(e[60]=[t("svg",{class:"w-4 h-4 text-gray-400 hover:text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),B.value==="smooth"?(o(),a("div",ho,[t("label",xo," 滚动速度: "+v(ee.value)+" 像素/秒 ",1),Be(t("input",{type:"range","onUpdate:modelValue":e[7]||(e[7]=s=>ee.value=s),onChange:Ot,min:"10",max:"500",step:"10",class:"w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer slider"},null,544),[[Re,ee.value]]),e[62]||(e[62]=t("div",{class:"flex justify-between text-xs sm:text-sm text-gray-500 mt-2"},[t("span",null,"慢"),t("span",null,"中"),t("span",null,"快"),t("span",null,"极快")],-1))])):d("",!0),B.value==="stepped"?(o(),a("div",bo,[t("div",null,[t("label",wo," 跳动间隔: "+v(te.value)+" 秒 ",1),Be(t("input",{type:"range","onUpdate:modelValue":e[8]||(e[8]=s=>te.value=s),onChange:ut,min:"0.5",max:"5",step:"0.5",class:"w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer slider"},null,544),[[Re,te.value]]),e[63]||(e[63]=t("div",{class:"flex justify-between text-xs sm:text-sm text-gray-500 mt-2"},[t("span",null,"快速"),t("span",null,"中等"),t("span",null,"缓慢")],-1))]),t("div",null,[t("label",yo," 跳动距离: "+v(le.value)+" 像素 ",1),Be(t("input",{type:"range","onUpdate:modelValue":e[9]||(e[9]=s=>le.value=s),onChange:ut,min:"50",max:"800",step:"25",class:"w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer slider"},null,544),[[Re,le.value]]),e[64]||(e[64]=t("div",{class:"flex justify-between text-xs sm:text-sm text-gray-500 mt-2"},[t("span",null,"小"),t("span",null,"中"),t("span",null,"大"),t("span",null,"特大")],-1))])])):d("",!0),t("div",ko,[e[65]||(e[65]=t("label",{class:"block text-sm sm:text-base font-medium text-gray-300 mb-2 sm:mb-3"}," 滚动模式 ",-1)),t("div",_o,[t("button",{onClick:e[10]||(e[10]=s=>it("smooth")),class:f(["px-3 sm:px-4 py-2.5 sm:py-3 rounded-lg text-sm sm:text-base font-medium transition-all cursor-pointer",B.value==="smooth"?"bg-gradient-to-r from-pink-500 to-purple-600 text-white shadow-lg":"bg-gray-800/50 backdrop-blur-sm border border-white/10 text-gray-300 hover:bg-gray-700/50 hover:border-white/20"])}," 平滑滚动 ",2),t("button",{onClick:e[11]||(e[11]=s=>it("stepped")),class:f(["px-3 sm:px-4 py-2.5 sm:py-3 rounded-lg text-sm sm:text-base font-medium transition-all cursor-pointer",B.value==="stepped"?"bg-gradient-to-r from-pink-500 to-purple-600 text-white shadow-lg":"bg-gray-800/50 backdrop-blur-sm border border-white/10 text-gray-300 hover:bg-gray-700/50 hover:border-white/20"])}," 段落滚动 ",2)]),t("p",Co,v(B.value==="smooth"?"连续平滑滚动":"模拟鼠标滚轮，一次跳一小段"),1)]),t("div",Io,[t("div",So,[e[66]||(e[66]=t("div",{class:"flex items-center gap-2 sm:gap-3"},[t("div",{class:"p-1.5 sm:p-2 bg-green-500/20 rounded-lg"},[t("svg",{class:"w-4 h-4 sm:w-5 sm:h-5 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"}),t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})])]),t("div",{class:"flex-1 min-w-0"},[t("p",{class:"text-white font-medium text-xs sm:text-sm"},"自动滚动"),t("p",{class:"text-gray-400 text-[10px] sm:text-xs"},"开启后页面将自动向下滚动")])],-1)),t("button",{onClick:Ut,class:f(["relative inline-flex h-5 sm:h-6 w-9 sm:w-11 flex-shrink-0 items-center rounded-full transition-colors cursor-pointer",k.value?"bg-green-600":"bg-gray-600"])},[t("span",{class:f(["inline-block h-3 sm:h-4 w-3 sm:w-4 transform rounded-full bg-white transition-transform",k.value?"translate-x-5 sm:translate-x-6":"translate-x-1"])},null,2)],2)])]),t("div",Mo,[t("button",{onClick:Kt,disabled:Y.value||Ce.value,class:f(["w-full py-2 sm:py-2.5 px-3 sm:px-4 rounded-lg text-xs sm:text-sm font-medium transition-all",Y.value?"bg-gray-800/30 text-gray-500 cursor-not-allowed":Ce.value?"bg-green-500/20 border border-green-500/30 text-green-400 cursor-not-allowed":"bg-gray-800/50 backdrop-blur-sm border border-white/10 hover:bg-gray-700/50 hover:border-white/20 text-gray-300 cursor-pointer"])},[Ce.value?(o(),a("span",zo,[e[67]||(e[67]=t("svg",{class:"w-3.5 h-3.5 sm:w-4 sm:h-4",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"})],-1)),t("span",null,"已加载全部 "+v(c.value.length)+" 张图片",1)])):Y.value?(o(),a("span",jo,[e[68]||(e[68]=t("svg",{class:"animate-spin h-3.5 w-3.5 sm:h-4 sm:w-4",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),t("span",null,"加载中... "+v(q.value)+"/"+v(c.value.length),1)])):(o(),a("span",Vo,"加载全部图片"))],10,Lo),t("p",Bo,[Ce.value?(o(),a("span",Po,"所有图片已加载完成")):(o(),a("span",$o,"立即加载所有图片，不再等待滚动触发"))])]),t("div",To,[t("div",Ho,[e[69]||(e[69]=t("div",{class:"flex items-center gap-2 sm:gap-3"},[t("div",{class:"p-1.5 sm:p-2 bg-purple-500/20 rounded-lg"},[t("svg",{class:"w-4 h-4 sm:w-5 sm:h-5 text-purple-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 11l3-3m0 0l3 3m-3-3v8m0-13a9 9 0 110 18 9 9 0 010-18z"})])]),t("div",{class:"flex-1 min-w-0"},[t("p",{class:"text-white font-medium text-xs sm:text-sm"},"隐藏滚动条"),t("p",{class:"text-gray-400 text-[10px] sm:text-xs"},"阅读时隐藏页面滚动条")])],-1)),t("button",{onClick:qt,class:f(["relative inline-flex h-5 sm:h-6 w-9 sm:w-11 items-center rounded-full transition-colors cursor-pointer",se.value?"bg-purple-600":"bg-gray-600"])},[t("span",{class:f(["inline-block h-3 sm:h-4 w-3 sm:w-4 transform rounded-full bg-white transition-transform",se.value?"translate-x-5 sm:translate-x-6":"translate-x-1"])},null,2)],2)])]),t("button",{onClick:e[12]||(e[12]=s=>ce.value=!1),class:"w-full py-1.5 sm:py-2 px-3 sm:px-4 bg-gray-800/50 backdrop-blur-sm border border-white/10 hover:bg-gray-700/50 hover:border-white/20 text-gray-300 rounded-md sm:rounded-lg text-xs sm:text-sm font-medium transition-all cursor-pointer"}," 关闭 ")])])])):d("",!0)]),_:1})]))],34)):d("",!0),F(De,{modelValue:R.value,"onUpdate:modelValue":e[14]||(e[14]=s=>R.value=s),icon:"lock",title:"需要登录",message:"登录后即可继续阅读","confirm-text":"立即登录","cancel-text":"注册账号",onConfirm:Mt,onCancel:Lt},null,8,["modelValue"]),F(De,{modelValue:K.value,"onUpdate:modelValue":e[15]||(e[15]=s=>K.value=s),icon:"warning",title:"VIP专享内容",message:"成为VIP会员，解锁全站所有内容","confirm-text":"成为VIP","cancel-text":"返回","confirm-button-class":"bg-yellow-500 hover:bg-yellow-600 text-white",onConfirm:zt,onCancel:e[16]||(e[16]=s=>K.value=!1)},null,8,["modelValue"]),F(De,{modelValue:me.value,"onUpdate:modelValue":e[17]||(e[17]=s=>me.value=s),icon:"bookmark",title:"添加书签",message:Ke.value,"confirm-text":"确认","cancel-text":"取消","confirm-button-class":"bg-yellow-500 hover:bg-yellow-600 text-white",onConfirm:Vt,onCancel:e[18]||(e[18]=s=>me.value=!1)},null,8,["modelValue","message"])]),_:1},8,["title"])}}},No=Wt(Eo,[["__scopeId","data-v-15d7cf1b"]]);export{No as default};
