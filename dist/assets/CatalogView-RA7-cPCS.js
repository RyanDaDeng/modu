import{z as oe,r as u,B as re,j as ne,o as ue,c as G,w as H,A as ie,q as de,n as ve,k as ce,a0 as ge,a as s,b as l,d as o,e as v,f as V,L as O,v as c,F as m,h as f,N as k,t as J,s as K,O as W}from"./index-CYXJt4rn.js";import{_ as pe}from"./ComicCard-CePMudhV.js";import{_ as X}from"./Pagination-DFVi8IjW.js";import{_ as be}from"./BottomDrawer-3joVo3n3.js";const me={class:"container mx-auto px-4 py-6"},fe={key:0,class:"relative"},xe={class:"relative bg-gray-900/80 backdrop-blur-xl border border-white/10 rounded-lg p-4"},ye={class:"flex flex-col items-center"},ke={key:1,class:"sm:hidden mb-4"},_e={class:"bg-gradient-to-r from-pink-500/10 to-purple-500/10 rounded-xl p-[1px]"},he={class:"bg-gray-900/90 backdrop-blur-xl rounded-xl p-3"},Ce={class:"relative flex items-center justify-between bg-gray-800/90 backdrop-blur rounded-xl px-4 py-3 border border-gray-700 group-hover:border-pink-500/50 group-active:scale-[0.98] transition-all"},we={class:"flex items-center gap-3"},$e={class:"text-left"},Se={class:"text-sm font-medium text-white"},Ve={class:"flex gap-2 overflow-x-auto pb-1"},Ie=["onClick"],Ne={key:2,class:"hidden sm:block relative"},Pe={class:"relative bg-gray-900/60 backdrop-blur-xl border border-white/10 rounded-lg p-4 space-y-4"},je={class:"flex flex-wrap gap-2"},Be=["onClick"],De={key:0,class:"ml-1 text-xs opacity-70"},qe={class:"flex flex-wrap gap-2"},Fe=["onClick"],Me={key:0},Le={class:"flex flex-wrap gap-2"},Oe=["onClick"],Ae={key:3,class:"mt-4 mb-4"},Ue={key:4,class:"relative mt-2 sm:mt-4 mb-4 sm:mb-6"},Re={class:"relative bg-gray-900/60 backdrop-blur-xl border border-white/10 rounded-lg p-3 sm:p-4"},Te={class:"text-xs sm:text-sm text-gray-400 mb-1.5 sm:mb-2"},ze={class:"flex flex-wrap gap-1.5 sm:gap-2"},Ee=["onClick"],Qe={key:5,class:"flex justify-center py-8 sm:py-12"},Ge={key:6,class:"grid grid-cols-2 sm:grid-cols-4 md:grid-cols-5 lg:grid-cols-6 xl:grid-cols-6 2xl:grid-cols-7 gap-3 sm:gap-3 md:gap-4 mt-4"},He={key:7,class:"text-center py-8 sm:py-12"},Je={key:8,class:"flex justify-center py-6 sm:py-8"},Ke={key:9,class:"flex justify-center py-6 sm:py-8"},We={key:10,class:"mt-8"},Xe={class:"px-4 pb-4"},Ye={class:"grid grid-cols-2 gap-2"},Ze=["onClick"],et={key:0,class:"block text-xs opacity-70 mt-1"},tt={class:"px-4 pb-4"},lt={class:"grid grid-cols-2 gap-2"},at=["onClick"],st={key:0,class:"px-4 pb-6"},ot={class:"grid grid-cols-2 gap-2"},rt=["onClick"],nt={name:"CatalogView"},ut=Object.assign(nt,{setup(it){const q=ce(),A=de(),i=u([]),U=u([]),r=u(null),d=u(null),g=u("mv"),w=u(!1),j=[{label:"最新",value:""},{label:"最多爱心",value:"tf"},{label:"总排名",value:"mv"},{label:"月排名",value:"mv_m"},{label:"周排名",value:"mp_w"}],Y=re(()=>[{label:"最新",value:""},{label:"总榜",value:"mv"},{label:"月榜",value:"mv_m"},{label:"周榜",value:"mp_w"}]),p=u([]),C=u(!1),F=u(!0),M=u(!0),I=u(!1),b=u(0),_=u(!0),$=u(!1),N=u(0),S=u(0),x=u(1),y=u(1),B=()=>{const a=A.query;if(a.page){const t=parseInt(a.page);!isNaN(t)&&t>0&&(b.value=t,y.value=t)}else b.value===0&&(b.value=1,y.value=1);if(a.o){const t=a.o;j.find(n=>n.value===t)&&(g.value=t)}if(a.c&&i.value.length>0)if(a.c.includes("_")){const[t,e]=a.c.split("_"),n=i.value.find(P=>P.slug===t);if(n&&(r.value=n,n.sub_categories)){const P=n.sub_categories.find(se=>se.slug===e);P&&(d.value=P)}}else{const t=i.value.find(e=>!!(e.slug&&e.slug===a.c||e.id&&String(e.id)===a.c||!isNaN(a.c)&&e.id===parseInt(a.c)));t&&(r.value=t,d.value=null)}},R=(a=!1)=>{const t={};if(t.page=y.value,g.value&&g.value!=="mv"&&(t.o=g.value),r.value){let e=r.value.slug||r.value.id;if(d.value){const n=d.value.slug||d.value.CID;e=`${e}_${n}`}e&&(t.c=e)}L.value=!0,a?q.push({query:t}):q.replace({query:t})},Z=async()=>{M.value=!0;try{const a=await ve();a&&(i.value=a.categories||[],U.value=a.blocks||[],B(),!r.value&&i.value.length>0&&(r.value=i.value[0]),r.value&&h(!1))}catch(a){console.error("Failed to load categories:",a)}finally{M.value=!1,F.value=!1}},D=async(a=!1)=>{if(!(a&&C.value||!a&&I.value||!_.value&&!a)){a?C.value=!0:I.value=!0;try{let t=r.value?.slug||"";d.value&&t&&(t=`${t}_${d.value.slug}`);const e=await ge(b.value,g.value,t);e?.content?(a?p.value=e.content:p.value.push(...e.content),e.total!==void 0&&(N.value=e.total),S.value===0&&e.content.length>0&&(S.value=e.content.length),N.value>0&&S.value>0?x.value=Math.ceil(N.value/S.value):x.value=b.value+(e.content.length>=80?1:0),y.value=b.value,a||b.value++,_.value=e.content.length>=80):(_.value=!1,a&&(x.value=0))}catch(t){console.error("Failed to load comics:",t),_.value=!1}finally{a?C.value=!1:I.value=!1}}},h=(a=!0)=>{p.value=[],a&&(b.value=1,y.value=1),_.value=!0,$.value=!0,N.value=0,S.value=0,x.value=1,R(),D(!0)},ee=a=>{q.push({path:"/search",query:{wd:a}})},te=a=>{r.value=a,d.value=null,h(!0)},T=a=>{g.value=a,h(!0)},z=a=>{d.value=a,h(!0)},le=a=>{r.value=a,d.value=null,w.value=!1,h(!0)},ae=a=>{g.value=a,w.value=!1,h(!0)},E=a=>{d.value=a,w.value=!1,h(!0)},Q=a=>{p.value=[],b.value=a,y.value=a,_.value=!0,R(),D(!0),window.scrollTo({top:0,behavior:"smooth"})},L=u(!1);return ne(()=>A.query,()=>{if(L.value){L.value=!1;return}i.value.length>0&&(B(),!r.value&&i.value.length>0&&(r.value=i.value[0]),r.value&&(p.value=[],_.value=!0,$.value=!0,N.value=0,S.value=0,x.value=1,D(!0)))},{deep:!0}),ue(()=>{B(),b.value===0&&(b.value=1,y.value=1),i.value.length===0?Z():(B(),!r.value&&i.value.length>0&&(r.value=i.value[0]),r.value&&h(!1),F.value=!1)}),(a,t)=>(s(),G(ie,{title:"分类浏览","page-loading":F.value},{default:H(()=>[l("div",me,[M.value?(s(),o("div",fe,[t[6]||(t[6]=l("div",{class:"absolute inset-0 bg-gradient-to-r from-pink-500/20 via-purple-500/20 to-blue-500/20 rounded-lg blur-xl"},null,-1)),l("div",xe,[l("div",ye,[V(O),t[5]||(t[5]=l("span",{class:"mt-3 text-gray-400 text-sm"},"加载分类中...",-1))])])])):v("",!0),i.value.length>0?(s(),o("div",ke,[l("div",_e,[l("div",he,[l("button",{onClick:t[0]||(t[0]=e=>w.value=!0),class:"w-full mb-3 relative group"},[t[10]||(t[10]=l("div",{class:"absolute inset-0 bg-gradient-to-r from-pink-500/20 to-purple-500/20 rounded-xl blur group-active:blur-xl transition-all"},null,-1)),l("div",Ce,[l("div",we,[t[8]||(t[8]=l("div",{class:"relative"},[l("svg",{class:"w-5 h-5 text-pink-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"})]),l("div",{class:"absolute inset-0 bg-pink-400 blur-lg opacity-50 animate-pulse"})],-1)),l("div",$e,[t[7]||(t[7]=l("div",{class:"text-xs text-gray-400 mb-0.5"},"当前筛选",-1)),l("div",Se,c(r.value?.name||"全部")+" · "+c(j.find(e=>e.value===g.value)?.label||"最新"),1)])]),t[9]||(t[9]=l("div",{class:"flex items-center gap-2"},[l("span",{class:"text-xs text-pink-400 font-medium"},"点击修改"),l("div",{class:"bg-pink-500/20 rounded-lg p-1.5 group-hover:bg-pink-500/30 transition-colors"},[l("svg",{class:"w-4 h-4 text-pink-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})])])],-1))])]),l("div",Ve,[(s(!0),o(m,null,f(Y.value,e=>(s(),o("button",{key:e.value,onClick:n=>T(e.value),class:k(["flex-shrink-0 px-3 py-1.5 rounded-full text-xs font-medium transition-all",g.value===e.value?"bg-pink-500/20 text-pink-400 border border-pink-500/50":"bg-gray-800 text-gray-400 border border-gray-700"])},c(e.label),11,Ie))),128))])])])])):v("",!0),i.value.length>0?(s(),o("div",Ne,[t[14]||(t[14]=l("div",{class:"absolute inset-0 bg-gradient-to-r from-pink-500/10 via-purple-500/10 to-blue-500/10 rounded-lg blur-xl"},null,-1)),l("div",Pe,[l("div",null,[t[11]||(t[11]=l("label",{class:"text-sm text-gray-400 mb-2 block"},"分类",-1)),l("div",je,[(s(!0),o(m,null,f(i.value,e=>(s(),o("button",{key:e.id,onClick:n=>te(e),class:k(["px-4 py-2 rounded-lg text-sm font-medium transition-colors cursor-pointer",r.value?.id===e.id?"bg-pink-500/20 text-pink-400 border border-pink-500/50":"bg-gray-800/50 text-gray-300 hover:bg-gray-700/50 hover:text-white border border-gray-700"])},[J(c(e.name)+" ",1),e.total_albums>0?(s(),o("span",De," ("+c(K(W)(e.total_albums))+") ",1)):v("",!0)],10,Be))),128))])]),l("div",null,[t[12]||(t[12]=l("label",{class:"text-sm text-gray-400 mb-2 block"},"排序",-1)),l("div",qe,[(s(),o(m,null,f(j,e=>l("button",{key:e.value,onClick:n=>T(e.value),class:k(["px-4 py-2 rounded-lg text-sm font-medium transition-colors cursor-pointer",g.value===e.value?"bg-pink-500/20 text-pink-400 border border-pink-500/50":"bg-gray-800/50 text-gray-300 hover:bg-gray-700/50 hover:text-white border border-gray-700"])},c(e.label),11,Fe)),64))])]),r.value?.sub_categories?.length&&r.value.id!==0?(s(),o("div",Me,[t[13]||(t[13]=l("label",{class:"text-sm text-gray-400 mb-2 block"},"子分类",-1)),l("div",Le,[l("button",{onClick:t[1]||(t[1]=e=>z(null)),class:k(["px-4 py-2 rounded-lg text-sm font-medium transition-colors cursor-pointer",d.value?"bg-gray-800/50 text-gray-300 hover:bg-gray-700/50 hover:text-white border border-gray-700":"bg-pink-500/20 text-pink-400 border border-pink-500/50"])}," 全部 ",2),(s(!0),o(m,null,f(r.value.sub_categories,e=>(s(),o("button",{key:e.CID,onClick:n=>z(e),class:k(["px-4 py-2 rounded-lg text-sm font-medium transition-colors cursor-pointer",d.value?.CID===e.CID?"bg-pink-500/20 text-pink-400 border border-pink-500/50":"bg-gray-800/50 text-gray-300 hover:bg-gray-700/50 hover:text-white border border-gray-700"])},c(e.name),11,Oe))),128))])])):v("",!0)])])):v("",!0),$.value&&x.value>1&&p.value.length>0?(s(),o("div",Ae,[V(X,{"current-page":y.value,"total-pages":x.value,onChange:Q},null,8,["current-page","total-pages"])])):v("",!0),$.value?v("",!0):(s(),o("div",Ue,[t[15]||(t[15]=l("div",{class:"absolute inset-0 bg-gradient-to-r from-pink-500/10 via-purple-500/10 to-blue-500/10 rounded-lg blur-xl"},null,-1)),l("div",Re,[(s(!0),o(m,null,f(U.value,e=>(s(),o("div",{key:e.title,class:"mb-3 sm:mb-4 last:mb-0"},[l("h3",Te,c(e.title),1),l("div",ze,[(s(!0),o(m,null,f(e.content,n=>(s(),o("button",{key:n,onClick:P=>ee(n),class:"px-2 sm:px-3 py-1 sm:py-1.5 bg-gray-800/50 hover:bg-pink-500/20 text-gray-300 hover:text-pink-400 border border-gray-700 hover:border-pink-500/50 rounded-full text-xs sm:text-sm transition-colors cursor-pointer"},c(n),9,Ee))),128))])]))),128))])])),C.value?(s(),o("div",Qe,[V(O)])):v("",!0),!C.value&&p.value.length>0?(s(),o("div",Ge,[(s(!0),o(m,null,f(p.value,e=>(s(),G(pe,{key:e.id,comic:e},null,8,["comic"]))),128))])):v("",!0),!C.value&&$.value&&p.value.length===0?(s(),o("div",He,[...t[16]||(t[16]=[l("p",{class:"text-gray-400 text-sm"},"暂无相关漫画",-1)])])):v("",!0),_.value&&!C.value&&!I.value&&p.value.length?(s(),o("div",Je,[l("button",{onClick:t[2]||(t[2]=e=>D()),class:"px-6 py-3 bg-pink-600 hover:bg-pink-700 text-white rounded-lg font-medium transition-colors cursor-pointer"}," 加载更多 ")])):v("",!0),I.value?(s(),o("div",Ke,[V(O)])):v("",!0),$.value&&x.value>1&&p.value.length>0?(s(),o("div",We,[V(X,{"current-page":y.value,"total-pages":x.value,onChange:Q},null,8,["current-page","total-pages"])])):v("",!0),V(be,{modelValue:w.value,"onUpdate:modelValue":t[4]||(t[4]=e=>w.value=e),title:"选择筛选条件","max-height":"90vh"},{default:H(()=>[l("div",Xe,[t[17]||(t[17]=l("div",{class:"text-sm text-gray-400 mb-3"},"分类",-1)),l("div",Ye,[(s(!0),o(m,null,f(i.value,e=>(s(),o("button",{key:e.id,onClick:n=>le(e),class:k(["py-3 rounded-lg text-sm font-medium transition-colors",r.value?.id===e.id?"bg-pink-500/20 text-pink-400 border border-pink-500/50":"bg-gray-800 text-gray-300 border border-gray-700"])},[J(c(e.name)+" ",1),e.total_albums>0?(s(),o("span",et," ("+c(K(W)(e.total_albums))+") ",1)):v("",!0)],10,Ze))),128))])]),l("div",tt,[t[18]||(t[18]=l("div",{class:"text-sm text-gray-400 mb-3"},"排序方式",-1)),l("div",lt,[(s(),o(m,null,f(j,e=>l("button",{key:e.value,onClick:n=>ae(e.value),class:k(["py-3 rounded-lg text-sm font-medium transition-colors",g.value===e.value?"bg-pink-500/20 text-pink-400 border border-pink-500/50":"bg-gray-800 text-gray-300 border border-gray-700"])},c(e.label),11,at)),64))])]),r.value?.sub_categories?.length&&r.value.id!==0?(s(),o("div",st,[t[19]||(t[19]=l("div",{class:"text-sm text-gray-400 mb-3"},"子分类",-1)),l("div",ot,[l("button",{onClick:t[3]||(t[3]=e=>E(null)),class:k(["py-3 rounded-lg text-sm font-medium transition-colors",d.value?"bg-gray-800 text-gray-300 border border-gray-700":"bg-pink-500/20 text-pink-400 border border-pink-500/50"])}," 全部 ",2),(s(!0),o(m,null,f(r.value.sub_categories,e=>(s(),o("button",{key:e.CID,onClick:n=>E(e),class:k(["py-3 rounded-lg text-sm font-medium transition-colors",d.value?.CID===e.CID?"bg-pink-500/20 text-pink-400 border border-pink-500/50":"bg-gray-800 text-gray-300 border border-gray-700"])},c(e.name),11,rt))),128))])])):v("",!0)]),_:1},8,["modelValue"])])]),_:1},8,["page-loading"]))}}),pt=oe(ut,[["__scopeId","data-v-09f61441"]]);export{pt as default};
