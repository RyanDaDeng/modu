import{z as se,r as n,B as oe,o as re,c as E,w as Q,A as ne,q as ie,n as ue,k as de,a0 as ve,a as s,b as l,d as o,e as u,f as $,L as F,v,F as m,h as x,N as f,t as G,s as H,O as J}from"./index-BMrkml-o.js";import{_ as ce}from"./ComicCard-BS6BzfeK.js";import{_ as K}from"./Pagination-3V4gwmkF.js";import{_ as ge}from"./BottomDrawer-DFAfRsvq.js";const pe={class:"container mx-auto px-4 py-6"},be={key:0,class:"relative"},me={class:"relative bg-gray-900/80 backdrop-blur-xl border border-white/10 rounded-lg p-4"},xe={class:"flex flex-col items-center"},ye={key:1,class:"sm:hidden mb-4"},fe={class:"bg-gradient-to-r from-pink-500/10 to-purple-500/10 rounded-xl p-[1px]"},ke={class:"bg-gray-900/90 backdrop-blur-xl rounded-xl p-3"},_e={class:"relative flex items-center justify-between bg-gray-800/90 backdrop-blur rounded-xl px-4 py-3 border border-gray-700 group-hover:border-pink-500/50 group-active:scale-[0.98] transition-all"},he={class:"flex items-center gap-3"},Ce={class:"text-left"},we={class:"text-sm font-medium text-white"},$e={class:"flex gap-2 overflow-x-auto pb-1"},Ve=["onClick"],Se={key:2,class:"hidden sm:block relative"},Ie={class:"relative bg-gray-900/60 backdrop-blur-xl border border-white/10 rounded-lg p-4 space-y-4"},Pe={class:"flex flex-wrap gap-2"},Be=["onClick"],Ne={key:0,class:"ml-1 text-xs opacity-70"},je={class:"flex flex-wrap gap-2"},De=["onClick"],Fe={key:0},Me={class:"flex flex-wrap gap-2"},qe=["onClick"],Le={key:3,class:"mt-4 mb-4"},Oe={key:4,class:"relative mt-2 sm:mt-4 mb-4 sm:mb-6"},Ae={class:"relative bg-gray-900/60 backdrop-blur-xl border border-white/10 rounded-lg p-3 sm:p-4"},Re={class:"text-xs sm:text-sm text-gray-400 mb-1.5 sm:mb-2"},Te={class:"flex flex-wrap gap-1.5 sm:gap-2"},ze=["onClick"],Ue={key:5,class:"flex justify-center py-8 sm:py-12"},Ee={key:6,class:"grid grid-cols-2 sm:grid-cols-4 md:grid-cols-5 lg:grid-cols-6 xl:grid-cols-6 2xl:grid-cols-7 gap-3 sm:gap-3 md:gap-4 mt-4"},Qe={key:7,class:"text-center py-8 sm:py-12"},Ge={key:8,class:"flex justify-center py-6 sm:py-8"},He={key:9,class:"flex justify-center py-6 sm:py-8"},Je={key:10,class:"mt-8"},Ke={class:"px-4 pb-4"},We={class:"grid grid-cols-2 gap-2"},Xe=["onClick"],Ye={key:0,class:"block text-xs opacity-70 mt-1"},Ze={class:"px-4 pb-4"},et={class:"grid grid-cols-2 gap-2"},tt=["onClick"],lt={key:0,class:"px-4 pb-6"},at={class:"grid grid-cols-2 gap-2"},st=["onClick"],ot={name:"CatalogView"},rt=Object.assign(ot,{setup(nt){const M=de(),W=ie(),c=n([]),q=n([]),r=n(null),d=n(null),g=n("mv"),w=n(!1),B=[{label:"最新",value:""},{label:"最多爱心",value:"tf"},{label:"总排名",value:"mv"},{label:"月排名",value:"mv_m"},{label:"周排名",value:"mp_w"}],X=oe(()=>[{label:"最新",value:""},{label:"总榜",value:"mv"},{label:"月榜",value:"mv_m"},{label:"周榜",value:"mp_w"}]),b=n([]),_=n(!1),L=n(!0),j=n(!0),V=n(!1),p=n(0),h=n(!0),S=n(!1),N=n(0),I=n(0),k=n(1),y=n(1),O=()=>{const a=W.query;if(a.page){const t=parseInt(a.page);!isNaN(t)&&t>0&&(p.value=t,y.value=t)}else p.value===0&&(p.value=1,y.value=1);if(a.o){const t=a.o;B.find(i=>i.value===t)&&(g.value=t)}if(a.c&&c.value.length>0)if(a.c.includes("_")){const[t,e]=a.c.split("_"),i=c.value.find(P=>P.slug===t);if(i&&(r.value=i,i.sub_categories)){const P=i.sub_categories.find(ae=>ae.slug===e);P&&(d.value=P)}}else{const t=c.value.find(e=>e.slug===a.c);t&&(r.value=t)}},A=()=>{const a={};if(a.page=y.value,g.value&&g.value!=="mv"&&(a.o=g.value),r.value){let t=r.value.slug;d.value&&(t=`${t}_${d.value.slug}`),t&&(a.c=t)}M.push({query:a})},Y=async()=>{j.value=!0;try{const a=await ue();a&&(c.value=a.categories||[],q.value=a.blocks||[],O(),!r.value&&c.value.length>0&&(r.value=c.value[0]),r.value&&C(!1))}catch(a){console.error("Failed to load categories:",a)}finally{j.value=!1,L.value=!1}},D=async(a=!1)=>{if(!(a&&_.value||!a&&V.value||!h.value&&!a)){a?_.value=!0:V.value=!0;try{let t=r.value?.slug||"";d.value&&t&&(t=`${t}_${d.value.slug}`);const e=await ve(p.value,g.value,t);e?.content?(a?b.value=e.content:b.value.push(...e.content),e.total!==void 0&&(N.value=e.total),I.value===0&&e.content.length>0&&(I.value=e.content.length),N.value>0&&I.value>0?k.value=Math.ceil(N.value/I.value):k.value=p.value+(e.content.length>=80?1:0),y.value=p.value,a||p.value++,h.value=e.content.length>=80):(h.value=!1,a&&(k.value=0))}catch(t){console.error("Failed to load comics:",t),h.value=!1}finally{a?_.value=!1:V.value=!1}}},C=(a=!0)=>{b.value=[],a&&(p.value=1,y.value=1),h.value=!0,S.value=!0,N.value=0,I.value=0,k.value=1,A(),D(!0)},Z=a=>{M.push({path:"/search",query:{wd:a}})},ee=a=>{r.value=a,d.value=null,C(!0)},R=a=>{g.value=a,C(!0)},T=a=>{d.value=a,C(!0)},te=a=>{r.value=a,d.value=null,w.value=!1,C(!0)},le=a=>{g.value=a,w.value=!1,C(!0)},z=a=>{d.value=a,w.value=!1,C(!0)},U=a=>{b.value=[],p.value=a,y.value=a,h.value=!0,A(),D(!0),window.scrollTo({top:0,behavior:"smooth"})};return re(()=>{c.value.length===0&&(O(),p.value===0&&(p.value=1,y.value=1),Y())}),(a,t)=>(s(),E(ne,{title:"分类浏览","page-loading":L.value},{default:Q(()=>[l("div",pe,[j.value?(s(),o("div",be,[t[6]||(t[6]=l("div",{class:"absolute inset-0 bg-gradient-to-r from-pink-500/20 via-purple-500/20 to-blue-500/20 rounded-lg blur-xl"},null,-1)),l("div",me,[l("div",xe,[$(F),t[5]||(t[5]=l("span",{class:"mt-3 text-gray-400 text-sm"},"加载分类中...",-1))])])])):u("",!0),c.value.length>0?(s(),o("div",ye,[l("div",fe,[l("div",ke,[l("button",{onClick:t[0]||(t[0]=e=>w.value=!0),class:"w-full mb-3 relative group"},[t[10]||(t[10]=l("div",{class:"absolute inset-0 bg-gradient-to-r from-pink-500/20 to-purple-500/20 rounded-xl blur group-active:blur-xl transition-all"},null,-1)),l("div",_e,[l("div",he,[t[8]||(t[8]=l("div",{class:"relative"},[l("svg",{class:"w-5 h-5 text-pink-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"})]),l("div",{class:"absolute inset-0 bg-pink-400 blur-lg opacity-50 animate-pulse"})],-1)),l("div",Ce,[t[7]||(t[7]=l("div",{class:"text-xs text-gray-400 mb-0.5"},"当前筛选",-1)),l("div",we,v(r.value?.name||"全部")+" · "+v(B.find(e=>e.value===g.value)?.label||"最新"),1)])]),t[9]||(t[9]=l("div",{class:"flex items-center gap-2"},[l("span",{class:"text-xs text-pink-400 font-medium"},"点击修改"),l("div",{class:"bg-pink-500/20 rounded-lg p-1.5 group-hover:bg-pink-500/30 transition-colors"},[l("svg",{class:"w-4 h-4 text-pink-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})])])],-1))])]),l("div",$e,[(s(!0),o(m,null,x(X.value,e=>(s(),o("button",{key:e.value,onClick:i=>R(e.value),class:f(["flex-shrink-0 px-3 py-1.5 rounded-full text-xs font-medium transition-all",g.value===e.value?"bg-pink-500/20 text-pink-400 border border-pink-500/50":"bg-gray-800 text-gray-400 border border-gray-700"])},v(e.label),11,Ve))),128))])])])])):u("",!0),c.value.length>0?(s(),o("div",Se,[t[14]||(t[14]=l("div",{class:"absolute inset-0 bg-gradient-to-r from-pink-500/10 via-purple-500/10 to-blue-500/10 rounded-lg blur-xl"},null,-1)),l("div",Ie,[l("div",null,[t[11]||(t[11]=l("label",{class:"text-sm text-gray-400 mb-2 block"},"分类",-1)),l("div",Pe,[(s(!0),o(m,null,x(c.value,e=>(s(),o("button",{key:e.id,onClick:i=>ee(e),class:f(["px-4 py-2 rounded-lg text-sm font-medium transition-colors cursor-pointer",r.value?.id===e.id?"bg-pink-500/20 text-pink-400 border border-pink-500/50":"bg-gray-800/50 text-gray-300 hover:bg-gray-700/50 hover:text-white border border-gray-700"])},[G(v(e.name)+" ",1),e.total_albums>0?(s(),o("span",Ne," ("+v(H(J)(e.total_albums))+") ",1)):u("",!0)],10,Be))),128))])]),l("div",null,[t[12]||(t[12]=l("label",{class:"text-sm text-gray-400 mb-2 block"},"排序",-1)),l("div",je,[(s(),o(m,null,x(B,e=>l("button",{key:e.value,onClick:i=>R(e.value),class:f(["px-4 py-2 rounded-lg text-sm font-medium transition-colors cursor-pointer",g.value===e.value?"bg-pink-500/20 text-pink-400 border border-pink-500/50":"bg-gray-800/50 text-gray-300 hover:bg-gray-700/50 hover:text-white border border-gray-700"])},v(e.label),11,De)),64))])]),r.value?.sub_categories?.length&&r.value.id!==0?(s(),o("div",Fe,[t[13]||(t[13]=l("label",{class:"text-sm text-gray-400 mb-2 block"},"子分类",-1)),l("div",Me,[l("button",{onClick:t[1]||(t[1]=e=>T(null)),class:f(["px-4 py-2 rounded-lg text-sm font-medium transition-colors cursor-pointer",d.value?"bg-gray-800/50 text-gray-300 hover:bg-gray-700/50 hover:text-white border border-gray-700":"bg-pink-500/20 text-pink-400 border border-pink-500/50"])}," 全部 ",2),(s(!0),o(m,null,x(r.value.sub_categories,e=>(s(),o("button",{key:e.CID,onClick:i=>T(e),class:f(["px-4 py-2 rounded-lg text-sm font-medium transition-colors cursor-pointer",d.value?.CID===e.CID?"bg-pink-500/20 text-pink-400 border border-pink-500/50":"bg-gray-800/50 text-gray-300 hover:bg-gray-700/50 hover:text-white border border-gray-700"])},v(e.name),11,qe))),128))])])):u("",!0)])])):u("",!0),S.value&&k.value>1&&b.value.length>0?(s(),o("div",Le,[$(K,{"current-page":y.value,"total-pages":k.value,onChange:U},null,8,["current-page","total-pages"])])):u("",!0),S.value?u("",!0):(s(),o("div",Oe,[t[15]||(t[15]=l("div",{class:"absolute inset-0 bg-gradient-to-r from-pink-500/10 via-purple-500/10 to-blue-500/10 rounded-lg blur-xl"},null,-1)),l("div",Ae,[(s(!0),o(m,null,x(q.value,e=>(s(),o("div",{key:e.title,class:"mb-3 sm:mb-4 last:mb-0"},[l("h3",Re,v(e.title),1),l("div",Te,[(s(!0),o(m,null,x(e.content,i=>(s(),o("button",{key:i,onClick:P=>Z(i),class:"px-2 sm:px-3 py-1 sm:py-1.5 bg-gray-800/50 hover:bg-pink-500/20 text-gray-300 hover:text-pink-400 border border-gray-700 hover:border-pink-500/50 rounded-full text-xs sm:text-sm transition-colors cursor-pointer"},v(i),9,ze))),128))])]))),128))])])),_.value?(s(),o("div",Ue,[$(F)])):u("",!0),!_.value&&b.value.length>0?(s(),o("div",Ee,[(s(!0),o(m,null,x(b.value,e=>(s(),E(ce,{key:e.id,comic:e},null,8,["comic"]))),128))])):u("",!0),!_.value&&S.value&&b.value.length===0?(s(),o("div",Qe,[...t[16]||(t[16]=[l("p",{class:"text-gray-400 text-sm"},"暂无相关漫画",-1)])])):u("",!0),h.value&&!_.value&&!V.value&&b.value.length?(s(),o("div",Ge,[l("button",{onClick:t[2]||(t[2]=e=>D()),class:"px-6 py-3 bg-pink-600 hover:bg-pink-700 text-white rounded-lg font-medium transition-colors cursor-pointer"}," 加载更多 ")])):u("",!0),V.value?(s(),o("div",He,[$(F)])):u("",!0),S.value&&k.value>1&&b.value.length>0?(s(),o("div",Je,[$(K,{"current-page":y.value,"total-pages":k.value,onChange:U},null,8,["current-page","total-pages"])])):u("",!0),$(ge,{modelValue:w.value,"onUpdate:modelValue":t[4]||(t[4]=e=>w.value=e),title:"选择筛选条件",class:"sm:hidden","max-height":"90vh"},{default:Q(()=>[l("div",Ke,[t[17]||(t[17]=l("div",{class:"text-sm text-gray-400 mb-3"},"分类",-1)),l("div",We,[(s(!0),o(m,null,x(c.value,e=>(s(),o("button",{key:e.id,onClick:i=>te(e),class:f(["py-3 rounded-lg text-sm font-medium transition-colors",r.value?.id===e.id?"bg-pink-500/20 text-pink-400 border border-pink-500/50":"bg-gray-800 text-gray-300 border border-gray-700"])},[G(v(e.name)+" ",1),e.total_albums>0?(s(),o("span",Ye," ("+v(H(J)(e.total_albums))+") ",1)):u("",!0)],10,Xe))),128))])]),l("div",Ze,[t[18]||(t[18]=l("div",{class:"text-sm text-gray-400 mb-3"},"排序方式",-1)),l("div",et,[(s(),o(m,null,x(B,e=>l("button",{key:e.value,onClick:i=>le(e.value),class:f(["py-3 rounded-lg text-sm font-medium transition-colors",g.value===e.value?"bg-pink-500/20 text-pink-400 border border-pink-500/50":"bg-gray-800 text-gray-300 border border-gray-700"])},v(e.label),11,tt)),64))])]),r.value?.sub_categories?.length&&r.value.id!==0?(s(),o("div",lt,[t[19]||(t[19]=l("div",{class:"text-sm text-gray-400 mb-3"},"子分类",-1)),l("div",at,[l("button",{onClick:t[3]||(t[3]=e=>z(null)),class:f(["py-3 rounded-lg text-sm font-medium transition-colors",d.value?"bg-gray-800 text-gray-300 border border-gray-700":"bg-pink-500/20 text-pink-400 border border-pink-500/50"])}," 全部 ",2),(s(!0),o(m,null,x(r.value.sub_categories,e=>(s(),o("button",{key:e.CID,onClick:i=>z(e),class:f(["py-3 rounded-lg text-sm font-medium transition-colors",d.value?.CID===e.CID?"bg-pink-500/20 text-pink-400 border border-pink-500/50":"bg-gray-800 text-gray-300 border border-gray-700"])},v(e.name),11,st))),128))])])):u("",!0)]),_:1},8,["modelValue"])])]),_:1},8,["page-loading"]))}}),ct=se(rt,[["__scopeId","data-v-56a3b360"]]);export{ct as default};
