import{_ as L,r as n,o as O,c as a,d as o,e as r,g as $,L as S,F as x,f as v,s as _,K as P,M as T,u as z,i as s,x as E,t as g,q as K,j as R}from"./index-R3dXyy7_.js";import{_ as A}from"./ComicCard-Vk7YaCoR.js";import{f as G}from"./format-BZgmAhtB.js";const H={class:"min-h-screen bg-gray-900"},J={class:"container mx-auto px-2 sm:px-4 py-2 sm:py-6"},Q={key:0,class:"bg-gray-800 rounded-lg p-4"},U={class:"flex flex-col items-center"},W={key:1,class:"bg-gray-800 rounded-lg p-2 sm:p-4 space-y-2 sm:space-y-4"},X={class:"flex overflow-x-auto gap-1 sm:gap-2 pb-1 sm:pb-0 -mx-2 px-2 sm:mx-0 sm:px-0 sm:flex-wrap no-scrollbar"},Y=["onClick"],Z={key:0,class:"hidden sm:inline ml-1 text-xs opacity-70"},ee={class:"flex overflow-x-auto gap-1 sm:gap-2 pb-1 sm:pb-0 -mx-2 px-2 sm:mx-0 sm:px-0 sm:flex-wrap no-scrollbar"},te=["onClick"],se={key:0},le={class:"flex overflow-x-auto gap-1 sm:gap-2 pb-1 sm:pb-0 -mx-2 px-2 sm:mx-0 sm:px-0 sm:flex-wrap no-scrollbar"},ae=["onClick"],oe={key:2,class:"bg-gray-800 rounded-lg p-3 sm:p-4 mt-2 sm:mt-4 mb-4 sm:mb-6"},ne={class:"text-xs sm:text-sm text-gray-400 mb-1.5 sm:mb-2"},re={class:"flex flex-wrap gap-1.5 sm:gap-2"},ie=["onClick"],ue={key:3,class:"flex justify-center py-8 sm:py-12"},me={key:4,class:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 lg:grid-cols-6 xl:grid-cols-6 2xl:grid-cols-7 gap-2 sm:gap-3 md:gap-4 mt-4"},ce={key:5,class:"text-center py-8 sm:py-12"},de={key:6,class:"flex justify-center py-6 sm:py-8"},pe={key:7,class:"flex justify-center py-6 sm:py-8"},xe={name:"CatalogView"},ve=Object.assign(xe,{setup(ge){const B=z(),y=n([]),F=n([]),i=n(null),c=n(null),h=n("mv"),N=[{label:"最新",value:""},{label:"最多爱心",value:"tf"},{label:"总排名",value:"mv"},{label:"月排名",value:"mv_m"},{label:"周排名",value:"mp_w"}],u=n([]),m=n(!1),k=n(!0),b=n(!1),w=n(1),d=n(!0),C=n(!1),D=async()=>{k.value=!0;try{const l=await P();l&&(y.value=l.categories||[],F.value=l.blocks||[],y.value.length>0&&(i.value=y.value[0],f()))}catch(l){console.error("Failed to load categories:",l)}finally{k.value=!1}},V=async(l=!1)=>{if(!(l&&m.value||!l&&b.value||!d.value&&!l)){l?m.value=!0:b.value=!0;try{let t=i.value?.slug||"";c.value&&t&&(t=`${t}_${c.value.slug}`);const e=await T(w.value,h.value,t);e?.content?(l?u.value=e.content:u.value.push(...e.content),w.value++,d.value=e.content.length>=80):d.value=!1}catch(t){console.error("Failed to load comics:",t),d.value=!1}finally{l?m.value=!1:b.value=!1}}},f=()=>{u.value=[],w.value=1,d.value=!0,C.value=!0,V(!0)},I=l=>{B.push({path:"/search",query:{q:l}})},M=l=>{i.value=l,c.value=null,f()},q=l=>{h.value=l,f()},j=l=>{c.value=l,f()};return O(()=>{D()}),(l,t)=>(s(),a("div",H,[o("div",J,[t[7]||(t[7]=o("h1",{class:"hidden sm:block text-2xl font-bold text-white mb-6"},"全部漫画",-1)),k.value?(s(),a("div",Q,[o("div",U,[$(S),t[2]||(t[2]=o("span",{class:"mt-3 text-gray-400 text-sm"},"加载分类中...",-1))])])):r("",!0),y.value.length>0?(s(),a("div",W,[o("div",null,[t[3]||(t[3]=o("label",{class:"text-xs sm:text-sm text-gray-400 mb-1 sm:mb-2 block"},"分类",-1)),o("div",X,[(s(!0),a(x,null,v(y.value,e=>(s(),a("button",{key:e.id,onClick:p=>M(e),class:_(["flex-shrink-0 px-2 sm:px-4 py-1 sm:py-2 rounded-md sm:rounded-lg text-xs sm:text-sm font-medium transition-all whitespace-nowrap",i.value?.id===e.id?"bg-pink-500 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},[E(g(e.name)+" ",1),e.total_albums>0?(s(),a("span",Z," ("+g(K(G)(e.total_albums))+") ",1)):r("",!0)],10,Y))),128))])]),o("div",null,[t[4]||(t[4]=o("label",{class:"text-xs sm:text-sm text-gray-400 mb-1 sm:mb-2 block"},"排序",-1)),o("div",ee,[(s(),a(x,null,v(N,e=>o("button",{key:e.value,onClick:p=>q(e.value),class:_(["flex-shrink-0 px-2 sm:px-4 py-1 sm:py-2 rounded-md sm:rounded-lg text-xs sm:text-sm font-medium transition-all whitespace-nowrap",h.value===e.value?"bg-pink-500 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},g(e.label),11,te)),64))])]),i.value?.sub_categories?.length&&i.value.id!==0?(s(),a("div",se,[t[5]||(t[5]=o("label",{class:"text-xs sm:text-sm text-gray-400 mb-1 sm:mb-2 block"},"子分类",-1)),o("div",le,[o("button",{onClick:t[0]||(t[0]=e=>j(null)),class:_(["flex-shrink-0 px-2 sm:px-4 py-1 sm:py-2 rounded-md sm:rounded-lg text-xs sm:text-sm font-medium transition-all whitespace-nowrap",c.value?"bg-gray-700 text-gray-300 hover:bg-gray-600":"bg-pink-500 text-white"])}," 全部 ",2),(s(!0),a(x,null,v(i.value.sub_categories,e=>(s(),a("button",{key:e.CID,onClick:p=>j(e),class:_(["flex-shrink-0 px-2 sm:px-4 py-1 sm:py-2 rounded-md sm:rounded-lg text-xs sm:text-sm font-medium transition-all whitespace-nowrap",c.value?.CID===e.CID?"bg-pink-500 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},g(e.name),11,ae))),128))])])):r("",!0)])):r("",!0),C.value?r("",!0):(s(),a("div",oe,[(s(!0),a(x,null,v(F.value,e=>(s(),a("div",{key:e.title,class:"mb-3 sm:mb-4 last:mb-0"},[o("h3",ne,g(e.title),1),o("div",re,[(s(!0),a(x,null,v(e.content,p=>(s(),a("button",{key:p,onClick:ye=>I(p),class:"px-2 sm:px-3 py-1 sm:py-1.5 bg-gray-700 hover:bg-pink-500 text-gray-300 hover:text-white rounded-full text-xs sm:text-sm transition-all"},g(p),9,ie))),128))])]))),128))])),m.value?(s(),a("div",ue,[$(S)])):r("",!0),!m.value&&u.value.length>0?(s(),a("div",me,[(s(!0),a(x,null,v(u.value,e=>(s(),R(A,{key:e.id,comic:e},null,8,["comic"]))),128))])):r("",!0),!m.value&&C.value&&u.value.length===0?(s(),a("div",ce,[...t[6]||(t[6]=[o("p",{class:"text-gray-400 text-sm"},"暂无相关漫画",-1)])])):r("",!0),d.value&&!m.value&&!b.value&&u.value.length?(s(),a("div",de,[o("button",{onClick:t[1]||(t[1]=e=>V()),class:"px-6 py-3 bg-pink-500 hover:bg-pink-600 text-white rounded-lg font-medium transition-colors"}," 加载更多 ")])):r("",!0),b.value?(s(),a("div",pe,[$(S)])):r("",!0)])]))}}),he=L(ve,[["__scopeId","data-v-75e650cd"]]);export{he as default};
