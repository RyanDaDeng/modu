import{i as C,r as g,o as B,c as M,w as a,A as j,k as L,K as V,a as i,b as t,d,t as c,v as p,f as u,L as S,F as A,h as D,H as F}from"./index-CFF66pSp.js";import{u as N}from"./useNotification-DyDs8qma.js";import{g as z,r as E}from"./bookmark-DRuj-cfL.js";const H={class:"container mx-auto px-4 py-6"},I={class:"mb-6"},K={class:"flex justify-between items-center"},R={class:"text-gray-400"},T={class:"text-pink-500 font-medium"},q={key:0,class:"flex justify-center py-12"},G={key:1,class:"text-center py-12"},J={class:"max-w-md mx-auto"},O={key:2,class:"grid gap-4"},P={class:"flex items-start gap-4"},Q=["src","alt"],U={class:"flex-1 min-w-0"},W={class:"text-lg font-bold text-white mb-1 group-hover/title:text-pink-400 transition-colors"},X={class:"text-sm text-gray-400 mb-2"},Y={class:"flex flex-wrap items-center gap-4 text-xs text-gray-500"},Z={class:"flex items-center gap-1"},tt={class:"flex items-center gap-2 mt-3"},et=["onClick"],it={__name:"BookmarksView",setup(ot){const h=L(),_=C(),m=N(),n=g([]),f=g(!1),w=s=>{const e=new Date(s),o=new Date-e,r=Math.floor(o/(1e3*60*60*24));if(r===0){const v=Math.floor(o/36e5);if(v===0){const x=Math.floor(o/6e4);return x===0?"刚刚":`${x}分钟前`}return`${v}小时前`}else{if(r===1)return"昨天";if(r<7)return`${r}天前`;if(r<30)return`${Math.floor(r/7)}周前`;if(r<365)return`${Math.floor(r/30)}个月前`}return`${Math.floor(r/365)}年前`},y=s=>`${F()}/media/albums/${s}_3x4.jpg`,k=s=>{s.target.src="/default.jpeg"},b=async()=>{if(!_.isLoggedIn){h.push("/login");return}f.value=!0;try{const s=await z();n.value=s.data||[]}catch(s){console.error("Failed to load bookmarks:",s),s.response?.status===401?h.push("/login"):m.error("加载书签失败")}finally{f.value=!1}},$=async s=>{if(confirm("确定要删除这个书签吗？"))try{await E(s),n.value=n.value.filter(e=>e.id!==s),m.success("书签已删除")}catch(e){console.error("Failed to remove bookmark:",e),m.error("删除失败")}};return B(()=>{b()}),(s,e)=>{const l=V("router-link");return i(),M(j,{title:"我的书签"},{default:a(()=>[t("div",H,[t("div",I,[t("div",K,[t("div",null,[e[2]||(e[2]=t("h1",{class:"text-2xl font-bold text-white mb-2"},"我的书签",-1)),t("p",R,[e[0]||(e[0]=c(" 共 ",-1)),t("span",T,p(n.value.length),1),e[1]||(e[1]=c(" 个书签 ",-1))])])])]),f.value?(i(),d("div",q,[u(S)])):n.value.length?(i(),d("div",O,[(i(!0),d(A,null,D(n.value,o=>(i(),d("div",{key:o.id,class:"relative group bg-gray-800/50 backdrop-blur-sm border border-white/10 rounded-xl p-4 hover:bg-gray-700/50 hover:border-white/20 transition-all"},[t("div",P,[u(l,{to:`/chapter/${o.comic_id}?chapter=${o.chapter_id}`,class:"flex-shrink-0 w-24 h-32 rounded-lg overflow-hidden bg-gray-900"},{default:a(()=>[t("img",{src:y(o.comic_id),alt:o.comic_name,class:"w-full h-full object-cover",onError:k},null,40,Q)]),_:2},1032,["to"]),t("div",U,[u(l,{to:`/chapter/${o.comic_id}?chapter=${o.chapter_id}`,class:"block group/title"},{default:a(()=>[t("h3",W,p(o.comic_name),1),t("p",X," 章节 "+p(o.chapter_id),1)]),_:2},1032,["to"]),t("div",Y,[t("div",Z,[e[7]||(e[7]=t("svg",{class:"w-3.5 h-3.5",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z","clip-rule":"evenodd"})],-1)),t("span",null,p(w(o.created_at)),1)])]),t("div",tt,[u(l,{to:`/chapter/${o.comic_id}?chapter=${o.chapter_id}`,class:"inline-flex items-center px-3 py-1.5 bg-pink-500/20 hover:bg-pink-500/30 text-pink-400 rounded-lg text-sm font-medium transition-colors cursor-pointer"},{default:a(()=>[...e[8]||(e[8]=[t("svg",{class:"w-4 h-4 mr-1.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})],-1),c(" 继续阅读 ",-1)])]),_:2},1032,["to"]),t("button",{onClick:r=>$(o.id),class:"inline-flex items-center px-3 py-1.5 bg-red-500/20 hover:bg-red-500/30 text-red-400 rounded-lg text-sm font-medium transition-colors cursor-pointer"},[...e[9]||(e[9]=[t("svg",{class:"w-4 h-4 mr-1.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),c(" 删除 ",-1)])],8,et)])])])]))),128))])):(i(),d("div",G,[t("div",J,[e[4]||(e[4]=t("svg",{class:"w-24 h-24 text-gray-600 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z"})],-1)),e[5]||(e[5]=t("h2",{class:"text-xl font-bold text-white mb-2"},"还没有书签",-1)),e[6]||(e[6]=t("p",{class:"text-gray-400 mb-6"},"在阅读漫画时点击书签按钮，即可保存当前章节位置",-1)),u(l,{to:"/latest",class:"inline-flex items-center px-6 py-3 bg-gradient-to-r from-pink-500 to-purple-600 text-white rounded-xl font-medium hover:from-pink-600 hover:to-purple-700 transition-all transform hover:scale-105 cursor-pointer"},{default:a(()=>[...e[3]||(e[3]=[c(" 浏览漫画 ",-1)])]),_:1})])]))])]),_:1})}}};export{it as default};
