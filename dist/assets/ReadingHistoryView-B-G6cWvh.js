import{r as e,o as t,c as s,w as r,A as o,C as a,l,K as i,a as n,b as c,d,e as u,v as p,x as m,f as v,L as x,F as g,h as f,S as h}from"./index-CXsfJElZ.js";import{U as b}from"./UnifiedComicCard-CxTScC7q.js";import{u as y}from"./useNotification-BeiNZpPH.js";const w={class:"container mx-auto px-4 py-6"},k={class:"mb-6"},A={class:"flex justify-between items-center"},C={class:"text-gray-400"},j={class:"text-pink-500 font-medium"},I={key:0,class:"text-center py-16"},M={key:1,class:"flex justify-center py-12"},z={key:2},B={class:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-4"},L={class:"relative"},V={class:"absolute inset-0 pointer-events-none rounded-lg overflow-hidden"},_=["onClick"],R={class:"absolute bottom-2 left-2 right-2 flex items-center justify-between gap-2 pointer-events-auto"},T={class:"inline-flex items-center px-2 py-1 text-[10px] sm:text-xs font-medium bg-gray-900/70 backdrop-blur-sm border border-gray-600/50 text-gray-200 rounded-full"},H={class:"truncate max-w-[100px]"},U={class:"inline-flex items-center px-2 py-1 text-[10px] font-medium bg-gray-900/70 backdrop-blur-sm border border-gray-600/50 text-gray-300 rounded-full whitespace-nowrap"},F={__name:"ReadingHistoryView",setup(F){l();const K=y(),N=e([]),S=e(!0),q=e=>({id:e.comicId,name:e.comicTitle,title:e.comicTitle,image:e.coverImage,cover:e.coverImage}),D=async()=>{if(confirm("确定要清空所有阅读历史吗？此操作不可恢复。"))try{await a.clearAll(),N.value=[],K.success("已清空所有阅读历史")}catch(e){K.error("清空失败")}};return t(()=>{(async()=>{S.value=!0;try{const e=await a.getAll();N.value=e}catch(e){K.error("加载阅读历史失败")}finally{S.value=!1}})()}),(e,t)=>{const l=i("router-link");return n(),s(o,{title:"阅读历史"},{default:r(()=>[c("div",w,[c("div",k,[c("div",A,[c("div",null,[t[2]||(t[2]=c("h1",{class:"text-2xl font-bold text-white mb-2"},"阅读历史",-1)),c("p",C,[t[0]||(t[0]=p(" 共 ",-1)),c("span",j,m(N.value.length),1),t[1]||(t[1]=p(" 条记录 ",-1))])]),N.value.length>0?(n(),d("button",{key:0,onClick:D,class:"text-sm text-gray-400 hover:text-red-400 transition-colors cursor-pointer flex items-center gap-1"},[...t[3]||(t[3]=[c("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[c("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),p(" 清空历史 ",-1)])])):u("",!0)])]),0!==N.value.length||S.value?S.value?(n(),d("div",M,[v(x)])):(n(),d("div",z,[c("div",B,[(n(!0),d(g,null,f(N.value,e=>{return n(),d("div",{key:e.comicId,class:"relative group"},[c("div",L,[v(b,{comic:q(e),"show-category":!1,"show-episode":!1,"show-stats":!1,"show-author":!1,"show-description":!1,"show-tags":!1},null,8,["comic"]),c("div",V,[t[10]||(t[10]=c("div",{class:"absolute top-2 left-2 z-20 pointer-events-auto"},[c("span",{class:"inline-flex items-center px-2 py-1 text-xs font-bold bg-gradient-to-r from-pink-500/80 to-purple-600/80 backdrop-blur-sm text-white rounded-full shadow-lg border border-pink-400/30"}," 继续阅读 ")],-1)),c("button",{onClick:h(t=>(async e=>{try{await a.remove(e),N.value=N.value.filter(t=>t.comicId!==e),K.success("已删除阅读记录")}catch(t){K.error("删除失败")}})(e.comicId),["stop"]),class:"absolute top-2 right-2 z-20 p-1.5 bg-red-600/80 sm:bg-gray-900/80 hover:bg-red-600/90 rounded-full sm:opacity-0 sm:group-hover:opacity-100 transition-all duration-200 backdrop-blur-sm cursor-pointer shadow-lg pointer-events-auto",title:"删除记录"},[...t[8]||(t[8]=[c("svg",{class:"w-3.5 h-3.5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[c("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])],8,_),c("div",R,[c("span",T,[t[9]||(t[9]=c("svg",{class:"w-3 h-3 mr-1 text-purple-400",fill:"currentColor",viewBox:"0 0 20 20"},[c("path",{d:"M9 4.804A7.968 7.968 0 005.5 4c-1.255 0-2.443.29-3.5.804v10A7.969 7.969 0 015.5 14c1.669 0 3.218.51 4.5 1.385A7.962 7.962 0 0114.5 14c1.255 0 2.443.29 3.5.804v-10A7.968 7.968 0 0014.5 4c-1.669 0-3.218.51-4.5 1.385V4.804z"})],-1)),c("span",H,m(e.chapterTitle||"未知章节"),1)]),c("span",U,m((s=e.lastRead,a.formatLastRead(s))),1)])])])]);var s}),128))])])):(n(),d("div",I,[t[5]||(t[5]=c("svg",{class:"w-24 h-24 text-gray-600 mx-auto mb-4",fill:"currentColor",viewBox:"0 0 20 20"},[c("path",{d:"M9 4.804A7.968 7.968 0 005.5 4c-1.255 0-2.443.29-3.5.804v10A7.969 7.969 0 015.5 14c1.669 0 3.218.51 4.5 1.385A7.962 7.962 0 0114.5 14c1.255 0 2.443.29 3.5.804v-10A7.968 7.968 0 0014.5 4c-1.669 0-3.218.51-4.5 1.385V4.804z"})],-1)),t[6]||(t[6]=c("h3",{class:"text-lg font-medium text-white mb-2"},"暂无阅读历史",-1)),t[7]||(t[7]=c("p",{class:"text-gray-400 mb-6"},"您还没有阅读过任何漫画",-1)),v(l,{to:"/",class:"inline-flex items-center px-6 py-3 bg-gradient-to-r from-pink-500 to-purple-600 text-white rounded-xl font-medium hover:from-pink-600 hover:to-purple-700 transition-all transform hover:scale-105 cursor-pointer"},{default:r(()=>[...t[4]||(t[4]=[p(" 去探索漫画 ",-1)])]),_:1})]))])]),_:1})}}};export{F as default};
