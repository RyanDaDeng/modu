import{i as C,r as g,o as B,c as M,w as a,A as j,k as L,K as V,a as i,b as e,d,t as c,v as p,f as u,L as S,F as A,h as D,H as F}from"./index-Brj9CnMw.js";import{u as N}from"./useNotification-D6CCFNe2.js";import{g as z,r as E}from"./bookmark-aHyBhYbr.js";const H={class:"container mx-auto px-4 py-6"},I={class:"mb-6"},K={class:"flex justify-between items-center"},R={class:"text-gray-400"},T={class:"text-pink-500 font-medium"},q={key:0,class:"flex justify-center py-12"},G={key:1,class:"text-center py-12"},J={class:"max-w-md mx-auto"},O={key:2,class:"grid gap-4"},P={class:"flex items-start gap-4"},Q=["src","alt"],U={class:"flex-1 min-w-0"},W={class:"text-lg font-bold text-white mb-1 group-hover/title:text-pink-400 transition-colors"},X={class:"text-sm text-gray-400 mb-2"},Y={class:"flex flex-wrap items-center gap-4 text-xs text-gray-500"},Z={class:"flex items-center gap-1"},tt={class:"flex items-center gap-2 mt-3"},et=["onClick"],it={__name:"BookmarksView",setup(ot){const h=L(),_=C(),m=N(),n=g([]),f=g(!1),w=s=>{const t=new Date(s),o=new Date-t,r=Math.floor(o/(1e3*60*60*24));if(r===0){const v=Math.floor(o/36e5);if(v===0){const x=Math.floor(o/6e4);return x===0?"刚刚":"".concat(x,"分钟前")}return"".concat(v,"小时前")}else{if(r===1)return"昨天";if(r<7)return"".concat(r,"天前");if(r<30)return"".concat(Math.floor(r/7),"周前");if(r<365)return"".concat(Math.floor(r/30),"个月前")}return"".concat(Math.floor(r/365),"年前")},y=s=>{const t=F();return"".concat(t,"/media/albums/").concat(s,"_3x4.jpg")},k=s=>{s.target.src="/default.jpeg"},b=async()=>{var s;if(!_.isLoggedIn){h.push("/login");return}f.value=!0;try{const t=await z();n.value=t.data||[]}catch(t){console.error("Failed to load bookmarks:",t),((s=t.response)==null?void 0:s.status)===401?h.push("/login"):m.error("加载书签失败")}finally{f.value=!1}},$=async s=>{if(confirm("确定要删除这个书签吗？"))try{await E(s),n.value=n.value.filter(t=>t.id!==s),m.success("书签已删除")}catch(t){console.error("Failed to remove bookmark:",t),m.error("删除失败")}};return B(()=>{b()}),(s,t)=>{const l=V("router-link");return i(),M(j,{title:"我的书签"},{default:a(()=>[e("div",H,[e("div",I,[e("div",K,[e("div",null,[t[2]||(t[2]=e("h1",{class:"text-2xl font-bold text-white mb-2"},"我的书签",-1)),e("p",R,[t[0]||(t[0]=c(" 共 ",-1)),e("span",T,p(n.value.length),1),t[1]||(t[1]=c(" 个书签 ",-1))])])])]),f.value?(i(),d("div",q,[u(S)])):n.value.length?(i(),d("div",O,[(i(!0),d(A,null,D(n.value,o=>(i(),d("div",{key:o.id,class:"relative group bg-gray-800/50 backdrop-blur-sm border border-white/10 rounded-xl p-4 hover:bg-gray-700/50 hover:border-white/20 transition-all"},[e("div",P,[u(l,{to:"/chapter/".concat(o.comic_id,"?chapter=").concat(o.chapter_id),class:"flex-shrink-0 w-24 h-32 rounded-lg overflow-hidden bg-gray-900"},{default:a(()=>[e("img",{src:y(o.comic_id),alt:o.comic_name,class:"w-full h-full object-cover",onError:k},null,40,Q)]),_:2},1032,["to"]),e("div",U,[u(l,{to:"/chapter/".concat(o.comic_id,"?chapter=").concat(o.chapter_id),class:"block group/title"},{default:a(()=>[e("h3",W,p(o.comic_name),1),e("p",X," 章节 "+p(o.chapter_id),1)]),_:2},1032,["to"]),e("div",Y,[e("div",Z,[t[7]||(t[7]=e("svg",{class:"w-3.5 h-3.5",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z","clip-rule":"evenodd"})],-1)),e("span",null,p(w(o.created_at)),1)])]),e("div",tt,[u(l,{to:"/chapter/".concat(o.comic_id,"?chapter=").concat(o.chapter_id),class:"inline-flex items-center px-3 py-1.5 bg-pink-500/20 hover:bg-pink-500/30 text-pink-400 rounded-lg text-sm font-medium transition-colors cursor-pointer"},{default:a(()=>[...t[8]||(t[8]=[e("svg",{class:"w-4 h-4 mr-1.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})],-1),c(" 继续阅读 ",-1)])]),_:2},1032,["to"]),e("button",{onClick:r=>$(o.id),class:"inline-flex items-center px-3 py-1.5 bg-red-500/20 hover:bg-red-500/30 text-red-400 rounded-lg text-sm font-medium transition-colors cursor-pointer"},[...t[9]||(t[9]=[e("svg",{class:"w-4 h-4 mr-1.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),c(" 删除 ",-1)])],8,et)])])])]))),128))])):(i(),d("div",G,[e("div",J,[t[4]||(t[4]=e("svg",{class:"w-24 h-24 text-gray-600 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z"})],-1)),t[5]||(t[5]=e("h2",{class:"text-xl font-bold text-white mb-2"},"还没有书签",-1)),t[6]||(t[6]=e("p",{class:"text-gray-400 mb-6"},"在阅读漫画时点击书签按钮，即可保存当前章节位置",-1)),u(l,{to:"/latest",class:"inline-flex items-center px-6 py-3 bg-gradient-to-r from-pink-500 to-purple-600 text-white rounded-xl font-medium hover:from-pink-600 hover:to-purple-700 transition-all transform hover:scale-105 cursor-pointer"},{default:a(()=>[...t[3]||(t[3]=[c(" 浏览漫画 ",-1)])]),_:1})])]))])]),_:1})}}};export{it as default};
