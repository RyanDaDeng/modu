import{r as m,o as w,c as k,w as v,A as _,v as c,k as A,C,a as s,b as e,d as i,f as d,I as u,L as B,G as p,F as M,h as I,N as L}from"./index-CstFYGIV.js";import{U as V}from"./UnifiedComicCard--Tmk3avU.js";import{u as F}from"./useNotification-Cpt0kBMz.js";const j={class:"container mx-auto px-4 py-6"},z={key:0,class:"text-center py-16"},H={key:1,class:"flex justify-center py-12"},N={key:2},R={class:"flex justify-between items-center mb-6"},T={class:"text-lg font-bold text-white flex items-center"},S={class:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-4"},U={class:"relative"},D={class:"absolute inset-0 pointer-events-none rounded-lg overflow-hidden"},E=["onClick"],G={class:"absolute bottom-2 left-2 right-2 flex items-center justify-between gap-2 pointer-events-auto"},$={class:"inline-flex items-center px-2 py-1 text-[10px] sm:text-xs font-medium bg-gray-900/70 backdrop-blur-sm border border-gray-600/50 text-gray-200 rounded-full"},q={class:"truncate max-w-[100px]"},J={class:"inline-flex items-center px-2 py-1 text-[10px] font-medium bg-gray-900/70 backdrop-blur-sm border border-gray-600/50 text-gray-300 rounded-full whitespace-nowrap"},X={__name:"ReadingHistoryView",setup(K){A();const a=F(),r=m([]),n=m(!0),f=async()=>{n.value=!0;try{const o=await c.getAll();r.value=o}catch(o){console.error("Failed to load history:",o),a.error("加载阅读历史失败")}finally{n.value=!1}},g=o=>({id:o.comicId,name:o.comicTitle,title:o.comicTitle,image:o.coverImage,cover:o.coverImage}),x=o=>c.formatLastRead(o),h=async o=>{try{await c.remove(o),r.value=r.value.filter(t=>t.comicId!==o),a.success("已删除阅读记录")}catch(t){console.error("Failed to remove item:",t),a.error("删除失败")}},y=async()=>{if(confirm("确定要清空所有阅读历史吗？此操作不可恢复。"))try{await c.clearAll(),r.value=[],a.success("已清空所有阅读历史")}catch(o){console.error("Failed to clear history:",o),a.error("清空失败")}};return w(()=>{f()}),(o,t)=>{const b=C("router-link");return s(),k(_,{title:"阅读历史","show-breadcrumbs":!0},{default:v(()=>[e("div",j,[r.value.length===0&&!n.value?(s(),i("div",z,[t[1]||(t[1]=e("svg",{class:"w-24 h-24 text-gray-600 mx-auto mb-4",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{d:"M9 4.804A7.968 7.968 0 005.5 4c-1.255 0-2.443.29-3.5.804v10A7.969 7.969 0 015.5 14c1.669 0 3.218.51 4.5 1.385A7.962 7.962 0 0114.5 14c1.255 0 2.443.29 3.5.804v-10A7.968 7.968 0 0014.5 4c-1.669 0-3.218.51-4.5 1.385V4.804z"})],-1)),t[2]||(t[2]=e("h3",{class:"text-lg font-medium text-white mb-2"},"暂无阅读历史",-1)),t[3]||(t[3]=e("p",{class:"text-gray-400 mb-6"},"您还没有阅读过任何漫画",-1)),d(b,{to:"/",class:"inline-flex items-center px-6 py-3 bg-gradient-to-r from-pink-500 to-purple-600 text-white rounded-xl font-medium hover:from-pink-600 hover:to-purple-700 transition-all transform hover:scale-105 cursor-pointer"},{default:v(()=>[...t[0]||(t[0]=[u(" 去探索漫画 ",-1)])]),_:1})])):n.value?(s(),i("div",H,[d(B)])):(s(),i("div",N,[e("div",R,[e("h2",T,[t[4]||(t[4]=e("svg",{class:"w-5 h-5 mr-2 text-pink-500",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{d:"M9 4.804A7.968 7.968 0 005.5 4c-1.255 0-2.443.29-3.5.804v10A7.969 7.969 0 015.5 14c1.669 0 3.218.51 4.5 1.385A7.962 7.962 0 0114.5 14c1.255 0 2.443.29 3.5.804v-10A7.968 7.968 0 0014.5 4c-1.669 0-3.218.51-4.5 1.385V4.804z"})],-1)),u(" 阅读历史 ("+p(r.value.length)+") ",1)]),e("button",{onClick:y,class:"text-sm text-gray-400 hover:text-red-400 transition-colors cursor-pointer flex items-center gap-1"},[...t[5]||(t[5]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),u(" 清空历史 ",-1)])])]),e("div",S,[(s(!0),i(M,null,I(r.value,l=>(s(),i("div",{key:l.comicId,class:"relative group"},[e("div",U,[d(V,{comic:g(l),"show-category":!1,"show-episode":!1,"show-stats":!1,"show-author":!1,"show-description":!1,"show-tags":!1},null,8,["comic"]),e("div",D,[t[8]||(t[8]=e("div",{class:"absolute top-2 left-2 z-20 pointer-events-auto"},[e("span",{class:"inline-flex items-center px-2 py-1 text-xs font-bold bg-gradient-to-r from-pink-500/80 to-purple-600/80 backdrop-blur-sm text-white rounded-full shadow-lg border border-pink-400/30"}," 继续阅读 ")],-1)),e("button",{onClick:L(O=>h(l.comicId),["stop"]),class:"absolute top-2 right-2 z-20 p-1.5 bg-red-600/80 sm:bg-gray-900/80 hover:bg-red-600/90 rounded-full sm:opacity-0 sm:group-hover:opacity-100 transition-all duration-200 backdrop-blur-sm cursor-pointer shadow-lg pointer-events-auto",title:"删除记录"},[...t[6]||(t[6]=[e("svg",{class:"w-3.5 h-3.5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])],8,E),e("div",G,[e("span",$,[t[7]||(t[7]=e("svg",{class:"w-3 h-3 mr-1 text-purple-400",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{d:"M9 4.804A7.968 7.968 0 005.5 4c-1.255 0-2.443.29-3.5.804v10A7.969 7.969 0 015.5 14c1.669 0 3.218.51 4.5 1.385A7.962 7.962 0 0114.5 14c1.255 0 2.443.29 3.5.804v-10A7.968 7.968 0 0014.5 4c-1.669 0-3.218.51-4.5 1.385V4.804z"})],-1)),e("span",q,p(l.chapterTitle||"未知章节"),1)]),e("span",J,p(x(l.lastRead)),1)])])])]))),128))])]))])]),_:1})}}};export{X as default};
