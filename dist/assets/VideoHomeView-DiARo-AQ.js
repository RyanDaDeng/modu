import{r as e,j as t,d as l,a,b as r,e as o,N as s,F as n,h as u,x as i,k as p,o as d,s as c,c as v,w as g,l as x,f as b,P as h,a4 as y,U as m,v as f}from"./index-B0oRfr6y.js";import{V as k,g as w,a as C}from"./VideoLayout-D2GvKkS_.js";import{_ as L}from"./VideoGrid-DJHrnnTW.js";import{_ as F}from"./Pagination-CA5RVl85.js";const T={class:"bg-gray-900/60 backdrop-blur-sm border border-white/10 rounded-lg p-4 space-y-4"},P={class:"flex flex-wrap gap-2"},_=["onClick"],j={class:"text-xs opacity-70"},S={class:"flex flex-wrap gap-2"},M=["onClick"],V={class:"flex flex-wrap gap-2"},q=["onClick"],z={__name:"VideoFilter",props:{categories:{type:Array,default:()=>[]},selectedType:{type:String,default:null},selectedSortFilter:{type:String,default:"latest"},selectedSource:{type:String,default:null}},emits:["update:type","update:sortFilter","update:source","reset"],setup(p){const d=p,c=e(!1),v=t(()=>c.value||d.categories.length<=10?d.categories:d.categories.slice(0,10)),g=[{value:"latest",label:"最新"},{value:"hot",label:"最热"},{value:"favorites",label:"最多收藏"}],x=[{value:"lebo",label:"乐播"},{value:"lajiao",label:"辣椒"},{value:"senlin",label:"森林"}];return(e,t)=>(a(),l("div",T,[r("div",null,[t[3]||(t[3]=r("h3",{class:"text-sm font-semibold text-white mb-3"},"分类",-1)),r("div",P,[r("button",{onClick:t[0]||(t[0]=t=>e.$emit("update:type",null)),class:s(["px-3 py-1.5 text-sm rounded-lg transition-all cursor-pointer",p.selectedType?"bg-white/5 text-gray-300 hover:bg-white/10 border border-white/10":"bg-gradient-to-r from-pink-500 to-purple-500 text-white"])}," 全部 ",2),(a(!0),l(n,null,u(v.value,(t,o)=>(a(),l("button",{key:t.value,onClick:l=>e.$emit("update:type",t.value),class:s(["px-3 py-1.5 text-sm rounded-lg transition-all flex items-center gap-1 cursor-pointer",p.selectedType===t.value?"bg-gradient-to-r from-pink-500 to-purple-500 text-white":"bg-white/5 text-gray-300 hover:bg-white/10 border border-white/10"])},[r("span",null,i(t.label),1),r("span",j,"("+i(t.count)+")",1)],10,_))),128)),p.categories.length>10?(a(),l("button",{key:0,onClick:t[1]||(t[1]=e=>c.value=!c.value),class:"px-3 py-1.5 text-sm rounded-lg transition-all cursor-pointer bg-blue-500/20 text-blue-400 hover:bg-blue-500/30 border border-blue-500/30"},i(c.value?"收起 ↑":"更多 ↓"),1)):o("",!0)])]),r("div",null,[t[4]||(t[4]=r("h3",{class:"text-sm font-semibold text-white mb-3"},"排序",-1)),r("div",S,[(a(),l(n,null,u(g,t=>r("button",{key:t.value,onClick:l=>e.$emit("update:sortFilter",t.value),class:s(["px-3 py-1.5 text-sm rounded-lg transition-all cursor-pointer",p.selectedSortFilter===t.value?"bg-gradient-to-r from-pink-500 to-purple-500 text-white":"bg-white/5 text-gray-300 hover:bg-white/10 border border-white/10"])},i(t.label),11,M)),64))])]),r("div",null,[t[5]||(t[5]=r("h3",{class:"text-sm font-semibold text-white mb-3"},"来源",-1)),r("div",V,[r("button",{onClick:t[2]||(t[2]=t=>e.$emit("update:source",null)),class:s(["px-3 py-1.5 text-sm rounded-lg transition-all cursor-pointer",p.selectedSource?"bg-white/5 text-gray-300 hover:bg-white/10 border border-white/10":"bg-gradient-to-r from-pink-500 to-purple-500 text-white"])}," 全部 ",2),(a(),l(n,null,u(x,(t,l)=>r("button",{key:t.value,onClick:l=>e.$emit("update:source",t.value),class:s(["px-3 py-1.5 text-sm rounded-lg transition-all cursor-pointer",p.selectedSource===t.value?"bg-gradient-to-r from-pink-500 to-purple-500 text-white":"bg-white/5 text-gray-300 hover:bg-white/10 border border-white/10"])},i(l+1)+"号资源 ",11,q)),64))])])]))}},B={class:"container mx-auto px-4 py-4 space-y-3"},$={class:"lg:hidden"},U={class:"relative"},A={class:"lg:hidden mb-3"},R={key:0,class:"flex items-center gap-2 flex-wrap"},W={key:0,class:"inline-flex items-center gap-1 px-3 py-1 bg-pink-100 dark:bg-pink-900/30 text-pink-700 dark:text-pink-300 rounded-full text-sm cursor-pointer"},G={key:1,class:"inline-flex items-center gap-1 px-3 py-1 bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 rounded-full text-sm cursor-pointer"},H={key:2,class:"inline-flex items-center gap-1 px-3 py-1 bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-300 rounded-full text-sm cursor-pointer"},K={key:3,class:"inline-flex items-center gap-1 px-3 py-1 bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300 rounded-full text-sm cursor-pointer"},N={key:2,class:"flex justify-center mt-8"},D={__name:"VideoHomeView",setup(n){const u=c(),T=x(),P=e([]),_=e([]),j=e(""),S=e(!1),M=e(!0),V=e(!1),q=e(""),D=e(null),E=e({type:null,sortFilter:"latest",source:null,searchText:null}),I=e({currentPage:1,perPage:32,total:0,lastPage:1}),J=t(()=>null!==E.value.type||"latest"!==E.value.sortFilter||null!==E.value.source||null!==E.value.searchText),O=t(()=>{if(!E.value.type)return"全部";const e=_.value.find(e=>e.value===E.value.type);return e?e.label:E.value.type}),Q=t(()=>({latest:"最新",hot:"最热",favorites:"最多收藏"}[E.value.sortFilter]||E.value.sortFilter)),X=t(()=>({lebo:"1号资源",lajiao:"2号资源",senlin:"3号资源"}[E.value.source]||E.value.source)),Y=t(()=>E.value.type?`暂无「${O.value}」分类的视频`:"暂无视频，试试换个筛选条件吧"),Z=async(e=1)=>{S.value=!0;try{const t={type:E.value.type,sort_filter:E.value.sortFilter,source:E.value.source,text:E.value.searchText,page:e,per_page:I.value.perPage},l=await C(t),a=l.data||l;P.value=a.data||[],I.value={currentPage:a.current_page||1,perPage:a.per_page||30,total:a.total||0,lastPage:a.last_page||1}}catch(t){P.value=[]}finally{S.value=!1}},ee=async()=>{try{const e=await w(),t=e.data||e;_.value=Array.isArray(t)?t:t.categories||t.data||[],t.cdn_domain&&(j.value=t.cdn_domain)}catch(e){_.value=[]}},te=(e,t)=>{E.value[e]=t,"searchText"===e&&null===t&&T.push({name:"video-home"}),Z(1),window.innerWidth<1024&&(V.value=!1)},le=()=>{E.value={type:null,sortFilter:"latest",source:null,searchText:null},T.push({name:"video-home"}),Z(1),window.innerWidth<1024&&(V.value=!1)},ae=e=>{if(Z(e),D.value){const e=D.value.offsetTop-20;window.scrollTo(0,e)}else window.scrollTo(0,0)},re=()=>{const e=q.value.trim();e&&(T.push({name:"video-home",query:{q:e}}),q.value="")};return p(()=>u.query.q,e=>{E.value.searchText=e||null,Z(1)}),d(async()=>{try{const e=u.query.q;e&&(E.value.searchText=e),await Promise.all([ee(),Z(1)])}catch(e){}finally{M.value=!1}}),(e,t)=>(a(),v(k,{title:"在线视频","page-loading":M.value,"show-top-nav":!0,"no-header":!0},{default:g(()=>[r("div",B,[r("div",$,[r("div",U,[h(r("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>q.value=e),onKeyup:y(re,["enter"]),type:"text",placeholder:"搜索视频...",class:"w-full px-3 py-2 pr-20 bg-gray-900/60 backdrop-blur-sm border border-white/10 rounded-lg text-sm text-white placeholder-gray-400 focus:outline-none focus:border-pink-500/50 transition-all"},null,544),[[m,q.value]]),q.value?(a(),l("button",{key:0,onClick:t[1]||(t[1]=e=>q.value=""),class:"absolute right-16 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-200 cursor-pointer"},[...t[10]||(t[10]=[r("svg",{class:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20"},[r("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})],-1)])])):o("",!0),r("button",{onClick:re,class:"absolute right-1.5 top-1/2 -translate-y-1/2 px-3 py-1 text-sm bg-gradient-to-r from-pink-500 to-purple-500 hover:from-pink-600 hover:to-purple-600 text-white rounded-md transition-all cursor-pointer"}," 搜索 ")])]),r("div",null,[r("div",A,[r("button",{onClick:t[2]||(t[2]=e=>V.value=!V.value),class:"w-full flex items-center justify-between px-3 py-2 bg-gray-900/60 backdrop-blur-sm border border-white/10 rounded-lg hover:border-pink-500/30 transition-all"},[t[12]||(t[12]=r("span",{class:"text-sm font-medium text-white"}," 筛选条件 ",-1)),(a(),l("svg",{class:s(["w-4 h-4 text-gray-400 transition-transform",{"rotate-180":V.value}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...t[11]||(t[11]=[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)])],2))])]),r("div",{class:s(["transition-all duration-300",V.value?"block":"hidden lg:block"])},[b(z,{categories:_.value,"selected-type":E.value.type,"selected-sort-filter":E.value.sortFilter,"selected-source":E.value.source,"onUpdate:type":t[3]||(t[3]=e=>te("type",e)),"onUpdate:sortFilter":t[4]||(t[4]=e=>te("sortFilter",e)),"onUpdate:source":t[5]||(t[5]=e=>te("source",e)),onReset:le},null,8,["categories","selected-type","selected-sort-filter","selected-source"])],2)]),J.value?(a(),l("div",R,[t[17]||(t[17]=r("span",{class:"text-sm text-gray-500 dark:text-gray-400"},"当前筛选：",-1)),E.value.type?(a(),l("span",W,[f(i(O.value)+" ",1),r("button",{onClick:t[6]||(t[6]=e=>te("type",null)),class:"hover:text-pink-900 dark:hover:text-pink-100"},[...t[13]||(t[13]=[r("svg",{class:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20"},[r("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1)])])])):o("",!0),"latest"!==E.value.sortFilter?(a(),l("span",G,[f(i(Q.value)+" ",1),r("button",{onClick:t[7]||(t[7]=e=>te("sortFilter","latest")),class:"hover:text-blue-900 dark:hover:text-blue-100"},[...t[14]||(t[14]=[r("svg",{class:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20"},[r("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1)])])])):o("",!0),E.value.source?(a(),l("span",H,[f(i(X.value)+" ",1),r("button",{onClick:t[8]||(t[8]=e=>te("source",null)),class:"hover:text-purple-900 dark:hover:text-purple-100"},[...t[15]||(t[15]=[r("svg",{class:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20"},[r("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1)])])])):o("",!0),E.value.searchText?(a(),l("span",K,[f(" 搜索: "+i(E.value.searchText)+" ",1),r("button",{onClick:t[9]||(t[9]=e=>te("searchText",null)),class:"hover:text-green-900 dark:hover:text-green-100"},[...t[16]||(t[16]=[r("svg",{class:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20"},[r("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1)])])])):o("",!0),r("button",{onClick:le,class:"text-sm text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 underline cursor-pointer"}," 清空筛选 ")])):o("",!0),P.value.length>0&&I.value.total>0?(a(),l("div",{key:1,ref_key:"topPaginationRef",ref:D,class:"flex justify-center mb-6"},[b(F,{"current-page":I.value.currentPage,"total-pages":I.value.lastPage,onChange:ae},null,8,["current-page","total-pages"])],512)):o("",!0),b(L,{videos:P.value,loading:S.value,"empty-message":Y.value,"cdn-domain":j.value},null,8,["videos","loading","empty-message","cdn-domain"]),P.value.length>0&&I.value.total>0?(a(),l("div",N,[b(F,{"current-page":I.value.currentPage,"total-pages":I.value.lastPage,onChange:ae},null,8,["current-page","total-pages"])])):o("",!0)])]),_:1},8,["page-loading"]))}};export{D as default};
