import{l as e,r as a,j as t,o as l,n as s,d as r,a as n,f as o,L as i,b as u,a8 as v,x as d,v as c,S as g,F as p,h,N as m,s as y,c as b,w as x,e as f,P as w,a4 as k,U as _}from"./index-B0oRfr6y.js";import{b as j,V as C,g as P,a as M}from"./VideoLayout-D2GvKkS_.js";import{_ as V}from"./VideoGrid-DJHrnnTW.js";import{_ as L}from"./Pagination-CA5RVl85.js";const z={class:"relative bg-gray-800 rounded-xl overflow-hidden shadow-2xl"},B={key:0,class:"aspect-video bg-gray-700 animate-pulse flex items-center justify-center"},S={key:1,class:"relative"},q=["src","alt"],N={class:"absolute bottom-0 left-0 right-0 p-6"},D={class:"flex items-start justify-between gap-4"},$={class:"flex-1 min-w-0"},A={class:"text-white text-xl font-bold mb-2 line-clamp-2"},F={class:"flex items-center gap-4 text-sm text-gray-300"},I={class:"px-2 py-1 bg-pink-500/80 backdrop-blur-sm rounded"},U={class:"flex items-center gap-1"},W={class:"flex items-center gap-2"},E=["disabled"],G=["disabled"],H={class:"absolute bottom-4 left-1/2 transform -translate-x-1/2 flex items-center gap-2"},K=["onClick"],R={key:2,class:"aspect-video bg-gray-700 flex items-center justify-center"},T={__name:"VideoRecommendationSlider",props:{typeName:{type:String,default:null},cdnDomain:{type:String,default:""},autoPlay:{type:Boolean,default:!0},interval:{type:Number,default:5e3}},setup(y){const b=y,x=e(),f=a([]),w=a(0),k=a(!0);let _=null;const C=t(()=>f.value[w.value]),P=()=>{f.value.length<=1||(w.value=(w.value-1+f.value.length)%f.value.length,J())},M=()=>{f.value.length<=1||(w.value=(w.value+1)%f.value.length,J())},V=e=>{e.target.src="/img_6.png"},L=()=>{!b.autoPlay||f.value.length<=1||(_=setInterval(()=>{M()},b.interval))},T=()=>{_&&(clearInterval(_),_=null)},J=()=>{T(),L()};return l(()=>{(async()=>{k.value=!0;try{const e=await j({limit:8,type_name:b.typeName});f.value=e.data||[]}catch(e){f.value=[]}finally{k.value=!1}})().then(()=>{L()})}),s(()=>{T()}),(e,a)=>{return n(),r("div",z,[k.value?(n(),r("div",B,[o(i)])):f.value.length>0?(n(),r("div",S,[u("div",{class:"aspect-video relative group cursor-pointer",onClick:a[0]||(a[0]=e=>{return a=C.value,void x.push(`/video/${a.id}`);var a})},[u("img",{src:(l=C.value.cover_img,l&&b.cdnDomain?l.startsWith("http://")||l.startsWith("https://")?l:b.cdnDomain+l:l||""),alt:C.value.name,class:"w-full h-full object-cover",onError:V},null,40,q),a[4]||(a[4]=v('<div class="absolute inset-0 bg-gradient-to-t from-black/80 via-black/20 to-transparent"></div><div class="absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-300"><div class="w-20 h-20 rounded-full bg-white/20 backdrop-blur-sm flex items-center justify-center transform group-hover:scale-110 transition-transform"><svg class="w-10 h-10 text-white" fill="currentColor" viewBox="0 0 20 20"><path d="M6.3 2.841A1.5 1.5 0 004 4.11V15.89a1.5 1.5 0 002.3 1.269l9.344-5.89a1.5 1.5 0 000-2.538L6.3 2.84z"></path></svg></div></div>',2)),u("div",N,[u("div",D,[u("div",$,[u("h3",A,d(C.value.name),1),u("div",F,[u("span",I,d(C.value.type_name),1),u("span",U,[a[1]||(a[1]=u("svg",{class:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20"},[u("path",{d:"M10 12a2 2 0 100-4 2 2 0 000 4z"}),u("path",{"fill-rule":"evenodd",d:"M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.064 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z","clip-rule":"evenodd"})],-1)),c(" "+d((t=C.value.views,t?t>=1e4?(t/1e4).toFixed(1)+"w":t.toString():"0")),1)])])]),u("div",W,[u("button",{onClick:g(P,["stop"]),class:"p-2 bg-white/10 backdrop-blur-sm hover:bg-white/20 rounded-full transition-all",disabled:f.value.length<=1},[...a[2]||(a[2]=[u("svg",{class:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[u("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])],8,E),u("button",{onClick:g(M,["stop"]),class:"p-2 bg-white/10 backdrop-blur-sm hover:bg-white/20 rounded-full transition-all",disabled:f.value.length<=1},[...a[3]||(a[3]=[u("svg",{class:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[u("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)])],8,G)])])])]),u("div",H,[(n(!0),r(p,null,h(f.value,(e,a)=>(n(),r("button",{key:e.id,onClick:e=>w.value=a,class:m(["transition-all",a===w.value?"w-8 h-2 bg-pink-500":"w-2 h-2 bg-white/50 hover:bg-white/80"]),style:{"border-radius":"9999px"}},null,10,K))),128))])])):(n(),r("div",R,[...a[5]||(a[5]=[u("div",{class:"text-center text-gray-400"},[u("svg",{class:"w-16 h-16 mx-auto mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[u("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})]),u("p",null,"暂无推荐视频")],-1)])]))]);var t,l}}},J={class:"container mx-auto px-4 py-6 space-y-6"},O={class:"max-w-2xl mx-auto"},Q={class:"relative"},X={key:0},Y={class:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4"},Z={key:0,class:"text-sm text-gray-500 dark:text-gray-400 ml-2"},ee={key:0,class:"flex justify-center mb-6"},ae={key:1,class:"flex justify-center mt-8"},te={key:1},le={class:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4"},se={__name:"VideoSearchView",setup(s){const i=y(),v=e(),g=a([]),p=a(""),h=a(!1),m=a(""),j=a(""),z=a(!1),B=a({currentPage:1,perPage:30,total:0,lastPage:1}),S=t(()=>j.value?[{name:`搜索: ${j.value}`,path:null}]:[{name:"搜索",path:null}]),q=async(e,a=1)=>{h.value=!0;try{const t={text:e,page:a,per_page:B.value.perPage},l=await M(t),s=l.data||l;g.value=s.data||[],B.value={currentPage:s.current_page||1,perPage:s.per_page||30,total:s.total||0,lastPage:s.last_page||1}}catch(t){g.value=[]}finally{h.value=!1}},N=async()=>{const e=m.value.trim();e&&(j.value=e,z.value=!0,v.push({name:"video-search",query:{q:e}}),await q(e,1))},D=()=>{m.value="",j.value="",z.value=!1,g.value=[],v.push({name:"video-search"})},$=e=>{j.value&&(q(j.value,e),window.scrollTo(0,0))};return l(async()=>{await(async()=>{try{const e=await P(),a=e.data||e;a.cdn_domain&&(p.value=a.cdn_domain)}catch(e){}})();const e=i.query.q;e&&(m.value=e,N())}),(e,a)=>(n(),b(C,{title:"视频搜索",breadcrumbs:S.value,"show-top-nav":!0},{default:x(()=>[u("div",J,[u("div",O,[u("div",Q,[w(u("input",{"onUpdate:modelValue":a[0]||(a[0]=e=>m.value=e),onKeyup:k(N,["enter"]),type:"text",placeholder:"搜索视频...",class:"w-full px-4 py-3 pr-24 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-pink-500"},null,544),[[_,m.value]]),j.value?(n(),r("button",{key:0,onClick:D,class:"absolute right-20 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"},[...a[1]||(a[1]=[u("svg",{class:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20"},[u("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})],-1)])])):f("",!0),u("button",{onClick:N,class:"absolute right-2 top-1/2 -translate-y-1/2 px-4 py-1.5 bg-pink-500 hover:bg-pink-600 text-white rounded-md transition-colors"}," 搜索 ")])]),z.value?(n(),r("div",X,[u("h2",Y,[c(' 搜索结果: "'+d(j.value)+'" ',1),!h.value&&g.value.length>0?(n(),r("span",Z," (共 "+d(B.value.total)+" 个结果) ",1)):f("",!0)]),g.value.length>0&&B.value.total>0?(n(),r("div",ee,[o(L,{"current-page":B.value.currentPage,"total-pages":B.value.lastPage,onChange:$},null,8,["current-page","total-pages"])])):f("",!0),o(V,{videos:g.value,loading:h.value,"empty-message":`没有找到「${j.value}」相关的视频`,"cdn-domain":p.value},null,8,["videos","loading","empty-message","cdn-domain"]),g.value.length>0&&B.value.total>0?(n(),r("div",ae,[o(L,{"current-page":B.value.currentPage,"total-pages":B.value.lastPage,onChange:$},null,8,["current-page","total-pages"])])):f("",!0)])):f("",!0),z.value&&(h.value||g.value.length)?f("",!0):(n(),r("div",te,[u("h2",le,d(z.value?"试试这些热门视频":"热门推荐"),1),o(T,{"cdn-domain":p.value},null,8,["cdn-domain"])]))])]),_:1},8,["breadcrumbs"]))}};export{se as default};
