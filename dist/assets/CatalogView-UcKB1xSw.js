import{z as K,r,o as W,c as z,w as X,A as Y,q as Z,n as ee,k as te,$ as le,a as s,b as a,d as o,e as i,f as P,L as I,F as y,h,N as V,t as se,v as _,s as ae,O as oe}from"./index-DXOvPRcc.js";import{_ as re}from"./ComicCard-w_g3wf6z.js";import{_ as A}from"./Pagination-Bans1KFA.js";const ne={class:"container mx-auto px-4 py-6"},ue={key:0,class:"relative"},ie={class:"relative bg-gray-900/80 backdrop-blur-xl border border-white/10 rounded-lg p-4"},ve={class:"flex flex-col items-center"},ce={key:1,class:"relative"},de={class:"relative bg-gray-900/60 backdrop-blur-xl border border-white/10 rounded-lg p-2 sm:p-4 space-y-2 sm:space-y-4"},pe={class:"flex overflow-x-auto gap-1 sm:gap-2 pb-1 sm:pb-0 -mx-2 px-2 sm:mx-0 sm:px-0 sm:flex-wrap no-scrollbar"},ge=["onClick"],me={key:0,class:"hidden sm:inline ml-1 text-xs opacity-70"},be={class:"flex overflow-x-auto gap-1 sm:gap-2 pb-1 sm:pb-0 -mx-2 px-2 sm:mx-0 sm:px-0 sm:flex-wrap no-scrollbar"},xe=["onClick"],fe={key:0},ye={class:"flex overflow-x-auto gap-1 sm:gap-2 pb-1 sm:pb-0 -mx-2 px-2 sm:mx-0 sm:px-0 sm:flex-wrap no-scrollbar"},he=["onClick"],_e={key:2,class:"mt-4 mb-4"},ke={key:3,class:"relative mt-2 sm:mt-4 mb-4 sm:mb-6"},Ce={class:"relative bg-gray-900/60 backdrop-blur-xl border border-white/10 rounded-lg p-3 sm:p-4"},we={class:"text-xs sm:text-sm text-gray-400 mb-1.5 sm:mb-2"},$e={class:"flex flex-wrap gap-1.5 sm:gap-2"},Pe=["onClick"],Se={key:4,class:"flex justify-center py-8 sm:py-12"},Ne={key:5,class:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 lg:grid-cols-6 xl:grid-cols-6 2xl:grid-cols-7 gap-2 sm:gap-3 md:gap-4 mt-4"},Ve={key:6,class:"text-center py-8 sm:py-12"},qe={key:7,class:"flex justify-center py-6 sm:py-8"},Fe={key:8,class:"flex justify-center py-6 sm:py-8"},Ie={key:9,class:"mt-8"},Le={name:"CatalogView"},Be=Object.assign(Le,{setup(Oe){const L=te(),E=Z(),d=r([]),B=r([]),n=r(null),p=r(null),b=r("mv"),O=[{label:"最新",value:""},{label:"最多爱心",value:"tf"},{label:"总排名",value:"mv"},{label:"月排名",value:"mv_m"},{label:"周排名",value:"mp_w"}],c=r([]),x=r(!1),j=r(!0),q=r(!0),k=r(!1),v=r(0),f=r(!0),C=r(!1),S=r(0),w=r(0),m=r(1),g=r(1),D=()=>{const t=E.query;if(t.page){const e=parseInt(t.page);!isNaN(e)&&e>0&&(v.value=e,g.value=e)}else v.value===0&&(v.value=1,g.value=1);if(t.o){const e=t.o;O.find(u=>u.value===e)&&(b.value=e)}if(t.c&&d.value.length>0)if(t.c.includes("_")){const[e,l]=t.c.split("_"),u=d.value.find($=>$.slug===e);if(u&&(n.value=u,u.sub_categories)){const $=u.sub_categories.find(J=>J.slug===l);$&&(p.value=$)}}else{const e=d.value.find(l=>l.slug===t.c);e&&(n.value=e)}},M=()=>{const t={};if(t.page=g.value,b.value&&b.value!=="mv"&&(t.o=b.value),n.value){let e=n.value.slug;p.value&&(e=`${e}_${p.value.slug}`),e&&(t.c=e)}L.push({query:t})},Q=async()=>{q.value=!0;try{const t=await ee();t&&(d.value=t.categories||[],B.value=t.blocks||[],D(),!n.value&&d.value.length>0&&(n.value=d.value[0]),n.value&&N(!1))}catch(t){console.error("Failed to load categories:",t)}finally{q.value=!1,j.value=!1}},F=async(t=!1)=>{if(!(t&&x.value||!t&&k.value||!f.value&&!t)){t?x.value=!0:k.value=!0;try{let e=n.value?.slug||"";p.value&&e&&(e=`${e}_${p.value.slug}`);const l=await le(v.value,b.value,e);l?.content?(t?c.value=l.content:c.value.push(...l.content),l.total!==void 0&&(S.value=l.total),w.value===0&&l.content.length>0&&(w.value=l.content.length),S.value>0&&w.value>0?m.value=Math.ceil(S.value/w.value):m.value=v.value+(l.content.length>=80?1:0),g.value=v.value,t||v.value++,f.value=l.content.length>=80):(f.value=!1,t&&(m.value=0))}catch(e){console.error("Failed to load comics:",e),f.value=!1}finally{t?x.value=!1:k.value=!1}}},N=(t=!0)=>{c.value=[],t&&(v.value=1,g.value=1),f.value=!0,C.value=!0,S.value=0,w.value=0,m.value=1,M(),F(!0)},U=t=>{L.push({path:"/search",query:{q:t}})},G=t=>{n.value=t,p.value=null,N(!0)},H=t=>{b.value=t,N(!0)},R=t=>{p.value=t,N(!0)},T=t=>{c.value=[],v.value=t,g.value=t,f.value=!0,M(),F(!0),window.scrollTo({top:0,behavior:"smooth"})};return W(()=>{d.value.length===0&&(D(),v.value===0&&(v.value=1,g.value=1),Q())}),(t,e)=>(s(),z(Y,{title:"分类浏览","page-loading":j.value},{default:X(()=>[a("div",ne,[q.value?(s(),o("div",ue,[e[3]||(e[3]=a("div",{class:"absolute inset-0 bg-gradient-to-r from-pink-500/20 via-purple-500/20 to-blue-500/20 rounded-lg blur-xl"},null,-1)),a("div",ie,[a("div",ve,[P(I),e[2]||(e[2]=a("span",{class:"mt-3 text-gray-400 text-sm"},"加载分类中...",-1))])])])):i("",!0),d.value.length>0?(s(),o("div",ce,[e[7]||(e[7]=a("div",{class:"absolute inset-0 bg-gradient-to-r from-pink-500/10 via-purple-500/10 to-blue-500/10 rounded-lg blur-xl"},null,-1)),a("div",de,[a("div",null,[e[4]||(e[4]=a("label",{class:"text-xs sm:text-sm text-gray-400 mb-1 sm:mb-2 block"},"分类",-1)),a("div",pe,[(s(!0),o(y,null,h(d.value,l=>(s(),o("button",{key:l.id,onClick:u=>G(l),class:V(["flex-shrink-0 px-3 sm:px-4 py-1.5 sm:py-2 rounded-lg text-xs sm:text-sm font-medium transition-colors whitespace-nowrap cursor-pointer",n.value?.id===l.id?"bg-pink-500/20 text-pink-400 border border-pink-500/50":"bg-gray-800/50 text-gray-300 hover:bg-gray-700/50 hover:text-white border border-gray-700"])},[se(_(l.name)+" ",1),l.total_albums>0?(s(),o("span",me," ("+_(ae(oe)(l.total_albums))+") ",1)):i("",!0)],10,ge))),128))])]),a("div",null,[e[5]||(e[5]=a("label",{class:"text-xs sm:text-sm text-gray-400 mb-1 sm:mb-2 block"},"排序",-1)),a("div",be,[(s(),o(y,null,h(O,l=>a("button",{key:l.value,onClick:u=>H(l.value),class:V(["flex-shrink-0 px-3 sm:px-4 py-1.5 sm:py-2 rounded-lg text-xs sm:text-sm font-medium transition-colors whitespace-nowrap cursor-pointer",b.value===l.value?"bg-pink-500/20 text-pink-400 border border-pink-500/50":"bg-gray-800/50 text-gray-300 hover:bg-gray-700/50 hover:text-white border border-gray-700"])},_(l.label),11,xe)),64))])]),n.value?.sub_categories?.length&&n.value.id!==0?(s(),o("div",fe,[e[6]||(e[6]=a("label",{class:"text-xs sm:text-sm text-gray-400 mb-1 sm:mb-2 block"},"子分类",-1)),a("div",ye,[a("button",{onClick:e[0]||(e[0]=l=>R(null)),class:V(["flex-shrink-0 px-3 sm:px-4 py-1.5 sm:py-2 rounded-lg text-xs sm:text-sm font-medium transition-colors whitespace-nowrap cursor-pointer",p.value?"bg-gray-800/50 text-gray-300 hover:bg-gray-700/50 hover:text-white border border-gray-700":"bg-pink-500/20 text-pink-400 border border-pink-500/50"])}," 全部 ",2),(s(!0),o(y,null,h(n.value.sub_categories,l=>(s(),o("button",{key:l.CID,onClick:u=>R(l),class:V(["flex-shrink-0 px-3 sm:px-4 py-1.5 sm:py-2 rounded-lg text-xs sm:text-sm font-medium transition-colors whitespace-nowrap cursor-pointer",p.value?.CID===l.CID?"bg-pink-500/20 text-pink-400 border border-pink-500/50":"bg-gray-800/50 text-gray-300 hover:bg-gray-700/50 hover:text-white border border-gray-700"])},_(l.name),11,he))),128))])])):i("",!0)])])):i("",!0),C.value&&m.value>1&&c.value.length>0?(s(),o("div",_e,[P(A,{"current-page":g.value,"total-pages":m.value,onChange:T},null,8,["current-page","total-pages"])])):i("",!0),C.value?i("",!0):(s(),o("div",ke,[e[8]||(e[8]=a("div",{class:"absolute inset-0 bg-gradient-to-r from-pink-500/10 via-purple-500/10 to-blue-500/10 rounded-lg blur-xl"},null,-1)),a("div",Ce,[(s(!0),o(y,null,h(B.value,l=>(s(),o("div",{key:l.title,class:"mb-3 sm:mb-4 last:mb-0"},[a("h3",we,_(l.title),1),a("div",$e,[(s(!0),o(y,null,h(l.content,u=>(s(),o("button",{key:u,onClick:$=>U(u),class:"px-2 sm:px-3 py-1 sm:py-1.5 bg-gray-800/50 hover:bg-pink-500/20 text-gray-300 hover:text-pink-400 border border-gray-700 hover:border-pink-500/50 rounded-full text-xs sm:text-sm transition-colors cursor-pointer"},_(u),9,Pe))),128))])]))),128))])])),x.value?(s(),o("div",Se,[P(I)])):i("",!0),!x.value&&c.value.length>0?(s(),o("div",Ne,[(s(!0),o(y,null,h(c.value,l=>(s(),z(re,{key:l.id,comic:l},null,8,["comic"]))),128))])):i("",!0),!x.value&&C.value&&c.value.length===0?(s(),o("div",Ve,[...e[9]||(e[9]=[a("p",{class:"text-gray-400 text-sm"},"暂无相关漫画",-1)])])):i("",!0),f.value&&!x.value&&!k.value&&c.value.length?(s(),o("div",qe,[a("button",{onClick:e[1]||(e[1]=l=>F()),class:"px-6 py-3 bg-pink-600 hover:bg-pink-700 text-white rounded-lg font-medium transition-colors cursor-pointer"}," 加载更多 ")])):i("",!0),k.value?(s(),o("div",Fe,[P(I)])):i("",!0),C.value&&m.value>1&&c.value.length>0?(s(),o("div",Ie,[P(A,{"current-page":g.value,"total-pages":m.value,onChange:T},null,8,["current-page","total-pages"])])):i("",!0)])]),_:1},8,["page-loading"]))}}),Re=K(Be,[["__scopeId","data-v-b2164466"]]);export{Re as default};
