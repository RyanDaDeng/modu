import{_ as J,r,j as K,o as Y,c as E,w as Z,A as Q,W as ee,p as te,k as le,X as se,a as s,b as a,d as o,e as i,f as S,L as F,F as y,h,E as I,I as ae,G as _,q as oe,H as re}from"./index-DAKd_ngf.js";import{_ as ne}from"./ComicCard-DYvYCcpE.js";import{_ as z}from"./Pagination-C67jTV1L.js";const ue={class:"container mx-auto px-4 py-6"},ie={key:0,class:"relative"},ce={class:"relative bg-gray-900/80 backdrop-blur-xl border border-white/10 rounded-lg p-4"},ve={class:"flex flex-col items-center"},de={key:1,class:"relative"},pe={class:"relative bg-gray-900/60 backdrop-blur-xl border border-white/10 rounded-lg p-2 sm:p-4 space-y-2 sm:space-y-4"},ge={class:"flex overflow-x-auto gap-1 sm:gap-2 pb-1 sm:pb-0 -mx-2 px-2 sm:mx-0 sm:px-0 sm:flex-wrap no-scrollbar"},me=["onClick"],be={key:0,class:"hidden sm:inline ml-1 text-xs opacity-70"},xe={class:"flex overflow-x-auto gap-1 sm:gap-2 pb-1 sm:pb-0 -mx-2 px-2 sm:mx-0 sm:px-0 sm:flex-wrap no-scrollbar"},fe=["onClick"],ye={key:0},he={class:"flex overflow-x-auto gap-1 sm:gap-2 pb-1 sm:pb-0 -mx-2 px-2 sm:mx-0 sm:px-0 sm:flex-wrap no-scrollbar"},_e=["onClick"],ke={key:2,class:"mt-4 mb-4"},Ce={key:3,class:"relative mt-2 sm:mt-4 mb-4 sm:mb-6"},we={class:"relative bg-gray-900/60 backdrop-blur-xl border border-white/10 rounded-lg p-3 sm:p-4"},$e={class:"text-xs sm:text-sm text-gray-400 mb-1.5 sm:mb-2"},Pe={class:"flex flex-wrap gap-1.5 sm:gap-2"},Se=["onClick"],qe={key:4,class:"flex justify-center py-8 sm:py-12"},Ie={key:5,class:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 lg:grid-cols-6 xl:grid-cols-6 2xl:grid-cols-7 gap-2 sm:gap-3 md:gap-4 mt-4"},Ne={key:6,class:"text-center py-8 sm:py-12"},Ve={key:7,class:"flex justify-center py-6 sm:py-8"},Fe={key:8,class:"flex justify-center py-6 sm:py-8"},Le={key:9,class:"mt-8"},je={name:"CatalogView"},Be=Object.assign(je,{setup(De){const L=le(),j=te(),v=r([]),B=r([]),n=r(null),d=r(null),b=r("mv"),D=[{label:"最新",value:""},{label:"最多爱心",value:"tf"},{label:"总排名",value:"mv"},{label:"月排名",value:"mv_m"},{label:"周排名",value:"mp_w"}],c=r([]),x=r(!1),M=r(!0),N=r(!0),k=r(!1),g=r(1),f=r(!0),C=r(!1),q=r(0),w=r(0),m=r(1),p=r(1),O=()=>{const t=j.query;if(t.page){const e=parseInt(t.page);!isNaN(e)&&e>0&&(g.value=e,p.value=e)}else g.value=1,p.value=1;if(t.o){const e=t.o;D.find(u=>u.value===e)&&(b.value=e)}if(t.c&&v.value.length>0)if(t.c.includes("_")){const[e,l]=t.c.split("_"),u=v.value.find(P=>P.slug===e);if(u&&(n.value=u,u.sub_categories)){const P=u.sub_categories.find(X=>X.slug===l);P&&(d.value=P)}}else{const e=v.value.find(l=>l.slug===t.c);e&&(n.value=e)}},R=()=>{const t={};if(p.value>1&&(t.page=p.value),b.value&&b.value!=="mv"&&(t.o=b.value),n.value){let e=n.value.slug;d.value&&(e=`${e}_${d.value.slug}`),e&&(t.c=e)}L.replace({query:t})},G=async()=>{N.value=!0;try{const t=await ee();t&&(v.value=t.categories||[],B.value=t.blocks||[],O(),!n.value&&v.value.length>0&&(n.value=v.value[0]),n.value&&$())}catch(t){console.error("Failed to load categories:",t)}finally{N.value=!1,M.value=!1}},V=async(t=!1)=>{if(!(t&&x.value||!t&&k.value||!f.value&&!t)){t?x.value=!0:k.value=!0;try{let e=n.value?.slug||"";d.value&&e&&(e=`${e}_${d.value.slug}`);const l=await se(g.value,b.value,e);l?.content?(t?c.value=l.content:c.value.push(...l.content),l.total!==void 0&&(q.value=l.total),w.value===0&&l.content.length>0&&(w.value=l.content.length),q.value>0&&w.value>0?m.value=Math.ceil(q.value/w.value):m.value=g.value+(l.content.length>=80?1:0),p.value=g.value,g.value++,f.value=l.content.length>=80):(f.value=!1,t&&(m.value=0))}catch(e){console.error("Failed to load comics:",e),f.value=!1}finally{t?x.value=!1:k.value=!1}}},$=(t=!0)=>{c.value=[],t&&(g.value=1,p.value=1),f.value=!0,C.value=!0,q.value=0,w.value=0,m.value=1,R(),V(!0)},H=t=>{L.push({path:"/search",query:{q:t}})},U=t=>{n.value=t,d.value=null,$(!0)},W=t=>{b.value=t,$(!0)},T=t=>{d.value=t,$(!0)},A=t=>{c.value=[],g.value=t,p.value=t,f.value=!0,R(),V(!0),window.scrollTo({top:0,behavior:"smooth"})};return K(()=>j.query,(t,e)=>{if(v.value.length>0){O();const l=t.o!==e?.o||t.c!==e?.c;$(l)}},{deep:!0}),Y(()=>{G()}),(t,e)=>(s(),E(Q,{title:"分类浏览","page-loading":M.value},{default:Z(()=>[a("div",ue,[N.value?(s(),o("div",ie,[e[3]||(e[3]=a("div",{class:"absolute inset-0 bg-gradient-to-r from-pink-500/20 via-purple-500/20 to-blue-500/20 rounded-lg blur-xl"},null,-1)),a("div",ce,[a("div",ve,[S(F),e[2]||(e[2]=a("span",{class:"mt-3 text-gray-400 text-sm"},"加载分类中...",-1))])])])):i("",!0),v.value.length>0?(s(),o("div",de,[e[7]||(e[7]=a("div",{class:"absolute inset-0 bg-gradient-to-r from-pink-500/10 via-purple-500/10 to-blue-500/10 rounded-lg blur-xl"},null,-1)),a("div",pe,[a("div",null,[e[4]||(e[4]=a("label",{class:"text-xs sm:text-sm text-gray-400 mb-1 sm:mb-2 block"},"分类",-1)),a("div",ge,[(s(!0),o(y,null,h(v.value,l=>(s(),o("button",{key:l.id,onClick:u=>U(l),class:I(["flex-shrink-0 px-3 sm:px-4 py-1.5 sm:py-2 rounded-lg text-xs sm:text-sm font-medium transition-colors whitespace-nowrap cursor-pointer",n.value?.id===l.id?"bg-pink-500/20 text-pink-400 border border-pink-500/50":"bg-gray-800/50 text-gray-300 hover:bg-gray-700/50 hover:text-white border border-gray-700"])},[ae(_(l.name)+" ",1),l.total_albums>0?(s(),o("span",be," ("+_(oe(re)(l.total_albums))+") ",1)):i("",!0)],10,me))),128))])]),a("div",null,[e[5]||(e[5]=a("label",{class:"text-xs sm:text-sm text-gray-400 mb-1 sm:mb-2 block"},"排序",-1)),a("div",xe,[(s(),o(y,null,h(D,l=>a("button",{key:l.value,onClick:u=>W(l.value),class:I(["flex-shrink-0 px-3 sm:px-4 py-1.5 sm:py-2 rounded-lg text-xs sm:text-sm font-medium transition-colors whitespace-nowrap cursor-pointer",b.value===l.value?"bg-pink-500/20 text-pink-400 border border-pink-500/50":"bg-gray-800/50 text-gray-300 hover:bg-gray-700/50 hover:text-white border border-gray-700"])},_(l.label),11,fe)),64))])]),n.value?.sub_categories?.length&&n.value.id!==0?(s(),o("div",ye,[e[6]||(e[6]=a("label",{class:"text-xs sm:text-sm text-gray-400 mb-1 sm:mb-2 block"},"子分类",-1)),a("div",he,[a("button",{onClick:e[0]||(e[0]=l=>T(null)),class:I(["flex-shrink-0 px-3 sm:px-4 py-1.5 sm:py-2 rounded-lg text-xs sm:text-sm font-medium transition-colors whitespace-nowrap cursor-pointer",d.value?"bg-gray-800/50 text-gray-300 hover:bg-gray-700/50 hover:text-white border border-gray-700":"bg-pink-500/20 text-pink-400 border border-pink-500/50"])}," 全部 ",2),(s(!0),o(y,null,h(n.value.sub_categories,l=>(s(),o("button",{key:l.CID,onClick:u=>T(l),class:I(["flex-shrink-0 px-3 sm:px-4 py-1.5 sm:py-2 rounded-lg text-xs sm:text-sm font-medium transition-colors whitespace-nowrap cursor-pointer",d.value?.CID===l.CID?"bg-pink-500/20 text-pink-400 border border-pink-500/50":"bg-gray-800/50 text-gray-300 hover:bg-gray-700/50 hover:text-white border border-gray-700"])},_(l.name),11,_e))),128))])])):i("",!0)])])):i("",!0),C.value&&m.value>1&&c.value.length>0?(s(),o("div",ke,[S(z,{"current-page":p.value,"total-pages":m.value,onChange:A},null,8,["current-page","total-pages"])])):i("",!0),C.value?i("",!0):(s(),o("div",Ce,[e[8]||(e[8]=a("div",{class:"absolute inset-0 bg-gradient-to-r from-pink-500/10 via-purple-500/10 to-blue-500/10 rounded-lg blur-xl"},null,-1)),a("div",we,[(s(!0),o(y,null,h(B.value,l=>(s(),o("div",{key:l.title,class:"mb-3 sm:mb-4 last:mb-0"},[a("h3",$e,_(l.title),1),a("div",Pe,[(s(!0),o(y,null,h(l.content,u=>(s(),o("button",{key:u,onClick:P=>H(u),class:"px-2 sm:px-3 py-1 sm:py-1.5 bg-gray-800/50 hover:bg-pink-500/20 text-gray-300 hover:text-pink-400 border border-gray-700 hover:border-pink-500/50 rounded-full text-xs sm:text-sm transition-colors cursor-pointer"},_(u),9,Se))),128))])]))),128))])])),x.value?(s(),o("div",qe,[S(F)])):i("",!0),!x.value&&c.value.length>0?(s(),o("div",Ie,[(s(!0),o(y,null,h(c.value,l=>(s(),E(ne,{key:l.id,comic:l},null,8,["comic"]))),128))])):i("",!0),!x.value&&C.value&&c.value.length===0?(s(),o("div",Ne,[...e[9]||(e[9]=[a("p",{class:"text-gray-400 text-sm"},"暂无相关漫画",-1)])])):i("",!0),f.value&&!x.value&&!k.value&&c.value.length?(s(),o("div",Ve,[a("button",{onClick:e[1]||(e[1]=l=>V()),class:"px-6 py-3 bg-pink-600 hover:bg-pink-700 text-white rounded-lg font-medium transition-colors cursor-pointer"}," 加载更多 ")])):i("",!0),k.value?(s(),o("div",Fe,[S(F)])):i("",!0),C.value&&m.value>1&&c.value.length>0?(s(),o("div",Le,[S(z,{"current-page":p.value,"total-pages":m.value,onChange:A},null,8,["current-page","total-pages"])])):i("",!0)])]),_:1},8,["page-loading"]))}}),Te=J(Be,[["__scopeId","data-v-4fb5303e"]]);export{Te as default};
