import{y as Kt,z as Qt,u as Wt,i as Gt,B as L,q as Jt,r as u,j as ut,o as Zt,m as Xt,c as Se,w as He,A as el,C as dt,D as tl,E as ll,G as sl,H as ct,I as E,J as vt,k as ol,K as al,a as s,d as o,e as c,f as q,b as t,L as Me,M as me,N as I,v as g,s as Y,O as Le,F as pe,h as fe,t as ae,P as ze,Q as rl,T as nl,R as il,S as ul,U as Ee,V as Ae,W as dl}from"./index-Brj9CnMw.js";import{a as cl}from"./bookmark-aHyBhYbr.js";import{u as vl}from"./useNotification-D6CCFNe2.js";import{U as gl}from"./UnifiedComicCard-CMB0-cxG.js";function ml(h,z){if(h>=220980&&h<268850)return 10;const M=Kt(h+z);let m=M.charCodeAt(M.length-1);return h>=268850&&h<=421925?m=m%10:m=m%8,m>=0&&m<=9?m*2+2:10}function pl(h,z,M){if(z<220980||h.src.includes(".gif"))return h;const m=document.createElement("canvas"),re=m.getContext("2d");m.width=h.naturalWidth,m.height=h.naturalHeight;const x=ml(z,M),f=Math.floor(m.height/x),r=m.height%x;re.drawImage(h,0,m.height-f-r,m.width,f+r,0,0,m.width,f+r);for(let j=0;j<x-1;j++)re.drawImage(h,0,f*(x-j-2),m.width,f,0,(j+1)*f+r,m.width,f);return m}function fl(h,z,M){return"".concat(h,"/media/photos/").concat(z,"/").concat(M)}function gt(){const h=new Date().getHours();return h<=3||h>=21?1:h>=18?3:5}const hl={key:0,class:"flex justify-center items-center min-h-screen"},xl={class:"flex flex-col items-center"},bl={key:1},yl={class:"relative"},wl={class:"relative container mx-auto px-4 py-8"},kl={class:"flex flex-col md:flex-row gap-6"},_l={class:"flex flex-col items-center gap-4 flex-shrink-0 mx-auto md:mx-0"},Cl={class:"w-32 sm:w-48 h-44 sm:h-64"},Il=["src","alt"],Sl={key:1,class:"w-full h-full bg-gray-700 rounded-lg animate-pulse"},Ml=["disabled"],Ll={class:"flex-1 text-white text-center md:text-left"},zl={class:"text-xl sm:text-2xl md:text-3xl font-bold mb-3"},Vl={class:"text-sm sm:text-base text-gray-300 mb-2"},jl={class:"text-sm sm:text-base text-gray-300 mb-4"},Bl={class:"flex flex-wrap justify-center md:justify-start gap-3 sm:gap-6 mb-4"},Pl={class:"flex items-center gap-1 sm:gap-2"},$l={class:"text-sm sm:text-base"},Tl={class:"text-gray-400 text-xs sm:text-sm"},Hl={class:"flex items-center gap-1 sm:gap-2"},El={class:"text-sm sm:text-base"},Al={class:"flex items-center gap-1 sm:gap-2"},Rl={class:"text-sm sm:text-base"},Dl={key:0,class:"flex flex-wrap gap-2 mb-6"},Fl=["onClick"],Ul={key:1,class:"text-gray-300 mb-6 line-clamp-3"},Nl={class:"container mx-auto px-4 py-6"},ql={class:"flex border-b border-gray-700 mb-6"},Yl={class:"text-xs sm:text-sm"},Ol={class:"bg-gray-900/60 backdrop-blur-sm border border-white/10 rounded-xl p-4 sm:p-6"},Kl={key:0,class:"space-y-4"},Ql={key:0,class:"grid grid-cols-3 md:grid-cols-5 lg:grid-cols-6 gap-3"},Wl=["onClick"],Gl={class:"absolute -top-2 -right-2 z-10 pointer-events-none"},Jl={key:0,class:"inline-flex items-center px-2 py-0.5 text-xs font-bold bg-pink-500 text-white rounded-full"},Zl={key:1,class:"inline-flex items-center px-2 py-0.5 text-xs font-bold bg-green-500 text-white rounded-full"},Xl={key:2,class:"inline-flex items-center px-2 py-0.5 text-xs font-bold bg-gradient-to-r from-yellow-500 to-yellow-600 text-white rounded-full animate-pulse"},es={key:1,class:"flex flex-col items-center gap-4"},ts={key:0,class:"absolute -top-2 -right-2 z-10 pointer-events-none"},ls={class:"text-center text-gray-400 text-sm"},ss={key:0},os={key:1,class:"space-y-4"},as={key:0,class:"space-y-4"},rs={class:"flex-shrink-0"},ns=["src","alt"],is={class:"flex-1 min-w-0"},us={class:"flex items-center gap-2 mb-2"},ds={class:"font-semibold text-white text-sm sm:text-base truncate"},cs={class:"text-xs text-gray-500"},vs={class:"text-gray-300 text-sm sm:text-base break-words"},gs={key:1,class:"text-center py-8 text-gray-500"},ms={key:2,class:"flex justify-center py-8"},ps={key:0,class:"container mx-auto px-4 pb-6"},fs={class:"bg-gray-900/60 backdrop-blur-sm border border-white/10 rounded-lg p-4 sm:p-6"},hs={class:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-4"},xs={class:"container mx-auto"},bs={class:"flex items-center justify-between px-3 sm:px-4 py-2"},ys={class:"hidden sm:flex items-center gap-3 text-sm flex-1 justify-center"},ws={class:"text-white font-semibold text-base"},ks={class:"text-gray-400"},_s={class:"flex sm:hidden items-center text-xs flex-1 justify-center px-2 gap-2"},Cs={class:"text-white font-semibold truncate"},Is={class:"text-gray-400"},Ss={class:"flex items-center gap-1 sm:gap-2"},Ms=["title"],Ls={key:0,class:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20"},zs={key:1,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Vs={class:"h-0.5 bg-gray-800"},js=["title"],Bs={key:0,class:"w-4 h-4 sm:w-5 sm:h-5",fill:"currentColor",viewBox:"0 0 20 20"},Ps={key:1,class:"w-4 h-4 sm:w-5 sm:h-5",fill:"currentColor",viewBox:"0 0 20 20"},$s={key:1,class:"flex justify-center items-center h-screen"},Ts={class:"flex flex-col items-center"},Hs={key:2,class:"flex justify-center items-center h-screen"},Es={class:"bg-red-900/50 border border-red-700 rounded-lg p-6 text-center max-w-md"},As={class:"text-red-400"},Rs={key:3,class:"pt-10 pb-8 bg-black"},Ds={class:"max-w-3xl sm:max-w-4xl lg:max-w-5xl mx-auto"},Fs=["data-index"],Us={key:0,class:"flex items-center justify-center min-h-[300px] sm:min-h-[500px]"},Ns={key:0,class:"flex flex-col items-center text-gray-400"},qs=["onClick"],Ys=["src","alt","onLoad","onError"],Os={key:0,class:"mt-8 text-center"},Ks=["disabled"],Qs={key:0,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Ws={key:1,class:"w-5 h-5 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Gs={class:"text-gray-400 text-sm mt-2"},Js={key:1,class:"mt-8 p-6 bg-gradient-to-br from-gray-800 to-gray-900 rounded-xl border border-yellow-500/30"},Zs={class:"text-center space-y-4"},Xs={class:"text-gray-300"},eo={class:"flex flex-col sm:flex-row gap-3 justify-center mt-6"},to={key:2,class:"mt-12 mb-8"},lo={class:"relative px-4 py-8 sm:py-12"},so={class:"relative max-w-md mx-auto"},oo={class:"relative overflow-hidden rounded-2xl bg-gray-900/60 backdrop-blur-xl border border-white/10 p-6 sm:p-8 transition-all duration-300 group-hover:bg-gray-900/70 group-hover:border-white/20 group-hover:shadow-2xl group-hover:shadow-pink-500/20"},ao={class:"relative flex items-center justify-between"},ro={class:"relative"},no={key:0,class:"w-8 h-8 sm:w-10 sm:h-10 text-white",fill:"currentColor",viewBox:"0 0 20 20"},io={key:1,class:"w-8 h-8 sm:w-10 sm:h-10 text-white transform group-hover:translate-x-1 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},uo={key:0,class:"mt-4 pt-4 border-t border-white/10"},co={class:"relative w-full max-w-lg sm:max-w-xl"},vo={class:"relative bg-gray-900/90 backdrop-blur-xl rounded-2xl w-full p-4 sm:p-8 border border-white/10"},go={class:"flex items-center justify-between mb-4 sm:mb-6"},mo={key:0,class:"mb-3 sm:mb-6"},po={class:"block text-xs sm:text-sm font-medium text-gray-300 mb-1.5 sm:mb-2"},fo={key:1,class:"mb-3 sm:mb-6 space-y-3 sm:space-y-4"},ho={class:"block text-xs sm:text-sm font-medium text-gray-300 mb-1.5 sm:mb-2"},xo={class:"block text-xs sm:text-sm font-medium text-gray-300 mb-1.5 sm:mb-2"},bo={class:"mb-4 sm:mb-6"},yo={class:"grid grid-cols-2 gap-2 sm:gap-3"},wo={class:"text-[10px] sm:text-xs text-gray-500 mt-1 sm:mt-2"},ko={class:"mb-3 sm:mb-6"},_o={key:0},Co={key:1},Io={class:"mb-4 sm:mb-6"},So=["disabled"],Mo={key:0,class:"flex items-center justify-center gap-2"},Lo={key:1,class:"flex items-center justify-center gap-2"},zo={key:2},Vo={class:"text-xs sm:text-sm text-gray-500 mt-2"},jo={key:0},Bo={key:1},Re=50,Po={__name:"ChapterView",setup(h){const z=Jt(),M=ol(),m=Wt(),re=Gt(),x=vl(),f=L(()=>z.params.id),r=u({}),j=u(!1),he=u(!1),O=u([]),xe=u(!1),B=u(!1),De=u(""),Ve=u(1),Z=u(!0),A=u("chapters"),X=u(!1),b=u(null),Fe=u(""),v=u([]),je=u(!1),ne=u(""),K=u(0),V=u(0),R=u(!1),D=u(!1),F=u(0),Ue=u(0),be=u(!1),Ne=u(0),mt=u(null),ee=u(!0),ie=u(0),k=u(localStorage.getItem("autoScrollEnabled")==="true"),C=u(!0),te=u(parseInt(localStorage.getItem("autoScrollSpeed"))||50),P=u(localStorage.getItem("autoScrollMode")||"smooth"),le=u(parseFloat(localStorage.getItem("stepInterval"))||2),se=u(parseInt(localStorage.getItem("stepSize"))||150),y=u(null),ue=u(!1),Q=u(!1);u({});const W=u(-1),de=u([]),qe=u([]),S=u(null),pt=u(null),ft=u(!1),U=u(!1),G=u(!1),ce=u(!1),Ye=u("");let Be=[],ye=0,w=null;const Oe=L(()=>j.value),Ke=L(()=>{const l=[...r.value.tags||[]],e=r.value.actors||[];return[...l,...e].filter(Boolean)}),ht=L(()=>{const l=r.value.likes||0,e=r.value.total_views||1;return Math.floor(l/e*100)}),Qe=L(()=>v.value.length?Math.floor((F.value+1)/v.value.length*100):0),Pe=L(()=>{var l;if(!b.value)return"";if((l=r.value.series)!=null&&l.length){const e=r.value.series.findIndex(n=>n.id==b.value);if(e>=0)return"第".concat(e+1,"章")}return"第1章"}),We=L(()=>{var e;return!((e=r.value.series)!=null&&e.length)||!b.value?!1:r.value.series.findIndex(n=>n.id==b.value)>0}),Ge=L(()=>{if(!We.value)return null;const l=r.value.series.findIndex(e=>e.id==b.value);return l>0?r.value.series[l-1].id:null}),we=L(()=>{var e;if(!((e=r.value.series)!=null&&e.length)||!b.value)return!1;const l=r.value.series.findIndex(n=>n.id==b.value);return l>=0&&l<r.value.series.length-1}),Je=L(()=>{if(!we.value)return null;const l=r.value.series.findIndex(e=>e.id==b.value);return l>=0&&l<r.value.series.length-1?r.value.series[l+1].id:null}),ke=L(()=>v.value.length?v.value.every(l=>l.loaded||l.error):!1),J=L(()=>{if(!we.value)return!1;const e=r.value.series.findIndex(n=>n.id==b.value)+1;return N(e)}),$e=l=>{const e=ct();return"".concat(e,"/media/albums/").concat(l,"_3x4.jpg")},xt=l=>({id:l.id,name:l.name||l.title,title:l.name||l.title,image:l.image||null}),bt=l=>!l||l==="nopic-Male.gif"?"/default.jpeg":"https://".concat(m.primaryServer,"/media/users/").concat(l),yt=l=>{l.target.src="/default.jpeg"},wt=l=>{l.target.src="/default.jpeg"},kt=async()=>{var l;if(!m.isLoggedIn){U.value=!0;return}if(!he.value){he.value=!0;try{const e=await dl({id:f.value,name:r.value.name,author:(l=r.value.author)==null?void 0:l.join(" & ")});"is_collected"in e&&(j.value=e.is_collected,e.is_collected?x.success("收藏成功"):x.success("取消收藏成功"),console.log("Toggled favorite, new status:",e.is_collected))}catch(e){console.error("Failed to toggle favorite:",e),x.error("操作失败，请稍后重试")}finally{he.value=!1}}},_t=l=>{const e=document.createElement("DIV");return e.innerHTML=l,e.textContent||e.innerText||""},Ze=async()=>{if(!f.value||f.value==="undefined"){console.warn("Invalid comic ID:",f.value),xe.value=!1;return}xe.value=!0,De.value="";try{const l=await tl(f.value);if(r.value=l,console.log("Album data:",l),m.isLoggedIn&&f.value)try{const e=await ll(f.value);j.value=e.is_collected||!1,console.log("Favorite status:",e)}catch(e){console.error("Failed to check favorite status:",e),j.value=!1}else j.value=!1;A.value==="comments"&&!O.value.length&&st(),await Xe()}catch(l){console.error("Failed to load comic info:",l),De.value="加载失败，请稍后重试"}finally{xe.value=!1}},Xe=async()=>{const l=await dt.getByComicId(f.value);l&&(W.value=l.chapterIndex)},Ct=async l=>{var i;const e=f.value;let n="",d=-1;(i=r.value.series)!=null&&i.length?(d=r.value.series.findIndex(a=>a.id==l),d>=0&&(n="第".concat(d+1,"章"))):(d=0,n="单章节"),d>=0&&await dt.add({comicId:e,comicTitle:r.value.name||"",chapterId:l,chapterTitle:n,chapterIndex:d,coverImage:$e(e)}),W.value=d},ve=()=>{var l;return(l=m.user)!=null&&l.vip_expired_at?new Date(m.user.vip_expired_at)>new Date:!1},N=l=>{var e;return m.isLoggedIn&&ve()?!1:(e=r.value.series)!=null&&e.length?l>=10:!1},It=(l,e)=>{console.log("Chapter clicked:",l,"Index:",e,"Locked:",N(e)),N(e)?m.isLoggedIn?G.value=!0:U.value=!0:oe(l)},et=()=>{oe(f.value,!0)},St=()=>{ge(),M.push("/vip")},Mt=()=>{U.value=!1,M.push({path:"/login",query:{redirect:z.fullPath}})},Lt=()=>{U.value=!1,M.push({path:"/register",query:{redirect:z.fullPath}})},zt=()=>{G.value=!1,M.push("/vip")},Vt=()=>{if(!b.value){x.warning("请先选择一个章节");return}Ye.value="是否要为《".concat(r.value.name,"》").concat(Pe.value,"添加书签？"),ce.value=!0},jt=async()=>{var l,e,n,d;try{const i={comic_id:f.value,chapter_id:b.value,comic_name:r.value.name},a=await cl(i);a.already_exists?x.info("该章节已添加书签"):a.is_update?x.info("书签已更新到当前章节"):x.success("书签添加成功")}catch(i){console.error("Bookmark error:",i),((e=(l=i.response)==null?void 0:l.data)==null?void 0:e.error_type)==="limit_reached"?x.error(i.response.data.message||"书签数量已达上限（50个），请删除一些书签后再试"):x.error(((d=(n=i.response)==null?void 0:n.data)==null?void 0:d.message)||"添加书签失败，请稍后再试")}finally{ce.value=!1}},oe=async(l,e=!1)=>{var n;if(Ue.value=window.scrollY,mt.value=l,ee.value=!0,ie.value=0,Ct(l),b.value=l,X.value=!0,je.value=!0,ne.value="",v.value=[],K.value=0,F.value=0,V.value=0,R.value=!1,D.value=!1,k.value&&(C.value=!0,y.value&&(clearInterval(y.value),y.value=null)),(n=r.value.series)!=null&&n.length){r.value.series.find(i=>i.id==l);const d=r.value.series.findIndex(i=>i.id==l);Fe.value="".concat(r.value.name," - 第").concat(d+1,"章")}else Fe.value=r.value.name;try{const d=await sl(l);if(console.log("Chapter data for",l,":",d),d.images&&d.images.length){const i=m.isLoggedIn&&ve(),a=e&&!i,p=10,_=d.images,T=a?_.slice(0,p):_;v.value=T.map((H,it)=>({name:H,src:fl(ct(),l,H),loaded:!1,loading:!1,error:!1,needProcess:parseInt(l)>=220980&&!H.includes(".gif"),index:it})),be.value=a,Ne.value=_.length,a?(V.value=v.value.length,R.value=!1):(V.value=Math.min(Re,v.value.length),R.value=v.value.length>Re),await E(),Te(),tt()}else ne.value="没有找到章节内容"}catch(d){console.error("Failed to load chapter:",d),ne.value="加载失败，请稍后重试"}finally{je.value=!1}},Bt=async()=>{if(!(D.value||!R.value)){D.value=!0;try{const l=V.value,e=Math.min(l+Re,v.value.length);V.value=e,R.value=e<v.value.length,await E(),Te()}finally{D.value=!1}}},Pt=l=>{const e=l.target.scrollTop;e<ie.value||e<50?ee.value=!0:e>ie.value&&e>50&&(ee.value=!1),ie.value=e,tt()},tt=()=>{if(!S.value||!de.value.length)return;const l=S.value,e=l.scrollTop,n=l.clientHeight,d=e+n/2;for(let i=0;i<de.value.length;i++){const a=de.value[i];if(a){const p=a.getBoundingClientRect(),_=l.getBoundingClientRect(),T=p.top-_.top+e,H=T+a.offsetHeight;if(d>=T&&d<=H){F.value=i;break}}}},ge=()=>{k.value&&!C.value&&(Ce(),C.value=!0),X.value=!1,b.value=null,v.value=[],K.value=0,V.value=0,R.value=!1,D.value=!1,F.value=0,ee.value=!0,ie.value=0,w&&(w.disconnect(),w=null),E(()=>{window.scrollTo(0,Ue.value)})},lt=()=>{if(Je.value){const e=r.value.series.findIndex(n=>n.id==b.value)+1;if(N(e)){ge(),m.isLoggedIn?G.value=!0:U.value=!0;return}k.value&&!C.value&&(Ce(),C.value=!0),v.value=[],K.value=0,F.value=0,w&&(w.disconnect(),w=null),S.value&&S.value.scrollTo({top:0,behavior:"smooth"}),oe(Je.value)}},$t=()=>{lt()},Tt=()=>{Ge.value&&(k.value&&!C.value&&(Ce(),C.value=!0),v.value=[],K.value=0,F.value=0,w&&(w.disconnect(),w=null),S.value&&S.value.scrollTo({top:0,behavior:"smooth"}),oe(Ge.value))},Ht=()=>{b.value&&oe(b.value)},st=async()=>{if(!B.value){B.value=!0,Ve.value=1,O.value=[];try{const l=await vt(f.value,1);console.log("Loaded comments:",l.length),O.value=l,Z.value=l.length>=10,console.log("Has more comments:",Z.value)}catch(l){console.error("Failed to load comments:",l)}finally{B.value=!1}}},Et=async()=>{if(!(B.value||!Z.value)){B.value=!0;try{const l=Ve.value+1;console.log("Loading more comments, page:",l);const e=await vt(f.value,l);console.log("Loaded more comments:",e.length),e.length===0?Z.value=!1:(Ve.value=l,O.value.push(...e),Z.value=e.length>=10)}catch(l){console.error("Failed to load more comments:",l)}finally{B.value=!1}}},_e=async l=>{const e=v.value[l];return!e||e.loaded||e.loading?Promise.resolve():new Promise(async n=>{e.loading=!0;const d=gt();for(;ye>=d;)await new Promise(i=>setTimeout(i,100));ye++;try{if(e.needProcess){const i=new Image;i.crossOrigin="anonymous",await new Promise((a,p)=>{i.onload=async()=>{const _=e.name.substring(0,5);console.log("Processing image ".concat(l," with page ").concat(_)),await E();const T=qe.value[l];if(T){const H=pl(i,parseInt(b.value),_);T.width=H.width,T.height=H.height,T.getContext("2d").drawImage(H,0,0)}e.loaded=!0,e.error=!1,K.value++,a()},i.onerror=()=>{e.error=!0,p(new Error("Failed to load image"))},i.src=e.src})}else e.loaded=!0,e.error=!1,K.value++,await new Promise(i=>setTimeout(i,50))}catch(i){console.error("Failed to load image ".concat(l,":"),i),e.error=!0}finally{e.loading=!1,ye--;const i=Be.shift();i!==void 0&&_e(i),n()}})},At=l=>{const e=v.value[l];e&&(e.actuallyLoaded=!0,console.log("Image ".concat(l," actually loaded in DOM")))},Rt=l=>{const e=v.value[l];e&&(e.error=!0,e.loaded=!1,console.error("Image ".concat(l," failed to load in DOM")))},Dt=l=>{v.value[l].error=!1,v.value[l].loaded=!1,_e(l)},Te=()=>{w&&w.disconnect(),w=new IntersectionObserver(l=>{l.forEach(e=>{if(e.isIntersecting){const n=parseInt(e.target.dataset.index),d=v.value[n];if(!d.loaded&&!d.loading){const i=gt();ye<i?_e(n):Be.includes(n)||Be.push(n)}}})},{rootMargin:"200px"}),E(()=>{de.value.forEach((l,e)=>{l&&w.observe(l)})})},ot=()=>{if(!X.value&&pt.value){const l=window.pageYOffset||document.documentElement.scrollTop;ft.value=l>200}},at=l=>{l.key==="Escape"&&X.value&&ge()};ut(f,()=>{Ze()}),ut(A,l=>{l==="comments"&&!O.value.length&&!B.value&&st()});const Ft=l=>{M.push({path:"/search",query:{wd:l}})},Ut=()=>{k.value?$():Ie()},Nt=()=>{C.value?(C.value=!1,qt()):(C.value=!0,Ce())},Ce=()=>{y.value&&(clearInterval(y.value),y.value=null)},qt=()=>{if(k.value)if(y.value&&clearInterval(y.value),P.value==="smooth")y.value=setInterval(()=>{if(!S.value)return;const l=S.value,e=l.scrollTop,n=l.scrollHeight-l.clientHeight;if(e>=n-10){$();return}const d=te.value/20,i=e+d;l.scrollTo({top:i,behavior:"auto"})},50);else{const l=le.value*1e3;y.value=setInterval(()=>{E(()=>{const e=S.value;if(!e)return;const n=e.scrollTop,d=e.scrollHeight-e.clientHeight;if(n>=d-10){$();return}e.scrollBy({top:se.value,behavior:"smooth"})})},l)}},Yt=()=>{localStorage.setItem("autoScrollSpeed",te.value.toString()),k.value&&($(),Ie())},rt=l=>{P.value=l,localStorage.setItem("autoScrollMode",l),k.value&&($(),Ie())},nt=()=>{localStorage.setItem("stepInterval",le.value.toString()),localStorage.setItem("stepSize",se.value.toString()),k.value&&P.value==="stepped"&&($(),Ie())},Ie=()=>{if(k.value=!0,C.value=!1,localStorage.setItem("autoScrollEnabled","true"),y.value&&clearInterval(y.value),P.value==="smooth")y.value=setInterval(()=>{if(!S.value)return;const l=S.value,e=l.scrollTop,n=l.scrollHeight-l.clientHeight;if(e>=n-10){$();return}const d=te.value/20,i=e+d;l.scrollTo({top:i,behavior:"auto"})},50);else{const l=le.value*1e3;y.value=setInterval(()=>{E(()=>{const e=S.value;if(!e)return;const n=e.scrollTop,d=e.scrollHeight-e.clientHeight;if(n>=d-10){$();return}e.scrollBy({top:se.value,behavior:"smooth"})})},l)}},$=()=>{k.value=!1,C.value=!1,localStorage.setItem("autoScrollEnabled","false"),y.value&&(clearInterval(y.value),y.value=null)},Ot=async()=>{if(!(!v.value.length||Q.value)){Q.value=!0,V.value<v.value.length&&(V.value=v.value.length,R.value=!1,await E());try{w&&w.disconnect();const l=[];if(v.value.forEach((n,d)=>{!n.loaded&&!n.loading&&!n.error&&l.push(d)}),l.length===0){Q.value=!1,x.info("所有图片已加载完成");return}console.log("Loading ".concat(l.length," images..."));const e=5;for(let n=0;n<l.length;n+=e){const d=l.slice(n,n+e);await Promise.all(d.map(i=>new Promise(a=>{_e(i).finally(()=>a())}))),n+e<l.length&&await new Promise(i=>setTimeout(i,100))}console.log("All images loaded successfully"),x.success("成功加载 ".concat(l.length," 张图片")),await E(),Te()}catch(l){console.error("Failed to load all images:",l),x.error("部分图片加载失败")}finally{Q.value=!1}}};return Zt(async()=>{var e;Xe(),await Ze();const l=z.query.chapter;if(l&&re.isLoggedIn)if((e=r.value.series)!=null&&e.length){const n=r.value.series.find(d=>d.id==l);n&&oe(n.id)}else r.value.id==l&&et();window.addEventListener("scroll",ot),window.addEventListener("keydown",at)}),Xt(()=>{$(),w&&w.disconnect(),window.removeEventListener("scroll",ot),window.removeEventListener("keydown",at)}),(l,e)=>{const n=al("router-link");return s(),Se(el,{title:r.value.name||"加载中...","show-bottom-nav":!0,"hide-breadcrumbs":!0},{default:He(()=>{var d,i;return[xe.value?(s(),o("div",hl,[t("div",xl,[q(Me)])])):X.value?c("",!0):(s(),o("div",bl,[t("div",yl,[r.value.id?(s(),o("div",{key:0,class:"absolute inset-0 h-96 bg-cover bg-center blur-xl opacity-30",style:me({backgroundImage:"url(".concat($e(r.value.id),")")})},null,4)):c("",!0),t("div",wl,[t("div",kl,[t("div",_l,[t("div",Cl,[r.value.id?(s(),o("img",{key:0,src:$e(r.value.id),alt:r.value.name,class:"w-full h-full object-cover rounded-lg shadow-2xl",onError:yt},null,40,Il)):(s(),o("div",Sl))]),t("button",{onClick:kt,disabled:he.value,class:I(["w-full px-4 py-2 rounded-lg font-medium transition-all cursor-pointer flex items-center justify-center gap-2",Oe.value?"bg-pink-500/20 backdrop-blur-sm border border-pink-500/50 text-pink-400 hover:bg-pink-500/30 hover:border-pink-400":"bg-gray-800/50 backdrop-blur-sm border border-white/10 text-gray-300 hover:bg-gray-700/50 hover:border-white/20"])},[e[19]||(e[19]=t("svg",{class:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{"fill-rule":"evenodd",d:"M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z","clip-rule":"evenodd"})],-1)),t("span",null,g(Oe.value?"已收藏":"收藏"),1)],10,Ml)]),t("div",Ll,[t("h2",zl,g(r.value.name),1),t("p",Vl,"作者: "+g(((d=r.value.author)==null?void 0:d.join(" & "))||"未知"),1),t("p",jl,"ID: "+g(f.value),1),t("div",Bl,[t("div",Pl,[e[20]||(e[20]=t("svg",{class:"w-4 h-4 sm:w-5 sm:h-5 text-pink-400",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{"fill-rule":"evenodd",d:"M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z","clip-rule":"evenodd"})],-1)),t("span",$l,g(Y(Le)(r.value.likes||0)),1),t("span",Tl,"("+g(ht.value)+"%)",1)]),t("div",Hl,[e[21]||(e[21]=t("svg",{class:"w-4 h-4 sm:w-5 sm:h-5 text-blue-400",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{d:"M10 12a2 2 0 100-4 2 2 0 000 4z"}),t("path",{"fill-rule":"evenodd",d:"M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.064 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z","clip-rule":"evenodd"})],-1)),t("span",El,g(Y(Le)(r.value.total_views||0)),1)]),t("div",Al,[e[22]||(e[22]=t("svg",{class:"w-4 h-4 sm:w-5 sm:h-5 text-green-400",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{"fill-rule":"evenodd",d:"M18 10c0 3.866-3.582 7-8 7a8.841 8.841 0 01-4.083-.98L2 17l1.338-3.123C2.493 12.767 2 11.434 2 10c0-3.866 3.582-7 8-7s8 3.134 8 7zM7 9H5v2h2V9zm8 0h-2v2h2V9zM9 9h2v2H9V9z","clip-rule":"evenodd"})],-1)),t("span",Rl,g(Y(Le)(r.value.comment_total||0)),1)])]),Ke.value.length?(s(),o("div",Dl,[(s(!0),o(pe,null,fe(Ke.value,a=>(s(),o("span",{key:a,onClick:p=>Ft(a),class:"px-3 py-1 bg-gray-700/50 backdrop-blur rounded-full text-sm hover:bg-gray-600 transition-colors cursor-pointer"},g(a),9,Fl))),128))])):c("",!0),r.value.description?(s(),o("p",Ul,g(r.value.description),1)):c("",!0)])])])]),t("div",Nl,[t("div",ql,[t("button",{onClick:e[0]||(e[0]=a=>A.value="chapters"),class:I(["px-4 sm:px-6 py-3 font-semibold transition-colors text-sm sm:text-base",A.value==="chapters"?"text-pink-500 border-b-2 border-pink-500":"text-gray-400 hover:text-white"])}," 章节选择 ",2),t("button",{onClick:e[1]||(e[1]=a=>A.value="comments"),class:I(["px-4 sm:px-6 py-3 font-semibold transition-colors flex items-center gap-2 text-sm sm:text-base",A.value==="comments"?"text-pink-500 border-b-2 border-pink-500":"text-gray-400 hover:text-white"])},[e[23]||(e[23]=ae(" 评论 ",-1)),t("span",Yl,"("+g(Y(Le)(r.value.comment_total||0))+")",1)],2)]),t("div",Ol,[A.value==="chapters"?(s(),o("div",Kl,[(i=r.value.series)!=null&&i.length?(s(),o("div",Ql,[(s(!0),o(pe,null,fe(r.value.series,(a,p)=>(s(),o("button",{key:a.id,onClick:_=>It(a.id,p),class:I(["relative px-4 py-3 rounded-lg transition-all text-center cursor-pointer transform hover:scale-105 group border",[p===W.value?"bg-pink-500/20 backdrop-blur-sm border-pink-500/50 hover:bg-pink-500/30 hover:border-pink-400":N(p)?"bg-gray-800/50 backdrop-blur-sm hover:bg-gray-700/50 hover:shadow-lg border-white/10 hover:border-yellow-500/50":"bg-gray-800/50 backdrop-blur-sm hover:bg-gray-700/50 hover:shadow-lg border-white/10 hover:border-green-500/50"]])},[t("div",Gl,[p===W.value?(s(),o("span",Jl," 上次阅读 ")):!Y(m).isLoggedIn&&p<10?(s(),o("span",Zl," 免费 ")):N(p)?(s(),o("span",Xl,[...e[24]||(e[24]=[t("svg",{class:"w-3 h-3 mr-0.5",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})],-1),ae(" VIP ",-1)])])):c("",!0)]),t("div",{class:I(["font-semibold transition-colors",{"text-pink-300 group-hover:text-pink-200":p===W.value,"text-gray-400 group-hover:text-yellow-400":p!==W.value&&N(p),"text-white group-hover:text-green-400":p!==W.value&&!N(p)}])}," 第"+g(p+1)+"章 ",3)],10,Wl))),128))])):(s(),o("div",es,[t("button",{onClick:e[2]||(e[2]=a=>et()),class:"relative px-8 py-4 bg-gradient-to-r from-pink-500 to-rose-500 hover:from-pink-600 hover:to-rose-600 rounded-lg transition-all flex items-center gap-3 cursor-pointer transform hover:scale-105 group shadow-lg hover:shadow-xl"},[ve()?c("",!0):(s(),o("div",ts,[...e[25]||(e[25]=[t("span",{class:"inline-flex items-center px-2 py-0.5 text-xs font-bold bg-green-500 text-white rounded-full"}," 免费预览 ",-1)])])),e[26]||(e[26]=t("svg",{class:"w-6 h-6 text-white transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})],-1)),e[27]||(e[27]=t("span",{class:"text-lg font-semibold text-white"}," 开始阅读 ",-1))]),t("div",ls,[ve()?c("",!0):(s(),o("p",ss,[...e[28]||(e[28]=[t("span",{class:"text-green-400"},"✨ 免费预览前10页",-1),t("span",{class:"mx-2"},"•",-1),t("span",null,"VIP可阅读完整内容",-1)])])),Y(m).isLoggedIn?ve()?c("",!0):(s(),o("button",{key:2,onClick:e[3]||(e[3]=a=>G.value=!0),class:"text-yellow-500 hover:text-yellow-400 font-medium"}," 成为VIP ")):(s(),Se(n,{key:1,to:"/login",class:"text-pink-500 hover:text-pink-400 font-medium"},{default:He(()=>[...e[29]||(e[29]=[ae(" 立即登录 ",-1)])]),_:1}))])]))])):c("",!0),A.value==="comments"?(s(),o("div",os,[O.value.length?(s(),o("div",as,[(s(!0),o(pe,null,fe(O.value,a=>(s(),o("div",{key:a.id,class:"bg-gray-900 rounded-lg p-4 flex gap-4"},[t("div",rs,[t("img",{src:bt(a.photo),alt:a.username,class:"w-10 h-10 sm:w-12 sm:h-12 rounded-full object-cover bg-gray-700",onError:wt},null,40,ns)]),t("div",is,[t("div",us,[t("span",ds,g(a.username),1),t("span",cs,g(a.addtime),1)]),t("p",vs,g(_t(a.content)),1)])]))),128))])):B.value?c("",!0):(s(),o("div",gs," 暂无评论 ")),B.value?(s(),o("div",ms,[q(Me)])):c("",!0),Z.value&&!B.value?(s(),o("button",{key:3,onClick:Et,class:"w-full py-3 bg-pink-600 hover:bg-pink-700 text-white rounded-lg font-medium transition-colors cursor-pointer"}," 加载更多评论 ")):c("",!0)])):c("",!0)])]),r.value.related_list&&r.value.related_list.length>0?(s(),o("div",ps,[t("div",fs,[e[30]||(e[30]=t("h2",{class:"text-xl font-bold text-white mb-4 flex items-center gap-2"},[t("svg",{class:"w-6 h-6 text-pink-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 14v6m-3-3h6M6 10h2a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v2a2 2 0 002 2zm10 0h2a2 2 0 002-2V6a2 2 0 00-2-2h-2a2 2 0 00-2 2v2a2 2 0 002 2zM6 20h2a2 2 0 002-2v-2a2 2 0 00-2-2H6a2 2 0 00-2 2v2a2 2 0 002 2z"})]),ae(" 相关推荐 ")],-1)),t("div",hs,[(s(!0),o(pe,null,fe(r.value.related_list.slice(0,12),a=>(s(),Se(gl,{key:a.id,comic:xt(a),"show-category":!1,"show-stats":!1,"show-tags":!1,"show-author":!1,"show-description":!1,"show-collection-date":!1,"show-episode":!1},null,8,["comic"]))),128))])])])):c("",!0)])),X.value?(s(),o("div",{key:2,ref_key:"readingContainer",ref:S,class:"fixed inset-0 z-50 bg-black overflow-y-auto",onScroll:Pt},[t("div",{class:"fixed top-0 left-0 right-0 z-50 bg-gray-900/95 backdrop-blur-sm border-b border-gray-800 transition-transform duration-300",style:me({transform:ee.value?"translateY(0)":"translateY(-100%)"})},[t("div",xs,[t("div",bs,[t("button",{onClick:ge,class:"px-3 py-1.5 bg-gray-700 hover:bg-gray-600 rounded-lg text-white text-sm font-medium transition-all flex items-center gap-1.5 cursor-pointer",title:"关闭 (ESC)"},[...e[31]||(e[31]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1),t("span",{class:"hidden sm:inline"},"关闭",-1)])]),t("div",ys,[t("span",ws,g(Pe.value),1),t("span",ks,g(F.value+1)+"/"+g(v.value.length),1)]),t("div",_s,[t("span",Cs,g(Pe.value),1),t("span",Is,g(F.value+1)+"/"+g(v.value.length),1)]),t("div",Ss,[Y(re).isLoggedIn?(s(),o("button",{key:0,onClick:Vt,class:"px-2 sm:px-3 py-1.5 bg-gray-600 hover:bg-gray-700 text-gray-300 rounded-lg transition-all flex items-center gap-1 sm:gap-1.5 cursor-pointer text-sm font-medium",title:"添加书签"},[...e[32]||(e[32]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z"})],-1),t("span",{class:"hidden sm:inline"},"书签",-1)])])):c("",!0),t("button",{onClick:e[4]||(e[4]=a=>ue.value=!0),class:I(["px-2 sm:px-3 py-1.5 rounded-lg text-sm font-medium transition-all flex items-center gap-1 sm:gap-1.5 cursor-pointer",k.value?"bg-green-600 hover:bg-green-700 text-white":"bg-gray-600 hover:bg-gray-700 text-gray-300"]),title:"自动滚动设置"},[(s(),o("svg",{class:I(["w-4 h-4",k.value&&"animate-spin-slow"]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...e[33]||(e[33]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"},null,-1),t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"},null,-1)])],2)),e[34]||(e[34]=t("span",{class:"hidden sm:inline"},"设置",-1))],2),We.value?(s(),o("button",{key:1,onClick:Tt,class:"px-2 sm:px-3 py-1.5 bg-gray-600 hover:bg-gray-700 rounded-lg text-white text-sm font-medium transition-all flex items-center gap-1 sm:gap-1.5 cursor-pointer",title:"上一话"},[...e[35]||(e[35]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1),t("span",{class:"hidden sm:inline"},"上一话",-1)])])):c("",!0),we.value?(s(),o("button",{key:2,onClick:$t,class:I(["px-2 sm:px-3 py-1.5 rounded-lg text-white text-sm font-medium transition-all flex items-center gap-1 sm:gap-1.5 cursor-pointer",J.value?"bg-yellow-500 hover:bg-yellow-600":"bg-pink-500 hover:bg-pink-600"]),title:J.value?"下一话(需要VIP)":"下一话"},[J.value?(s(),o("svg",Ls,[...e[36]||(e[36]=[t("path",{"fill-rule":"evenodd",d:"M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z","clip-rule":"evenodd"},null,-1)])])):c("",!0),e[38]||(e[38]=t("span",{class:"hidden sm:inline"},"下一话",-1)),J.value?c("",!0):(s(),o("svg",zs,[...e[37]||(e[37]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"},null,-1)])]))],10,Ms)):c("",!0)])])]),t("div",Vs,[t("div",{class:"h-full bg-gradient-to-r from-pink-500 to-pink-400 transition-all duration-300 ease-out",style:me({width:"".concat(Qe.value,"%")})},null,4)])],4),t("div",{class:"fixed top-0 left-0 right-0 z-50 h-1 bg-gray-800",style:me({transform:ee.value?"translateY(-100%)":"translateY(0)"})},[t("div",{class:"h-full bg-gradient-to-r from-pink-500 to-pink-400 transition-all duration-300 ease-out",style:me({width:"".concat(Qe.value,"%")})},null,4)],4),k.value?(s(),o("button",{key:0,onClick:Nt,class:"fixed bottom-4 left-4 z-[55] p-2.5 sm:p-3 bg-gray-800/20 hover:bg-gray-800/40 text-white/30 hover:text-white/50 rounded-full backdrop-blur-sm transition-all duration-200 shadow-lg",title:C.value?"继续滚动":"暂停滚动"},[C.value?(s(),o("svg",Bs,[...e[39]||(e[39]=[t("path",{d:"M6.3 2.841A1.5 1.5 0 004 4.11V15.89a1.5 1.5 0 002.3 1.269l9.344-5.89a1.5 1.5 0 000-2.538L6.3 2.84z"},null,-1)])])):(s(),o("svg",Ps,[...e[40]||(e[40]=[t("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zM7 8a1 1 0 012 0v4a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v4a1 1 0 102 0V8a1 1 0 00-1-1z","clip-rule":"evenodd"},null,-1)])]))],8,js)):c("",!0),je.value&&!v.value.length?(s(),o("div",$s,[t("div",Ts,[q(Me)])])):c("",!0),ne.value?(s(),o("div",Hs,[t("div",Es,[e[41]||(e[41]=t("svg",{class:"w-12 h-12 text-red-400 mx-auto mb-4",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})],-1)),t("p",As,g(ne.value),1),t("div",{class:"flex gap-3 justify-center mt-4"},[t("button",{onClick:Ht,class:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors"}," 重试 "),t("button",{onClick:ge,class:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors cursor-pointer"}," 退出 ")])])])):c("",!0),v.value.length?(s(),o("div",Rs,[t("div",Ds,[(s(!0),o(pe,null,fe(v.value.slice(0,V.value),(a,p)=>(s(),o("div",{key:p,ref_for:!0,ref:_=>de.value[p]=_,class:I(["comic-image-container relative flex items-center justify-center",{"min-h-[300px] sm:min-h-[500px]":!a.loaded}]),"data-index":p},[a.loaded?c("",!0):(s(),o("div",Us,[a.error?(s(),o("div",{key:1,onClick:_=>Dt(p),class:"cursor-pointer text-red-400 hover:text-red-300 text-center"},[...e[42]||(e[42]=[t("svg",{class:"w-12 h-12 mx-auto mb-2",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})],-1),t("p",null,"加载失败，点击重试",-1)])],8,qs)):(s(),o("div",Ns,[q(Me)]))])),a.needProcess?ze((s(),o("canvas",{key:1,ref_for:!0,ref:_=>qe.value[p]=_,class:"w-full h-auto block"},null,512)),[[rl,a.loaded]]):c("",!0),!a.needProcess&&a.loaded?(s(),o("img",{key:2,src:a.src,alt:"Page ".concat(p+1),class:"w-full h-auto block",onLoad:_=>At(p),onError:_=>Rt(p)},null,40,Ys)):c("",!0)],10,Fs))),128)),R.value&&!be.value?(s(),o("div",Os,[t("button",{onClick:Bt,disabled:D.value,class:"px-8 py-4 bg-gradient-to-r from-pink-500 to-purple-600 hover:from-pink-600 hover:to-purple-700 text-white rounded-xl font-medium transition-all transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed cursor-pointer inline-flex items-center gap-2"},[D.value?(s(),o("svg",Ws,[...e[44]||(e[44]=[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):(s(),o("svg",Qs,[...e[43]||(e[43]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 14l-7 7m0 0l-7-7m7 7V3"},null,-1)])])),t("span",null,g(D.value?"加载中...":"加载更多 (剩余 ".concat(v.value.length-V.value," 张)")),1)],8,Ks),t("p",Gs," 已显示 "+g(V.value)+" / "+g(v.value.length)+" 张图片 ",1)])):c("",!0),be.value?(s(),o("div",Js,[t("div",Zs,[e[46]||(e[46]=t("div",{class:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-yellow-500 to-yellow-600 rounded-full mb-2"},[t("svg",{class:"w-8 h-8 text-white",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})])],-1)),e[47]||(e[47]=t("h3",{class:"text-xl font-bold text-white"},"需要VIP才能继续阅读",-1)),t("p",Xs," 您已预览前5张图片（共"+g(Ne.value)+"张） ",1),e[48]||(e[48]=t("p",{class:"text-gray-400 text-sm"}," 开通VIP即可解锁全部内容，享受无限阅读体验 ",-1)),t("div",eo,[Y(m).isLoggedIn?c("",!0):(s(),o("button",{key:0,onClick:e[5]||(e[5]=a=>U.value=!0),class:"px-6 py-3 bg-gray-600 hover:bg-gray-700 text-white rounded-lg font-medium transition-colors"}," 立即登录 ")),t("button",{onClick:St,class:"inline-flex items-center justify-center px-6 py-3 bg-gradient-to-r from-yellow-500 to-yellow-600 hover:from-yellow-600 hover:to-yellow-700 text-white rounded-lg font-bold transition-all shadow-lg"},[...e[45]||(e[45]=[t("svg",{class:"w-5 h-5 mr-2",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})],-1),t("span",null,"立即开通VIP",-1)])])])])])):c("",!0),we.value&&!be.value?(s(),o("div",to,[t("div",{onClick:lt,class:"relative group cursor-pointer"},[e[58]||(e[58]=t("div",{class:"absolute inset-0 bg-gradient-to-r from-transparent via-gray-900/50 to-transparent"},null,-1)),t("div",lo,[e[56]||(e[56]=t("div",{class:"absolute left-0 right-0 top-1/2 -translate-y-1/2 h-[1px] bg-gradient-to-r from-transparent via-gray-700 to-transparent"},null,-1)),t("div",so,[t("div",oo,[e[55]||(e[55]=t("div",{class:"absolute inset-0 bg-gradient-to-r from-pink-500/0 via-pink-500/10 to-purple-500/0 opacity-0 group-hover:opacity-100 transition-opacity duration-500"},null,-1)),t("div",ao,[e[53]||(e[53]=t("div",{class:"flex-1"},[t("p",{class:"text-gray-400 text-xs sm:text-sm mb-1"},"继续阅读"),t("h3",{class:"text-white text-lg sm:text-xl font-bold mb-2"},"下一话"),t("div",{class:"flex items-center gap-2"},[t("div",{class:"h-1 w-16 bg-gradient-to-r from-pink-500 to-purple-500 rounded-full"}),t("span",{class:"text-gray-500 text-xs"},"轻触继续")])],-1)),t("div",ro,[e[51]||(e[51]=t("div",{class:"absolute inset-0 rounded-full bg-gradient-to-r from-pink-500 to-purple-500 opacity-20 blur-xl group-hover:opacity-40 transition-opacity"},null,-1)),t("div",{class:I(["relative w-16 h-16 sm:w-20 sm:h-20 rounded-full flex items-center justify-center transition-all duration-300 group-hover:scale-110",J.value?"bg-gradient-to-br from-yellow-500 to-orange-600":"bg-gradient-to-br from-pink-500 to-purple-600"])},[J.value?(s(),o("svg",no,[...e[49]||(e[49]=[t("path",{"fill-rule":"evenodd",d:"M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z","clip-rule":"evenodd"},null,-1)])])):(s(),o("svg",io,[...e[50]||(e[50]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2.5",d:"M13 7l5 5m0 0l-5 5m5-5H6"},null,-1)])]))],2),e[52]||(e[52]=t("div",{class:"absolute inset-0 rounded-full bg-white opacity-0 group-hover:animate-ping"},null,-1))])]),J.value?(s(),o("div",uo,[...e[54]||(e[54]=[t("p",{class:"text-yellow-400 text-sm flex items-center gap-2"},[t("svg",{class:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})]),ae(" 需要VIP会员才能阅读 ")],-1)])])):c("",!0)])]),e[57]||(e[57]=t("div",{class:"mt-6 text-center sm:hidden"},[t("p",{class:"text-gray-600 text-xs"},"👆 点击任意位置继续")],-1))])])])):c("",!0)])])):c("",!0),(s(),Se(nl,{to:"body"},[q(il,{name:"fade"},{default:He(()=>[ue.value?(s(),o("div",{key:0,class:"fixed inset-0 z-[60] flex items-center justify-center bg-black/60 backdrop-blur-sm p-4 sm:p-6",onClick:e[13]||(e[13]=ul(a=>ue.value=!1,["self"]))},[t("div",co,[e[67]||(e[67]=t("div",{class:"absolute inset-0 bg-gradient-to-r from-pink-500 via-purple-500 to-blue-500 rounded-2xl blur-sm opacity-50"},null,-1)),t("div",vo,[t("div",go,[e[60]||(e[60]=t("h3",{class:"text-lg sm:text-2xl font-bold text-white flex items-center gap-2"},[t("div",{class:"p-2 bg-pink-500/20 rounded-lg"},[t("svg",{class:"w-5 h-5 sm:w-6 sm:h-6 text-pink-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})])]),ae(" 自动滚动设置 ")],-1)),t("button",{onClick:e[6]||(e[6]=a=>ue.value=!1),class:"p-1.5 hover:bg-white/10 rounded-lg transition-colors cursor-pointer"},[...e[59]||(e[59]=[t("svg",{class:"w-4 h-4 text-gray-400 hover:text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),P.value==="smooth"?(s(),o("div",mo,[t("label",po," 滚动速度: "+g(te.value)+" 像素/秒 ",1),ze(t("input",{type:"range","onUpdate:modelValue":e[7]||(e[7]=a=>te.value=a),onChange:Yt,min:"10",max:"500",step:"10",class:"w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer slider"},null,544),[[Ee,te.value]]),e[61]||(e[61]=t("div",{class:"flex justify-between text-xs sm:text-sm text-gray-500 mt-2"},[t("span",null,"慢"),t("span",null,"中"),t("span",null,"快"),t("span",null,"极快")],-1))])):c("",!0),P.value==="stepped"?(s(),o("div",fo,[t("div",null,[t("label",ho," 跳动间隔: "+g(le.value)+" 秒 ",1),ze(t("input",{type:"range","onUpdate:modelValue":e[8]||(e[8]=a=>le.value=a),onChange:nt,min:"0.5",max:"5",step:"0.5",class:"w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer slider"},null,544),[[Ee,le.value]]),e[62]||(e[62]=t("div",{class:"flex justify-between text-xs sm:text-sm text-gray-500 mt-2"},[t("span",null,"快速"),t("span",null,"中等"),t("span",null,"缓慢")],-1))]),t("div",null,[t("label",xo," 跳动距离: "+g(se.value)+" 像素 ",1),ze(t("input",{type:"range","onUpdate:modelValue":e[9]||(e[9]=a=>se.value=a),onChange:nt,min:"50",max:"800",step:"25",class:"w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer slider"},null,544),[[Ee,se.value]]),e[63]||(e[63]=t("div",{class:"flex justify-between text-xs sm:text-sm text-gray-500 mt-2"},[t("span",null,"小"),t("span",null,"中"),t("span",null,"大"),t("span",null,"特大")],-1))])])):c("",!0),t("div",bo,[e[64]||(e[64]=t("label",{class:"block text-sm sm:text-base font-medium text-gray-300 mb-2 sm:mb-3"}," 滚动模式 ",-1)),t("div",yo,[t("button",{onClick:e[10]||(e[10]=a=>rt("smooth")),class:I(["px-3 sm:px-4 py-2.5 sm:py-3 rounded-lg text-sm sm:text-base font-medium transition-all cursor-pointer",P.value==="smooth"?"bg-gradient-to-r from-pink-500 to-purple-600 text-white shadow-lg":"bg-gray-800/50 backdrop-blur-sm border border-white/10 text-gray-300 hover:bg-gray-700/50 hover:border-white/20"])}," 平滑滚动 ",2),t("button",{onClick:e[11]||(e[11]=a=>rt("stepped")),class:I(["px-3 sm:px-4 py-2.5 sm:py-3 rounded-lg text-sm sm:text-base font-medium transition-all cursor-pointer",P.value==="stepped"?"bg-gradient-to-r from-pink-500 to-purple-600 text-white shadow-lg":"bg-gray-800/50 backdrop-blur-sm border border-white/10 text-gray-300 hover:bg-gray-700/50 hover:border-white/20"])}," 段落滚动 ",2)]),t("p",wo,g(P.value==="smooth"?"连续平滑滚动":"模拟鼠标滚轮，一次跳一小段"),1)]),t("div",ko,[t("button",{onClick:Ut,class:I(["w-full py-2 sm:py-3 px-3 sm:px-4 rounded-md sm:rounded-lg text-xs sm:text-sm font-medium transition-all",k.value?"bg-green-600 hover:bg-green-700 text-white":"bg-gray-700 hover:bg-gray-600 text-gray-300"])},[k.value?(s(),o("span",Co,"关闭自动滚动")):(s(),o("span",_o,"开启自动滚动"))],2)]),t("div",Io,[t("button",{onClick:Ot,disabled:Q.value||ke.value,class:I(["w-full py-2.5 sm:py-3 px-4 sm:px-5 rounded-lg text-sm sm:text-base font-medium transition-all",Q.value?"bg-gray-800/30 text-gray-500 cursor-not-allowed":ke.value?"bg-green-500/20 border border-green-500/30 text-green-400 cursor-not-allowed":"bg-gray-800/50 backdrop-blur-sm border border-white/10 hover:bg-gray-700/50 hover:border-white/20 text-gray-300 cursor-pointer"])},[ke.value?(s(),o("span",Mo,[e[65]||(e[65]=t("svg",{class:"w-4 h-4 sm:w-5 sm:h-5",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"})],-1)),t("span",null,"已加载全部 "+g(v.value.length)+" 张图片",1)])):Q.value?(s(),o("span",Lo,[e[66]||(e[66]=t("svg",{class:"animate-spin h-4 w-4 sm:h-5 sm:w-5",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),t("span",null,"加载中... "+g(K.value)+"/"+g(v.value.length),1)])):(s(),o("span",zo,"加载全部图片"))],10,So),t("p",Vo,[ke.value?(s(),o("span",jo,"所有图片已加载完成")):(s(),o("span",Bo,"立即加载所有图片，不再等待滚动触发"))])]),t("button",{onClick:e[12]||(e[12]=a=>ue.value=!1),class:"w-full py-1.5 sm:py-2 px-3 sm:px-4 bg-gray-800/50 backdrop-blur-sm border border-white/10 hover:bg-gray-700/50 hover:border-white/20 text-gray-300 rounded-md sm:rounded-lg text-xs sm:text-sm font-medium transition-all cursor-pointer"}," 关闭 ")])])])):c("",!0)]),_:1})]))],544)):c("",!0),q(Ae,{modelValue:U.value,"onUpdate:modelValue":e[14]||(e[14]=a=>U.value=a),icon:"lock",title:"需要登录",message:"登录后即可继续阅读","confirm-text":"立即登录","cancel-text":"注册账号",onConfirm:Mt,onCancel:Lt},null,8,["modelValue"]),q(Ae,{modelValue:G.value,"onUpdate:modelValue":e[15]||(e[15]=a=>G.value=a),icon:"warning",title:"VIP专享内容",message:"成为VIP会员，解锁全站所有内容","confirm-text":"成为VIP","cancel-text":"返回","confirm-button-class":"bg-yellow-500 hover:bg-yellow-600 text-white",onConfirm:zt,onCancel:e[16]||(e[16]=a=>G.value=!1)},null,8,["modelValue"]),q(Ae,{modelValue:ce.value,"onUpdate:modelValue":e[17]||(e[17]=a=>ce.value=a),icon:"bookmark",title:"添加书签",message:Ye.value,"confirm-text":"确认","cancel-text":"取消","confirm-button-class":"bg-yellow-500 hover:bg-yellow-600 text-white",onConfirm:jt,onCancel:e[18]||(e[18]=a=>ce.value=!1)},null,8,["modelValue","message"])]}),_:1},8,["title"])}}},Ao=Qt(Po,[["__scopeId","data-v-aa393ed4"]]);export{Ao as default};
